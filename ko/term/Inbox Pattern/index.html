<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inbox Pattern | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ë¥¼ ë°©ì§€í•˜ëŠ” ë©±ë“±ì„± íŒ¨í„´ - ë©”ì‹œì§€ ê¸°ë°˜ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ At-Least-Once ì „ë‹¬ ë³´ì¥ í™˜ê²½ì˜ ì¤‘ë³µ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.">
    <meta name="keywords" content="Inbox Pattern, Idempotency, ë©±ë“±ì„±, Message Deduplication, ì¤‘ë³µ ì œê±°, At-Least-Once, Outbox Pattern, Event-Driven Architecture, KAITRUST, AI ë°±ê³¼ì‚¬ì „, ì•„í‚¤í…ì²˜">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/Inbox%20Pattern/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/Inbox%20Pattern/">
    <meta property="og:title" content="Inbox Pattern | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ë¥¼ ë°©ì§€í•˜ëŠ” ë©±ë“±ì„± íŒ¨í„´ - ë©”ì‹œì§€ ê¸°ë°˜ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ At-Least-Once ì „ë‹¬ ë³´ì¥ í™˜ê²½ì˜ ì¤‘ë³µ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Inbox Pattern | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ë¥¼ ë°©ì§€í•˜ëŠ” ë©±ë“±ì„± íŒ¨í„´ - ë©”ì‹œì§€ ê¸°ë°˜ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ At-Least-Once ì „ë‹¬ ë³´ì¥ í™˜ê²½ì˜ ì¤‘ë³µ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "Inbox Pattern",
        "description": "ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ë¥¼ ë°©ì§€í•˜ëŠ” ë©±ë“±ì„± íŒ¨í„´ - ë©”ì‹œì§€ ê¸°ë°˜ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ At-Least-Once ì „ë‹¬ ë³´ì¥ í™˜ê²½ì˜ ì¤‘ë³µ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a {
            color: #64748b;
            text-decoration: none;
            transition: color 0.2s;
        }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english {
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
        }
        .term-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }
        .term-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        .content-section {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.5));
            border: 1px solid rgba(168, 85, 247, 0.15);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
        }
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .section-title .icon {
            font-size: 1.3rem;
        }
        .content-text {
            color: #cbd5e1;
            line-height: 1.9;
            font-size: 1rem;
        }
        .content-text p {
            margin-bottom: 1rem;
        }
        .content-text ul, .content-text ol {
            margin: 1rem 0 1rem 1.5rem;
        }
        .content-text li {
            margin-bottom: 0.5rem;
        }
        .content-text strong {
            color: #f1f5f9;
        }
        .content-text h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #e2e8f0;
            margin: 2rem 0 1rem;
        }
        .content-text h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #a855f7;
            margin: 1.5rem 0 0.75rem;
        }
        pre {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }
        code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
        }
        :not(pre) > code {
            background: rgba(168, 85, 247, 0.2);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            color: #a855f7;
        }
        .highlight-box {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(99, 102, 241, 0.1));
            border-left: 4px solid #a855f7;
            border-radius: 0 12px 12px 0;
            padding: 1.25rem 1.5rem;
            margin: 1.5rem 0;
        }
        .highlight-box.warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(234, 88, 12, 0.1));
            border-left-color: #f59e0b;
        }
        .highlight-box.tip {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.1));
            border-left-color: #22c55e;
        }
        .highlight-box.info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
            border-left-color: #3b82f6;
        }
        .highlight-box strong {
            display: block;
            margin-bottom: 0.5rem;
            color: #f1f5f9;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border: 1px solid rgba(168, 85, 247, 0.2);
        }
        .comparison-table th {
            background: rgba(168, 85, 247, 0.2);
            color: #f1f5f9;
            font-weight: 600;
        }
        .comparison-table td {
            color: #cbd5e1;
        }
        .comparison-table tr:hover td {
            background: rgba(168, 85, 247, 0.05);
        }
        .conversation-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        .conversation-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.25rem;
        }
        .conversation-item:last-child {
            margin-bottom: 0;
        }
        .conversation-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        .conversation-avatar.junior {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        .conversation-avatar.senior {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
        }
        .conversation-bubble {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1rem;
            flex: 1;
        }
        .conversation-name {
            font-weight: 600;
            color: #f1f5f9;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        .conversation-text {
            color: #cbd5e1;
            line-height: 1.7;
            font-size: 0.95rem;
        }
        .architecture-diagram {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: #e2e8f0;
            overflow-x: auto;
            white-space: pre;
            line-height: 1.4;
        }
        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin: 1rem 0;
        }
        .tag {
            background: rgba(168, 85, 247, 0.15);
            border: 1px solid rgba(168, 85, 247, 0.3);
            color: #c4b5fd;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        .related-section {
            margin-top: 3rem;
        }
        .related-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #f1f5f9;
        }
        .resource-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-bottom: 0.75rem;
            text-decoration: none;
            color: #cbd5e1;
            transition: all 0.3s;
        }
        .resource-link:hover {
            background: rgba(168, 85, 247, 0.15);
            color: #f1f5f9;
        }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
            .content-section { padding: 1.5rem; }
            .comparison-table { font-size: 0.85rem; }
            .comparison-table th,
            .comparison-table td { padding: 0.75rem; }
            .architecture-diagram { font-size: 0.7rem; padding: 1rem; }
        }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css?v=20260130002423">

</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#arch">ì•„í‚¤í…ì²˜</a>
            <span>â€º</span>
            <span class="current">Inbox Pattern</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ—ï¸</span>
                <span>ì•„í‚¤í…ì²˜</span>
            </div>
            <h1 class="term-title">Inbox Pattern</h1>
            <p class="term-english">ì¸ë°•ìŠ¤ íŒ¨í„´ Â· Idempotent Consumer Pattern</p>

            <div class="term-description">
                <p>Inbox Patternì€ ë©”ì‹œì§€ ê¸°ë°˜ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ <strong>ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ë¥¼ ë°©ì§€</strong>í•˜ëŠ” ë©±ë“±ì„±(Idempotency) íŒ¨í„´ì…ë‹ˆë‹¤. ìˆ˜ì‹ ëœ ë©”ì‹œì§€ì˜ ê³ ìœ  IDë¥¼ ë³„ë„ í…Œì´ë¸”(Inbox)ì— ì €ì¥í•˜ì—¬, ë™ì¼í•œ ë©”ì‹œì§€ê°€ ë‹¤ì‹œ ë„ì°©í•´ë„ ì¤‘ë³µ ì²˜ë¦¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#arch" class="term-action-btn btn-secondary">
                    ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">ğŸ“–</span>
                ìƒì„¸ ì„¤ëª…
            </h2>
            <div class="content-text">
                <h3>ì™œ Inbox Patternì´ í•„ìš”í•œê°€?</h3>
                <p>ë¶„ì‚° ë©”ì‹œì§€ ì‹œìŠ¤í…œì—ì„œ <strong>At-Least-Once ì „ë‹¬ ë³´ì¥</strong>ì€ ë©”ì‹œì§€ ì†ì‹¤ì„ ë°©ì§€í•˜ì§€ë§Œ, ë„¤íŠ¸ì›Œí¬ ì¥ì• ë‚˜ Consumer ì¬ì‹œì‘ ì‹œ <strong>ë™ì¼ ë©”ì‹œì§€ê°€ ì—¬ëŸ¬ ë²ˆ ì „ë‹¬</strong>ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´:</p>
                <ul>
                    <li><strong>ì£¼ë¬¸ ì¤‘ë³µ ìƒì„±</strong>: ê°™ì€ ì£¼ë¬¸ì´ 2ë²ˆ ì²˜ë¦¬ë¨</li>
                    <li><strong>ê²°ì œ ì¤‘ë³µ ì°¨ê°</strong>: í•œ ë²ˆì˜ ê²°ì œ ìš”ì²­ì— ê¸ˆì•¡ì´ 2ë°°ë¡œ ì°¨ê°</li>
                    <li><strong>ì¬ê³  ê³¼ë‹¤ ì°¨ê°</strong>: ë™ì¼ ì¬ê³  ê°ì†Œê°€ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰</li>
                    <li><strong>ì•Œë¦¼ ì¤‘ë³µ ë°œì†¡</strong>: ì‚¬ìš©ìì—ê²Œ ê°™ì€ ì•Œë¦¼ì´ ì—¬ëŸ¬ ë²ˆ ì „ì†¡</li>
                </ul>

                <h3>Inbox Patternì˜ ë™ì‘ ì›ë¦¬</h3>
                <p>Inbox Patternì€ ìˆ˜ì‹ ëœ ë©”ì‹œì§€ì˜ ê³ ìœ  ì‹ë³„ì(Message ID)ë¥¼ <strong>ì˜ì† ì €ì¥ì†Œ(Inbox í…Œì´ë¸”)</strong>ì— ê¸°ë¡í•˜ì—¬ ì¤‘ë³µ ì—¬ë¶€ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤:</p>

                <div class="architecture-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Inbox Pattern Flow                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   Message Queue                Consumer Service                Database      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚          â”‚                 â”‚              â”‚              â”‚            â”‚ â”‚
â”‚   â”‚  Msg A   â”‚â”€â”€â”€â”€Consumeâ”€â”€â”€â”€â”€â–¶â”‚  1. Extract  â”‚              â”‚   INBOX    â”‚ â”‚
â”‚   â”‚  (ID:123)â”‚                 â”‚     Msg ID   â”‚              â”‚   TABLE    â”‚ â”‚
â”‚   â”‚          â”‚                 â”‚              â”‚              â”‚            â”‚ â”‚
â”‚   â”‚  Msg A   â”‚                 â”‚  2. Check    â”‚â”€â”€EXISTS?â”€â”€â”€â”€â–¶â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚   â”‚  (ID:123)â”‚                 â”‚     Inbox    â”‚              â”‚  â”‚ID:123â”‚  â”‚ â”‚
â”‚   â”‚  (retry) â”‚                 â”‚              â”‚â—€â”€YES/NOâ”€â”€â”€â”€â”€â”€â”‚  â”‚ID:456â”‚  â”‚ â”‚
â”‚   â”‚          â”‚                 â”‚              â”‚              â”‚  â”‚ID:789â”‚  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  3. If NEW:  â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚                                â”‚   - Insert   â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â–¶â”‚            â”‚ â”‚
â”‚                                â”‚   - Process  â”‚              â”‚            â”‚ â”‚
â”‚                                â”‚              â”‚              â”‚  BUSINESS  â”‚ â”‚
â”‚                                â”‚  4. If DUP:  â”‚              â”‚   TABLE    â”‚ â”‚
â”‚                                â”‚   - Skip     â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚                                â”‚   - ACK      â”‚              â”‚  â”‚Ordersâ”‚  â”‚ â”‚
â”‚                                â”‚              â”‚              â”‚  â”‚Items â”‚  â”‚ â”‚
â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚                                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚   í•µì‹¬: Message IDë¥¼ Inbox í…Œì´ë¸”ì— ì €ì¥í•˜ì—¬ ì¤‘ë³µ ì²´í¬                       â”‚
â”‚   ì „ëµ: INSERTì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ìŒ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                </div>

                <h4>ì²˜ë¦¬ ë‹¨ê³„</h4>
                <ol>
                    <li><strong>ë©”ì‹œì§€ ìˆ˜ì‹ </strong>: Consumerê°€ Message Queueì—ì„œ ë©”ì‹œì§€ë¥¼ ë°›ìŒ</li>
                    <li><strong>ID ì¶”ì¶œ</strong>: ë©”ì‹œì§€ì—ì„œ ê³ ìœ  ì‹ë³„ì(Message ID, Idempotency Key) ì¶”ì¶œ</li>
                    <li><strong>ì¤‘ë³µ ì²´í¬</strong>: Inbox í…Œì´ë¸”ì—ì„œ í•´ë‹¹ ID ì¡´ì¬ ì—¬ë¶€ í™•ì¸</li>
                    <li><strong>ì¡°ê±´ë¶€ ì²˜ë¦¬</strong>:
                        <ul>
                            <li><strong>ì‹ ê·œ ë©”ì‹œì§€</strong>: Inboxì— ID ì‚½ì… + ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ (ë™ì¼ íŠ¸ëœì­ì…˜)</li>
                            <li><strong>ì¤‘ë³µ ë©”ì‹œì§€</strong>: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê±´ë„ˆë›°ê³  ACKë§Œ ì „ì†¡</li>
                        </ul>
                    </li>
                    <li><strong>ACK ì „ì†¡</strong>: Message Queueì— ì²˜ë¦¬ ì™„ë£Œ ì•Œë¦¼</li>
                </ol>

                <div class="highlight-box info">
                    <strong>ğŸ’¡ í•µì‹¬ ì›ì¹™</strong>
                    Inbox INSERTì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ë°˜ë“œì‹œ <strong>ë™ì¼ íŠ¸ëœì­ì…˜</strong>ì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
                    ê·¸ë˜ì•¼ "Inboxì—ëŠ” ê¸°ë¡ëì§€ë§Œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì‹¤íŒ¨í•œ" ë¶ˆì¼ì¹˜ ìƒíƒœë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>

                <h3>Inbox í…Œì´ë¸” ì„¤ê³„</h3>
                <p>Inbox í…Œì´ë¸”ì€ ê°„ë‹¨í•œ êµ¬ì¡°ë¡œ ì„¤ê³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>

<pre><code class="language-sql">-- ê¸°ë³¸ Inbox í…Œì´ë¸”
CREATE TABLE inbox (
    message_id    VARCHAR(255) PRIMARY KEY,  -- ë©”ì‹œì§€ ê³ ìœ  ID (UUID, Correlation ID ë“±)
    message_type  VARCHAR(100) NOT NULL,      -- ë©”ì‹œì§€ íƒ€ì… (OrderCreated, PaymentCompleted ë“±)
    received_at   TIMESTAMP DEFAULT NOW(),    -- ìˆ˜ì‹  ì‹œê°
    processed_at  TIMESTAMP,                  -- ì²˜ë¦¬ ì™„ë£Œ ì‹œê° (nullable)
    payload       JSONB                       -- ì›ë³¸ ë©”ì‹œì§€ ì €ì¥ (ë””ë²„ê¹…/ì¬ì²˜ë¦¬ìš©, optional)
);

-- ì¡°íšŒ ì„±ëŠ¥ì„ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX idx_inbox_received_at ON inbox(received_at);
CREATE INDEX idx_inbox_message_type ON inbox(message_type);

-- ì˜¤ë˜ëœ ë ˆì½”ë“œ ì •ë¦¬ë¥¼ ìœ„í•œ íŒŒí‹°ì…”ë‹ (ì„ íƒì‚¬í•­)
-- ë©”ì‹œì§€ ë³´ê´€ ê¸°ê°„ì— ë”°ë¼ ì¼ë³„/ì£¼ë³„ íŒŒí‹°ì…˜ êµ¬ì„±</code></pre>

                <h3>Inbox Pattern vs Outbox Pattern</h3>
                <p><strong>Inbox</strong>ì™€ <strong>Outbox</strong>ëŠ” ë©”ì‹œì§€ ì²˜ë¦¬ì˜ ì–‘ ëë‹¨ì—ì„œ ì‹ ë¢°ì„±ì„ ë³´ì¥í•˜ëŠ” ìƒë³´ì  íŒ¨í„´ì…ë‹ˆë‹¤:</p>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>êµ¬ë¶„</th>
                            <th>Inbox Pattern</th>
                            <th>Outbox Pattern</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ìœ„ì¹˜</strong></td>
                            <td>Consumer (ìˆ˜ì‹ ì¸¡)</td>
                            <td>Producer (ë°œì‹ ì¸¡)</td>
                        </tr>
                        <tr>
                            <td><strong>ëª©ì </strong></td>
                            <td>ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ ë°©ì§€</td>
                            <td>ë©”ì‹œì§€ ì†ì‹¤ ë°©ì§€</td>
                        </tr>
                        <tr>
                            <td><strong>ë™ì‘</strong></td>
                            <td>ë©”ì‹œì§€ IDë¡œ ì¤‘ë³µ ì²´í¬ í›„ ì²˜ë¦¬</td>
                            <td>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë©”ì‹œì§€ë¥¼ í•œ íŠ¸ëœì­ì…˜ì— ì €ì¥</td>
                        </tr>
                        <tr>
                            <td><strong>í•´ê²° ë¬¸ì œ</strong></td>
                            <td>At-Least-Onceë¡œ ì¸í•œ ì¤‘ë³µ ì²˜ë¦¬</td>
                            <td>DB ì»¤ë°‹ í›„ ë©”ì‹œì§€ ë°œí–‰ ì‹¤íŒ¨</td>
                        </tr>
                        <tr>
                            <td><strong>í…Œì´ë¸” ì—­í• </strong></td>
                            <td>ì²˜ë¦¬ ì™„ë£Œëœ ë©”ì‹œì§€ ID ê¸°ë¡</td>
                            <td>ë°œí–‰í•  ë©”ì‹œì§€ ì„ì‹œ ì €ì¥</td>
                        </tr>
                        <tr>
                            <td><strong>í•¨ê»˜ ì‚¬ìš©</strong></td>
                            <td colspan="2" style="text-align: center;">Outbox â†’ Message Queue â†’ Inbox (End-to-End ì‹ ë¢°ì„±)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">ğŸ’»</span>
                ì½”ë“œ ì˜ˆì œ
            </h2>
            <div class="content-text">
                <h3>TypeScript + PostgreSQL êµ¬í˜„</h3>
                <p>Node.js í™˜ê²½ì—ì„œ Inbox Patternì„ êµ¬í˜„í•œ ì™„ì „í•œ ì˜ˆì œì…ë‹ˆë‹¤:</p>

<pre><code class="language-typescript">// inbox/inbox.entity.ts
import { Entity, PrimaryColumn, Column, CreateDateColumn } from 'typeorm';

@Entity('inbox')
export class InboxEntity {
  @PrimaryColumn('varchar', { length: 255 })
  messageId: string;

  @Column('varchar', { length: 100 })
  messageType: string;

  @CreateDateColumn()
  receivedAt: Date;

  @Column('timestamp', { nullable: true })
  processedAt: Date | null;

  @Column('jsonb', { nullable: true })
  payload: Record&lt;string, unknown&gt;;
}

// inbox/inbox.repository.ts
import { Injectable } from '@nestjs/common';
import { DataSource, EntityManager } from 'typeorm';
import { InboxEntity } from './inbox.entity';

@Injectable()
export class InboxRepository {
  constructor(private dataSource: DataSource) {}

  /**
   * ë©”ì‹œì§€ê°€ ì´ë¯¸ ì²˜ë¦¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
   */
  async isProcessed(messageId: string): Promise&lt;boolean&gt; {
    const existing = await this.dataSource.manager.findOne(InboxEntity, {
      where: { messageId }
    });
    return existing !== null;
  }

  /**
   * Inboxì— ë©”ì‹œì§€ ë“±ë¡ (íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‚¬ìš©)
   */
  async recordMessage(
    manager: EntityManager,
    messageId: string,
    messageType: string,
    payload?: Record&lt;string, unknown&gt;
  ): Promise&lt;void&gt; {
    const inbox = manager.create(InboxEntity, {
      messageId,
      messageType,
      payload,
      processedAt: null
    });
    await manager.save(inbox);
  }

  /**
   * ì²˜ë¦¬ ì™„ë£Œ ì‹œê° ì—…ë°ì´íŠ¸
   */
  async markAsProcessed(
    manager: EntityManager,
    messageId: string
  ): Promise&lt;void&gt; {
    await manager.update(InboxEntity, { messageId }, {
      processedAt: new Date()
    });
  }
}

// message/message-handler.service.ts
import { Injectable, Logger } from '@nestjs/common';
import { DataSource } from 'typeorm';
import { InboxRepository } from '../inbox/inbox.repository';

interface OrderCreatedEvent {
  orderId: string;
  customerId: string;
  items: Array&lt;{ productId: string; quantity: number; price: number }&gt;;
  totalAmount: number;
}

@Injectable()
export class MessageHandlerService {
  private readonly logger = new Logger(MessageHandlerService.name);

  constructor(
    private dataSource: DataSource,
    private inboxRepository: InboxRepository
  ) {}

  /**
   * Inbox Patternì„ ì ìš©í•œ ë©”ì‹œì§€ ì²˜ë¦¬
   */
  async handleOrderCreated(
    messageId: string,
    event: OrderCreatedEvent
  ): Promise&lt;void&gt; {
    // 1. ì¤‘ë³µ ì²´í¬ (ë¹ ë¥¸ ì‹¤íŒ¨)
    const alreadyProcessed = await this.inboxRepository.isProcessed(messageId);
    if (alreadyProcessed) {
      this.logger.log(`Duplicate message detected: ${messageId}, skipping...`);
      return; // ACK ì „ì†¡ (ë©”ì‹œì§€ íì—ì„œ ì œê±°)
    }

    // 2. íŠ¸ëœì­ì…˜ìœ¼ë¡œ Inbox ê¸°ë¡ + ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
    await this.dataSource.transaction(async (manager) => {
      // 2-1. Inboxì— ë©”ì‹œì§€ ë“±ë¡ (Race condition ë°©ì§€ë¥¼ ìœ„í•´ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ)
      try {
        await this.inboxRepository.recordMessage(
          manager,
          messageId,
          'OrderCreated',
          event as Record&lt;string, unknown&gt;
        );
      } catch (error: any) {
        // UNIQUE ì œì•½ ì¡°ê±´ ìœ„ë°˜ = ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ë¨¼ì € ì²˜ë¦¬í•¨
        if (error.code === '23505') { // PostgreSQL unique violation
          this.logger.log(`Concurrent duplicate: ${messageId}, skipping...`);
          return;
        }
        throw error;
      }

      // 2-2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
      await this.processOrderCreated(manager, event);

      // 2-3. ì²˜ë¦¬ ì™„ë£Œ í‘œì‹œ
      await this.inboxRepository.markAsProcessed(manager, messageId);
    });

    this.logger.log(`Successfully processed OrderCreated: ${messageId}`);
  }

  private async processOrderCreated(
    manager: any,
    event: OrderCreatedEvent
  ): Promise&lt;void&gt; {
    // ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„
    // - ì£¼ë¬¸ ì—”í‹°í‹° ìƒì„±/ì—…ë°ì´íŠ¸
    // - ì¬ê³  ê°ì†Œ
    // - í¬ì¸íŠ¸ ì ë¦½
    // - ì•Œë¦¼ ë°œì†¡ ì´ë²¤íŠ¸ ìƒì„± (Outbox Pattern ì‚¬ìš©)

    this.logger.log(`Processing order: ${event.orderId} for customer: ${event.customerId}`);

    // ì˜ˆì‹œ: ì£¼ë¬¸ ì €ì¥
    await manager.query(
      `INSERT INTO orders (id, customer_id, total_amount, status, created_at)
       VALUES ($1, $2, $3, 'CREATED', NOW())`,
      [event.orderId, event.customerId, event.totalAmount]
    );

    // ì˜ˆì‹œ: ì£¼ë¬¸ ì•„ì´í…œ ì €ì¥
    for (const item of event.items) {
      await manager.query(
        `INSERT INTO order_items (order_id, product_id, quantity, price)
         VALUES ($1, $2, $3, $4)`,
        [event.orderId, item.productId, item.quantity, item.price]
      );
    }
  }
}

// message/kafka-consumer.ts
import { Injectable, OnModuleInit } from '@nestjs/common';
import { Kafka, Consumer, EachMessagePayload } from 'kafkajs';
import { MessageHandlerService } from './message-handler.service';

@Injectable()
export class KafkaConsumer implements OnModuleInit {
  private consumer: Consumer;

  constructor(private messageHandler: MessageHandlerService) {
    const kafka = new Kafka({
      clientId: 'order-service',
      brokers: ['kafka:9092']
    });
    this.consumer = kafka.consumer({ groupId: 'order-service-group' });
  }

  async onModuleInit() {
    await this.consumer.connect();
    await this.consumer.subscribe({ topic: 'order-events', fromBeginning: false });

    await this.consumer.run({
      eachMessage: async (payload: EachMessagePayload) => {
        const { message } = payload;

        // Message ID ì¶”ì¶œ (Kafkaì—ì„œëŠ” ë³´í†µ í—¤ë”ì— í¬í•¨)
        const messageId = message.headers?.['message-id']?.toString()
          ?? message.key?.toString()
          ?? `${payload.topic}-${payload.partition}-${message.offset}`;

        const event = JSON.parse(message.value?.toString() ?? '{}');

        // Inbox Patternì´ ì ìš©ëœ í•¸ë“¤ëŸ¬ í˜¸ì¶œ
        await this.messageHandler.handleOrderCreated(messageId, event);
      }
    });
  }
}</code></pre>

                <h3>Java + Spring êµ¬í˜„</h3>
                <p>Spring Bootì™€ JPAë¥¼ ì‚¬ìš©í•œ Inbox Pattern êµ¬í˜„ì…ë‹ˆë‹¤:</p>

<pre><code class="language-java">// entity/InboxMessage.java
package com.example.inbox.entity;

import jakarta.persistence.*;
import java.time.Instant;

@Entity
@Table(name = "inbox")
public class InboxMessage {

    @Id
    @Column(name = "message_id", length = 255)
    private String messageId;

    @Column(name = "message_type", length = 100, nullable = false)
    private String messageType;

    @Column(name = "received_at", nullable = false)
    private Instant receivedAt = Instant.now();

    @Column(name = "processed_at")
    private Instant processedAt;

    @Column(name = "payload", columnDefinition = "jsonb")
    private String payload;

    // Getters, setters, constructors...

    public static InboxMessage create(String messageId, String messageType, String payload) {
        InboxMessage inbox = new InboxMessage();
        inbox.messageId = messageId;
        inbox.messageType = messageType;
        inbox.payload = payload;
        return inbox;
    }

    public void markAsProcessed() {
        this.processedAt = Instant.now();
    }
}

// repository/InboxRepository.java
package com.example.inbox.repository;

import com.example.inbox.entity.InboxMessage;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface InboxRepository extends JpaRepository&lt;InboxMessage, String&gt; {
    boolean existsByMessageId(String messageId);
}

// service/IdempotentMessageHandler.java
package com.example.inbox.service;

import com.example.inbox.entity.InboxMessage;
import com.example.inbox.repository.InboxRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.dao.DataIntegrityViolationException;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.function.Consumer;

@Service
public class IdempotentMessageHandler {

    private static final Logger log = LoggerFactory.getLogger(IdempotentMessageHandler.class);

    private final InboxRepository inboxRepository;

    public IdempotentMessageHandler(InboxRepository inboxRepository) {
        this.inboxRepository = inboxRepository;
    }

    /**
     * ë©±ë“±ì„±ì´ ë³´ì¥ëœ ë©”ì‹œì§€ ì²˜ë¦¬ í…œí”Œë¦¿
     *
     * @param messageId    ë©”ì‹œì§€ ê³ ìœ  ID
     * @param messageType  ë©”ì‹œì§€ íƒ€ì…
     * @param payload      ì›ë³¸ í˜ì´ë¡œë“œ (JSON ë¬¸ìì—´)
     * @param handler      ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    @Transactional
    public void handleIdempotently(
            String messageId,
            String messageType,
            String payload,
            Consumer&lt;String&gt; handler
    ) {
        // 1. ë¹ ë¥¸ ì¤‘ë³µ ì²´í¬ (íŠ¸ëœì­ì…˜ ì™¸ë¶€)
        if (inboxRepository.existsByMessageId(messageId)) {
            log.info("Duplicate message detected: {}, skipping", messageId);
            return;
        }

        // 2. Inbox ê¸°ë¡ ì‹œë„ (íŠ¸ëœì­ì…˜ ë‚´ë¶€)
        InboxMessage inbox = InboxMessage.create(messageId, messageType, payload);

        try {
            inboxRepository.save(inbox);
        } catch (DataIntegrityViolationException e) {
            // ë™ì‹œì„± ê²½ìŸì—ì„œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ë¨¼ì € INSERT ì„±ê³µ
            log.info("Concurrent duplicate detected: {}, skipping", messageId);
            return;
        }

        // 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
        handler.accept(payload);

        // 4. ì²˜ë¦¬ ì™„ë£Œ í‘œì‹œ
        inbox.markAsProcessed();
        inboxRepository.save(inbox);

        log.info("Successfully processed message: {}", messageId);
    }
}

// listener/OrderEventListener.java
package com.example.order.listener;

import com.example.inbox.service.IdempotentMessageHandler;
import com.example.order.service.OrderService;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.kafka.support.KafkaHeaders;
import org.springframework.messaging.handler.annotation.Header;
import org.springframework.messaging.handler.annotation.Payload;
import org.springframework.stereotype.Component;

@Component
public class OrderEventListener {

    private final IdempotentMessageHandler idempotentHandler;
    private final OrderService orderService;
    private final ObjectMapper objectMapper;

    public OrderEventListener(
            IdempotentMessageHandler idempotentHandler,
            OrderService orderService,
            ObjectMapper objectMapper
    ) {
        this.idempotentHandler = idempotentHandler;
        this.orderService = orderService;
        this.objectMapper = objectMapper;
    }

    @KafkaListener(topics = "order-events", groupId = "order-service")
    public void handleOrderEvent(
            @Payload String payload,
            @Header(KafkaHeaders.RECEIVED_KEY) String messageKey,
            @Header(value = "message-id", required = false) String messageId
    ) {
        // Message ID ê²°ì • (í—¤ë” ìš°ì„ , ì—†ìœ¼ë©´ Kafka key ì‚¬ìš©)
        String effectiveMessageId = messageId != null ? messageId : messageKey;

        // Inbox Pattern ì ìš©
        idempotentHandler.handleIdempotently(
            effectiveMessageId,
            "OrderCreated",
            payload,
            (p) -> {
                try {
                    OrderCreatedEvent event = objectMapper.readValue(p, OrderCreatedEvent.class);
                    orderService.processOrderCreated(event);
                } catch (Exception e) {
                    throw new RuntimeException("Failed to process order event", e);
                }
            }
        );
    }
}</code></pre>

                <h3>Go êµ¬í˜„ (ê°„ê²°í•œ ë²„ì „)</h3>
                <p>Go ì–¸ì–´ì—ì„œì˜ Inbox Pattern êµ¬í˜„ì…ë‹ˆë‹¤:</p>

<pre><code class="language-go">// inbox/handler.go
package inbox

import (
    "context"
    "database/sql"
    "encoding/json"
    "errors"
    "log"
    "time"

    "github.com/lib/pq"
)

type InboxHandler struct {
    db *sql.DB
}

func NewInboxHandler(db *sql.DB) *InboxHandler {
    return &InboxHandler{db: db}
}

// HandleIdempotently wraps message processing with inbox pattern
func (h *InboxHandler) HandleIdempotently(
    ctx context.Context,
    messageID string,
    messageType string,
    payload json.RawMessage,
    handler func(ctx context.Context, tx *sql.Tx) error,
) error {
    // 1. Quick duplicate check
    exists, err := h.checkExists(ctx, messageID)
    if err != nil {
        return err
    }
    if exists {
        log.Printf("Duplicate message: %s, skipping", messageID)
        return nil
    }

    // 2. Start transaction
    tx, err := h.db.BeginTx(ctx, &sql.TxOptions{Isolation: sql.LevelReadCommitted})
    if err != nil {
        return err
    }
    defer tx.Rollback()

    // 3. Try to insert into inbox (handles race condition)
    err = h.insertInbox(ctx, tx, messageID, messageType, payload)
    if err != nil {
        var pqErr *pq.Error
        if errors.As(err, &pqErr) && pqErr.Code == "23505" {
            log.Printf("Concurrent duplicate: %s, skipping", messageID)
            return nil
        }
        return err
    }

    // 4. Execute business logic
    if err := handler(ctx, tx); err != nil {
        return err
    }

    // 5. Mark as processed and commit
    if err := h.markProcessed(ctx, tx, messageID); err != nil {
        return err
    }

    return tx.Commit()
}

func (h *InboxHandler) checkExists(ctx context.Context, messageID string) (bool, error) {
    var exists bool
    err := h.db.QueryRowContext(ctx,
        "SELECT EXISTS(SELECT 1 FROM inbox WHERE message_id = $1)",
        messageID,
    ).Scan(&exists)
    return exists, err
}

func (h *InboxHandler) insertInbox(
    ctx context.Context,
    tx *sql.Tx,
    messageID, messageType string,
    payload json.RawMessage,
) error {
    _, err := tx.ExecContext(ctx,
        `INSERT INTO inbox (message_id, message_type, payload, received_at)
         VALUES ($1, $2, $3, $4)`,
        messageID, messageType, payload, time.Now(),
    )
    return err
}

func (h *InboxHandler) markProcessed(ctx context.Context, tx *sql.Tx, messageID string) error {
    _, err := tx.ExecContext(ctx,
        "UPDATE inbox SET processed_at = $1 WHERE message_id = $2",
        time.Now(), messageID,
    )
    return err
}</code></pre>

                <div class="highlight-box tip">
                    <strong>ğŸ’¡ Message ID ìƒì„± ì „ëµ</strong>
                    ë©”ì‹œì§€ IDëŠ” ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:
                    <ul style="margin: 0.5rem 0 0 1rem;">
                        <li><strong>UUID v4</strong>: Producerì—ì„œ ìƒì„±, ê¸€ë¡œë²Œ ìœ ë‹ˆí¬</li>
                        <li><strong>Idempotency Key</strong>: í´ë¼ì´ì–¸íŠ¸ê°€ ìƒì„±í•œ ìš”ì²­ë³„ ê³ ìœ  í‚¤</li>
                        <li><strong>Business Key</strong>: ì£¼ë¬¸ID+ë²„ì „ ì¡°í•© ë“± ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ë¯¸ê°€ ìˆëŠ” í‚¤</li>
                        <li><strong>Kafka Offset</strong>: topic-partition-offset ì¡°í•© (Kafka ì „ìš©)</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ë©±ë“±ì„± ì „ëµ ë¹„êµ ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">âš–ï¸</span>
                ë©±ë“±ì„± êµ¬í˜„ ì „ëµ ë¹„êµ
            </h2>
            <div class="content-text">
                <p>Inbox Pattern ì™¸ì—ë„ ì¤‘ë³µ ì²˜ë¦¬ë¥¼ ë°©ì§€í•˜ëŠ” ë‹¤ì–‘í•œ ì „ëµì´ ìˆìŠµë‹ˆë‹¤:</p>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>ì „ëµ</th>
                            <th>ë°©ì‹</th>
                            <th>ì¥ì </th>
                            <th>ë‹¨ì </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Inbox Pattern</strong></td>
                            <td>Message IDë¥¼ ë³„ë„ í…Œì´ë¸”ì— ì €ì¥</td>
                            <td>ë²”ìš©ì , ëª¨ë“  ë©”ì‹œì§€ íƒ€ì… ì ìš© ê°€ëŠ¥</td>
                            <td>ì¶”ê°€ ì €ì¥ ê³µê°„, í…Œì´ë¸” ê´€ë¦¬ í•„ìš”</td>
                        </tr>
                        <tr>
                            <td><strong>Upsert</strong></td>
                            <td>INSERT ON CONFLICT UPDATE</td>
                            <td>ë‹¨ìˆœ, ë³„ë„ í…Œì´ë¸” ë¶ˆí•„ìš”</td>
                            <td>íŠ¹ì • ì—”í‹°í‹°ì—ë§Œ ì ìš©, ì‚­ì œ ì—°ì‚° ì–´ë ¤ì›€</td>
                        </tr>
                        <tr>
                            <td><strong>Version Check</strong></td>
                            <td>ì—”í‹°í‹° ë²„ì „ìœ¼ë¡œ ìƒíƒœ ì²´í¬</td>
                            <td>Optimistic Lockê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ê²°í•©</td>
                            <td>ë²„ì „ ê´€ë¦¬ ë¡œì§ í•„ìš”, ë³µì¡ë„ ì¦ê°€</td>
                        </tr>
                        <tr>
                            <td><strong>Natural Idempotency</strong></td>
                            <td>ì—°ì‚° ìì²´ê°€ ë©±ë“± (SET ì—°ì‚° ë“±)</td>
                            <td>ì¶”ê°€ êµ¬í˜„ ë¶ˆí•„ìš”</td>
                            <td>ëª¨ë“  ì—°ì‚°ì— ì ìš© ë¶ˆê°€ (ì¦ê° ì—°ì‚° ë“±)</td>
                        </tr>
                        <tr>
                            <td><strong>Deduplication Service</strong></td>
                            <td>Redis/Memcachedë¡œ ID ìºì‹±</td>
                            <td>ë§¤ìš° ë¹ ë¥¸ ì²´í¬, ë¶„ì‚° í™˜ê²½ ìš©ì´</td>
                            <td>TTL ë§Œë£Œ í›„ ì¤‘ë³µ ê°€ëŠ¥, ì™¸ë¶€ ì˜ì¡´ì„±</td>
                        </tr>
                    </tbody>
                </table>

                <h3>ì–¸ì œ ì–´ë–¤ ì „ëµì„ ì„ íƒí•´ì•¼ í•˜ë‚˜?</h3>
                <div class="highlight-box">
                    <strong>ğŸ¯ ì„ íƒ ê°€ì´ë“œ</strong>
                    <ul style="margin: 0.5rem 0 0 1rem;">
                        <li><strong>Inbox Pattern</strong>: ë²”ìš©ì ì¸ ë©”ì‹œì§€ ì²˜ë¦¬, ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ íƒ€ì…, ê°ì‚¬ ë¡œê·¸ í•„ìš” ì‹œ</li>
                        <li><strong>Upsert</strong>: ë‹¨ìˆœ ì—”í‹°í‹° ìƒì„±/ìˆ˜ì •, ë¹ ë¥¸ êµ¬í˜„ì´ í•„ìš”í•  ë•Œ</li>
                        <li><strong>Version Check</strong>: ì´ë¯¸ ë²„ì „ ê´€ë¦¬í•˜ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸, DDD í™˜ê²½</li>
                        <li><strong>Redis ìºì‹±</strong>: ì´ˆê³ ì† ì²˜ë¦¬ í•„ìš”, ì¼ì‹œì  ì¤‘ë³µë§Œ ë°©ì§€í•´ë„ ë˜ëŠ” ê²½ìš°</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ì ìš© ê°€ì´ë“œ ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">ğŸ› ï¸</span>
                ì‹¤ë¬´ ì ìš© ê°€ì´ë“œ
            </h2>
            <div class="content-text">
                <h3>Inbox í…Œì´ë¸” ê´€ë¦¬</h3>
                <p>ì‹œê°„ì´ ì§€ë‚˜ë©´ Inbox í…Œì´ë¸”ì€ ê³„ì† ì»¤ì§‘ë‹ˆë‹¤. ì •ë¦¬ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤:</p>

<pre><code class="language-sql">-- 1. ì‹œê°„ ê¸°ë°˜ ì •ë¦¬ (30ì¼ ì´ìƒ ì˜¤ë˜ëœ ë ˆì½”ë“œ ì‚­ì œ)
DELETE FROM inbox
WHERE processed_at IS NOT NULL
  AND processed_at < NOW() - INTERVAL '30 days';

-- 2. íŒŒí‹°ì…”ë‹ ì ìš© (PostgreSQL ì˜ˆì‹œ)
CREATE TABLE inbox (
    message_id VARCHAR(255) NOT NULL,
    message_type VARCHAR(100) NOT NULL,
    received_at TIMESTAMP NOT NULL DEFAULT NOW(),
    processed_at TIMESTAMP,
    payload JSONB,
    PRIMARY KEY (message_id, received_at)
) PARTITION BY RANGE (received_at);

-- ì›”ë³„ íŒŒí‹°ì…˜ ìƒì„±
CREATE TABLE inbox_2025_01 PARTITION OF inbox
    FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');

CREATE TABLE inbox_2025_02 PARTITION OF inbox
    FOR VALUES FROM ('2025-02-01') TO ('2025-03-01');

-- ì˜¤ë˜ëœ íŒŒí‹°ì…˜ ì‚­ì œ (ë¹ ë¦„)
DROP TABLE inbox_2024_12;</code></pre>

                <h3>ì„±ëŠ¥ ìµœì í™”</h3>

<pre><code class="language-typescript">// 1. Redisë¥¼ ì´ìš©í•œ 2ë‹¨ê³„ ì¤‘ë³µ ì²´í¬ (Hot Cache + Cold Storage)
class OptimizedInboxHandler {
  constructor(
    private redis: Redis,
    private db: DataSource,
    private inboxRepository: InboxRepository
  ) {}

  async handleMessage(messageId: string, handler: () => Promise&lt;void&gt;) {
    // Stage 1: Redis ìºì‹œ ì²´í¬ (ë§¤ìš° ë¹ ë¦„)
    const cached = await this.redis.get(`inbox:${messageId}`);
    if (cached) {
      return; // Cache hit = ì´ë¯¸ ì²˜ë¦¬ë¨
    }

    // Stage 2: DB ì²´í¬ (ìºì‹œ ë¯¸ìŠ¤ ì‹œì—ë§Œ)
    const exists = await this.inboxRepository.isProcessed(messageId);
    if (exists) {
      // DBì— ìˆìœ¼ë©´ ìºì‹œì—ë„ ì¶”ê°€ (ë‹¤ìŒ ì¤‘ë³µ ì‹œ ë¹ ë¥¸ ì‘ë‹µ)
      await this.redis.setex(`inbox:${messageId}`, 86400, '1'); // 24ì‹œê°„ TTL
      return;
    }

    // Stage 3: íŠ¸ëœì­ì…˜ ì²˜ë¦¬
    await this.db.transaction(async (manager) => {
      await this.inboxRepository.recordMessage(manager, messageId, 'event', {});
      await handler();
    });

    // Stage 4: ìºì‹œ ê°±ì‹ 
    await this.redis.setex(`inbox:${messageId}`, 86400, '1');
  }
}

// 2. Batch ì²˜ë¦¬ë¡œ ì²˜ë¦¬ëŸ‰ í–¥ìƒ
class BatchInboxHandler {
  private batch: Array&lt;{ messageId: string; handler: () => Promise&lt;void&gt; }&gt; = [];
  private readonly BATCH_SIZE = 100;
  private readonly FLUSH_INTERVAL = 100; // ms

  async addMessage(messageId: string, handler: () => Promise&lt;void&gt;) {
    this.batch.push({ messageId, handler });

    if (this.batch.length >= this.BATCH_SIZE) {
      await this.flush();
    }
  }

  async flush() {
    if (this.batch.length === 0) return;

    const currentBatch = [...this.batch];
    this.batch = [];

    // 1. Batchë¡œ ì¤‘ë³µ ì²´í¬
    const messageIds = currentBatch.map(b => b.messageId);
    const existingIds = await this.checkBatch(messageIds);

    // 2. ì¤‘ë³µ ì•„ë‹Œ ê²ƒë§Œ ì²˜ë¦¬
    const newMessages = currentBatch.filter(
      b => !existingIds.has(b.messageId)
    );

    // 3. Batch INSERT + ê°œë³„ í•¸ë“¤ëŸ¬ ì‹¤í–‰
    await this.processBatch(newMessages);
  }

  private async checkBatch(ids: string[]): Promise&lt;Set&lt;string&gt;&gt; {
    const results = await this.db.query(
      `SELECT message_id FROM inbox WHERE message_id = ANY($1)`,
      [ids]
    );
    return new Set(results.map((r: any) => r.message_id));
  }
}</code></pre>

                <div class="highlight-box warning">
                    <strong>âš ï¸ ë¶„ì‚° íŠ¸ëœì­ì…˜ ì£¼ì˜</strong>
                    Inbox í…Œì´ë¸”ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ í…Œì´ë¸”ì´ <strong>ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤</strong>ì— ìˆìœ¼ë©´ ë‹¨ì¼ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                    ì´ ê²½ìš° Saga íŒ¨í„´ì´ë‚˜ 2PC(Two-Phase Commit)ë¥¼ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.
                </div>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">ğŸ’¬</span>
                ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ
            </h2>
            <div class="content-text">
                <div class="conversation-box">
                    <div class="conversation-item">
                        <div class="conversation-avatar junior">ğŸ§‘â€ğŸ’»</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì£¼ë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                Kafka Consumerì—ì„œ ë©”ì‹œì§€ ì²˜ë¦¬ ì¤‘ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ìë™ìœ¼ë¡œ ì¬ì‹œë„ë˜ëŠ”ë°,
                                ê·¸ ì‚¬ì´ì— ì´ë¯¸ DBì— ë°ì´í„°ê°€ ì €ì¥ëœ ìƒíƒœë¼ ì¤‘ë³µ ë°ì´í„°ê°€ ìƒê²¨ìš”. ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar senior">ğŸ‘¨â€ğŸ«</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì‹œë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                ì „í˜•ì ì¸ At-Least-Once ì¤‘ë³µ ë¬¸ì œë„¤ìš”. <strong>Inbox Pattern</strong>ì„ ì ìš©í•˜ë©´ ë©ë‹ˆë‹¤.
                                ë©”ì‹œì§€ì˜ ê³ ìœ  IDë¥¼ inbox í…Œì´ë¸”ì— ì €ì¥í•˜ê³ , ì²˜ë¦¬ ì „ì— ì´ë¯¸ ìˆëŠ”ì§€ ì²´í¬í•´ìš”.
                                í•µì‹¬ì€ inbox INSERTì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ <strong>ê°™ì€ íŠ¸ëœì­ì…˜</strong>ì—ì„œ ì‹¤í–‰í•˜ëŠ” ê±°ì˜ˆìš”.
                                ê·¸ë˜ì•¼ "ê¸°ë¡ì€ ëëŠ”ë° ì²˜ë¦¬ ì•ˆ ë¨" ê°™ì€ ë¶ˆì¼ì¹˜ ìƒíƒœë¥¼ ë§‰ì„ ìˆ˜ ìˆì–´ìš”.
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar junior">ğŸ§‘â€ğŸ’»</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì£¼ë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                ê·¸ëŸ°ë° Consumerê°€ ì—¬ëŸ¬ ëŒ€ ë–  ìˆìœ¼ë©´ ë™ì‹œì— ê°™ì€ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆì§€ ì•Šë‚˜ìš”?
                                ë‘˜ ë‹¤ "ì—†ìŒ"ì„ í™•ì¸í•˜ê³  ë™ì‹œì— INSERT ì‹œë„í•  ê²ƒ ê°™ì€ë°...
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar senior">ğŸ‘¨â€ğŸ«</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì‹œë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                ì¢‹ì€ ì§€ì ì´ì—ìš”! ê·¸ë˜ì„œ message_idì— <strong>UNIQUE ì œì•½ì¡°ê±´</strong>ì„ ê±¸ì–´ì•¼ í•´ìš”.
                                ë™ì‹œì— INSERTí•˜ë©´ í•˜ë‚˜ëŠ” ì„±ê³µí•˜ê³ , í•˜ë‚˜ëŠ” unique violation ì˜ˆì™¸ê°€ ë°œìƒí•˜ì£ .
                                ì˜ˆì™¸ë¥¼ catchí•´ì„œ "ì´ë¯¸ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ì²˜ë¦¬í•¨"ìœ¼ë¡œ ê°„ì£¼í•˜ê³  skipí•˜ë©´ ë©ë‹ˆë‹¤.
                                ì´ê²Œ "check-then-act" ëŒ€ì‹  "try-insert-catch-duplicate" íŒ¨í„´ì´ì—ìš”.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="conversation-box">
                    <div class="conversation-item">
                        <div class="conversation-avatar junior">ğŸ§‘â€ğŸ’»</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì£¼ë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                Inbox Patternì„ ì ìš©í•˜ë‹ˆê¹Œ inbox í…Œì´ë¸”ì´ ì—„ì²­ ë¹¨ë¦¬ ì»¤ì ¸ìš”.
                                ë§¤ì¼ ìˆ˜ë°±ë§Œ ê±´ì”© ìŒ“ì´ëŠ”ë° ì„±ëŠ¥ ë¬¸ì œê°€ ê±±ì •ë©ë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar senior">ğŸ‘¨â€ğŸ«</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì‹œë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                í…Œì´ë¸” ì •ë¦¬ ì „ëµì´ í•„ìš”í•˜ì£ . ëª‡ ê°€ì§€ ë°©ë²•ì´ ìˆì–´ìš”:<br><br>
                                1. <strong>íŒŒí‹°ì…”ë‹</strong>: received_at ê¸°ì¤€ìœ¼ë¡œ ì›”ë³„ íŒŒí‹°ì…˜ ë§Œë“¤ê³ , ì˜¤ë˜ëœ íŒŒí‹°ì…˜ì€ DROP<br>
                                2. <strong>ë°°ì¹˜ ì‚­ì œ</strong>: ì²˜ë¦¬ ì™„ë£Œ í›„ 30ì¼ ì§€ë‚œ ë ˆì½”ë“œ ì•¼ê°„ì— ì‚­ì œ<br>
                                3. <strong>TTL í…Œì´ë¸”</strong>: TimescaleDBë‚˜ Cassandraì²˜ëŸ¼ ìë™ ë§Œë£Œ ì§€ì›í•˜ëŠ” DB ì‚¬ìš©<br><br>
                                ì¡°íšŒ ì„±ëŠ¥ì€ message_idê°€ Primary Keyë¼ì„œ O(1)ì´ì—ìš”. í…Œì´ë¸”ì´ ì»¤ë„ íŠ¹ì • ID ì¡°íšŒëŠ” ë¹ ë¦…ë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar junior">ğŸ§‘â€ğŸ’»</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì£¼ë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                Redisë¥¼ ì¤‘ë³µ ì²´í¬ì— ì“°ë©´ ë” ë¹ ë¥´ì§€ ì•Šì„ê¹Œìš”?
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar senior">ğŸ‘¨â€ğŸ«</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì‹œë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                ë§ì•„ìš”, Redisê°€ í›¨ì”¬ ë¹ ë¥´ì£ . ê·¼ë° <strong>Redisë§Œ ì“°ë©´ ë¬¸ì œ</strong>ê°€ ìˆì–´ìš”.
                                RedisëŠ” TTL ë§Œë£Œë˜ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§€ì–ì•„ìš”? TTL ì§€ë‚œ í›„ì— ê°™ì€ ë©”ì‹œì§€ê°€ ì¬ì „ì†¡ë˜ë©´ ì¤‘ë³µ ì²˜ë¦¬ë©ë‹ˆë‹¤.<br><br>
                                ê·¸ë˜ì„œ <strong>2ë‹¨ê³„ ì „ëµ</strong>ì„ ì¶”ì²œí•´ìš”:<br>
                                1ë‹¨ê³„: Redis ì²´í¬ (ë¹ ë¥¸ ê²½ë¡œ, ëŒ€ë¶€ë¶„ì˜ ì¤‘ë³µì„ ì—¬ê¸°ì„œ ê±¸ëŸ¬ëƒ„)<br>
                                2ë‹¨ê³„: Redis ë¯¸ìŠ¤ ì‹œ DB ì²´í¬ (ëŠë¦¬ì§€ë§Œ ì˜êµ¬ ë³´ì¥)<br><br>
                                ì´ë ‡ê²Œ í•˜ë©´ ì†ë„ì™€ ì •í™•ì„±ì„ ëª¨ë‘ ì¡ì„ ìˆ˜ ìˆì–´ìš”.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="conversation-box">
                    <div class="conversation-item">
                        <div class="conversation-avatar junior">ğŸ§‘â€ğŸ’»</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì£¼ë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                Outbox Patternì´ë‘ Inbox Patternì€ ê°™ì´ ì¨ì•¼ í•˜ë‚˜ìš”?
                            </div>
                        </div>
                    </div>
                    <div class="conversation-item">
                        <div class="conversation-avatar senior">ğŸ‘¨â€ğŸ«</div>
                        <div class="conversation-bubble">
                            <div class="conversation-name">ì‹œë‹ˆì–´ ê°œë°œì</div>
                            <div class="conversation-text">
                                <strong>End-to-End ì‹ ë¢°ì„±</strong>ì´ í•„ìš”í•˜ë©´ ê°™ì´ ì¨ì•¼ í•´ìš”:<br><br>
                                â€¢ <strong>Outbox</strong>: Producerì—ì„œ "ë©”ì‹œì§€ê°€ ë°˜ë“œì‹œ ë°œí–‰ë˜ë„ë¡" ë³´ì¥ (ì†ì‹¤ ë°©ì§€)<br>
                                â€¢ <strong>Inbox</strong>: Consumerì—ì„œ "ë©”ì‹œì§€ê°€ í•œ ë²ˆë§Œ ì²˜ë¦¬ë˜ë„ë¡" ë³´ì¥ (ì¤‘ë³µ ë°©ì§€)<br><br>
                                ë‘˜ì€ ë©”ì‹œì§€ íŒŒì´í”„ë¼ì¸ì˜ ì–‘ ëì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ë¬¸ì œë¥¼ í•´ê²°í•´ìš”.
                                ê²°ì œë‚˜ ì¬ê³ ì²˜ëŸ¼ ì •í™•ì„±ì´ ì¤‘ìš”í•œ ë„ë©”ì¸ì—ì„œëŠ” ë‘˜ ë‹¤ ì ìš©í•˜ëŠ” ê²Œ ì•ˆì „í•©ë‹ˆë‹¤.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ ë° íŒ ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">âš ï¸</span>
                ì£¼ì˜ì‚¬í•­ ë° íŒ
            </h2>
            <div class="content-text">
                <div class="highlight-box warning">
                    <strong>âš ï¸ íŠ¸ëœì­ì…˜ ë²”ìœ„ ì£¼ì˜</strong>
                    Inbox INSERTì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ <strong>ë°˜ë“œì‹œ ê°™ì€ íŠ¸ëœì­ì…˜</strong>ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
                    ë¶„ë¦¬ë˜ë©´ "Inboxì—ë§Œ ê¸°ë¡ë˜ê³  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì‹¤íŒ¨"í•˜ëŠ” ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
                </div>

                <div class="highlight-box warning">
                    <strong>âš ï¸ Message ID ìƒì„± ìœ„ì¹˜</strong>
                    Message IDëŠ” <strong>Producer(ë°œì‹ ì)</strong>ì—ì„œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.
                    Consumerì—ì„œ ìƒì„±í•˜ë©´ ë™ì¼í•œ ë©”ì‹œì§€ì— ë‹¤ë¥¸ IDê°€ ë¶€ì—¬ë˜ì–´ ì¤‘ë³µ ë°©ì§€ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                </div>

                <div class="highlight-box warning">
                    <strong>âš ï¸ Kafka Offset ì˜ì¡´ ì£¼ì˜</strong>
                    Kafka offset(topic-partition-offset)ì„ Message IDë¡œ ì“¸ ë•Œ ì£¼ì˜:
                    Consumer Group ë³€ê²½ì´ë‚˜ í† í”½ ì¬ìƒì„± ì‹œ offsetì´ ë¦¬ì…‹ë˜ë©´ IDê°€ ì¤‘ë³µë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>

                <div class="highlight-box tip">
                    <strong>ğŸ’¡ ì²˜ë¦¬ ì™„ë£Œ ì‹œê° í™œìš©</strong>
                    <code>processed_at</code> ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ë©´ "ì²˜ë¦¬ ì¤‘" ìƒíƒœë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    ë¹„ì •ìƒ ì¢…ë£Œë¡œ ì²˜ë¦¬ê°€ ë¯¸ì™„ë£Œëœ ë©”ì‹œì§€ë¥¼ ì‹ë³„í•˜ê³  ì¬ì²˜ë¦¬í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.
                </div>

                <div class="highlight-box tip">
                    <strong>ğŸ’¡ Payload ì €ì¥ì˜ ì¥ì </strong>
                    ì›ë³¸ ë©”ì‹œì§€(payload)ë¥¼ Inboxì— í•¨ê»˜ ì €ì¥í•˜ë©´:
                    <ul style="margin: 0.5rem 0 0 1rem;">
                        <li>ì¥ì•  ë¶„ì„ ì‹œ ì›ë³¸ ë°ì´í„° í™•ì¸ ê°€ëŠ¥</li>
                        <li>ì²˜ë¦¬ ì‹¤íŒ¨í•œ ë©”ì‹œì§€ ìˆ˜ë™ ì¬ì²˜ë¦¬ ê°€ëŠ¥</li>
                        <li>ì´ë²¤íŠ¸ ì†Œì‹±ì˜ ê°ì‚¬ ë¡œê·¸ ì—­í• </li>
                    </ul>
                </div>

                <div class="highlight-box tip">
                    <strong>ğŸ’¡ í…ŒìŠ¤íŠ¸ íŒ</strong>
                    Inbox Pattern í…ŒìŠ¤íŠ¸ ì‹œ ë™ì‹œì„± í…ŒìŠ¤íŠ¸ë¥¼ ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”:
                    <ul style="margin: 0.5rem 0 0 1rem;">
                        <li>ë™ì¼ ë©”ì‹œì§€ë¥¼ ë™ì‹œì— Nê°œ Consumerê°€ ì²˜ë¦¬ ì‹œë„</li>
                        <li>ì •í™•íˆ 1ë²ˆë§Œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ì‹¤í–‰ë˜ëŠ”ì§€ ê²€ì¦</li>
                        <li>UNIQUE ì œì•½ ì¡°ê±´ ì˜ˆì™¸ê°€ ì •ìƒ ì²˜ë¦¬ë˜ëŠ”ì§€ í™•ì¸</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">ğŸ”—</span>
                ê´€ë ¨ ìš©ì–´
            </h2>
            <div class="tag-list">
                <a href="/ko/term/Outbox%20Pattern/" class="tag">Outbox Pattern</a>
                <a href="/ko/term/Event%20Sourcing/" class="tag">Event Sourcing</a>
                <a href="/ko/term/CQRS/" class="tag">CQRS</a>
                <a href="/ko/term/Saga%20Pattern/" class="tag">Saga Pattern</a>
                <a href="/ko/term/Apache%20Kafka/" class="tag">Apache Kafka</a>
                <a href="/ko/term/Message%20Queue/" class="tag">Message Queue</a>
                <a href="/ko/term/Idempotency/" class="tag">Idempotency (ë©±ë“±ì„±)</a>
                <a href="/ko/term/At-Least-Once/" class="tag">At-Least-Once Delivery</a>
                <a href="/ko/term/Exactly-Once/" class="tag">Exactly-Once Semantics</a>
                <a href="/ko/term/Dead%20Letter%20Queue/" class="tag">Dead Letter Queue</a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° ì„¹ì…˜ -->
        <section class="content-section">
            <h2 class="section-title">
                <span class="icon">ğŸ“š</span>
                ë” ë°°ìš°ê¸°
            </h2>
            <div class="content-text">
                <a href="https://microservices.io/patterns/communication-style/idempotent-consumer.html" target="_blank" rel="noopener" class="resource-link">
                    <span>ğŸ“–</span>
                    <span>Microservices.io - Idempotent Consumer Pattern</span>
                </a>
                <a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/compensating-transaction" target="_blank" rel="noopener" class="resource-link">
                    <span>ğŸ“˜</span>
                    <span>Microsoft - Compensating Transaction Pattern</span>
                </a>
                <a href="https://www.confluent.io/blog/exactly-once-semantics-are-possible-heres-how-apache-kafka-does-it/" target="_blank" rel="noopener" class="resource-link">
                    <span>ğŸ“—</span>
                    <span>Confluent - Exactly-Once Semantics in Kafka</span>
                </a>
                <a href="https://debezium.io/documentation/reference/stable/configuration/outbox-event-router.html" target="_blank" rel="noopener" class="resource-link">
                    <span>ğŸ”§</span>
                    <span>Debezium - Outbox Event Router (Inboxì™€ í•¨ê»˜ ì‚¬ìš©)</span>
                </a>
                <a href="https://www.youtube.com/watch?v=vGOvlU7cVwU" target="_blank" rel="noopener" class="resource-link">
                    <span>ğŸ¬</span>
                    <span>YouTube - Idempotency in Distributed Systems</span>
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "38px", fabRight: "30px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js?v=20260130002423"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
