<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD (Create, Read, Update, Delete) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="CRUDëŠ” ë°ì´í„°ì˜ ê¸°ë³¸ ì—°ì‚° 4ê°€ì§€(ìƒì„±, ì½ê¸°, ìˆ˜ì •, ì‚­ì œ)ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ REST APIê°€ CRUD íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë©ë‹ˆë‹¤.">
    <meta name="keywords" content="CRUD, Create, Read, Update, Delete, INSERT, SELECT, UPDATE, DELETE, REST API, HTTP Method, AI ìš©ì–´, KAITRUST">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/CRUD/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/CRUD/">
    <meta property="og:title" content="CRUD (Create, Read, Update, Delete) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="CRUDëŠ” ë°ì´í„°ì˜ ê¸°ë³¸ ì—°ì‚° 4ê°€ì§€ë¡œ ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ CRUD íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë©ë‹ˆë‹¤.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CRUD (Create, Read, Update, Delete) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="CRUDëŠ” ë°ì´í„°ì˜ ê¸°ë³¸ ì—°ì‚° 4ê°€ì§€ë¡œ ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ CRUD íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë©ë‹ˆë‹¤.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "CRUD",
        "alternateName": "Create, Read, Update, Delete",
        "description": "CRUDëŠ” ë°ì´í„°ì˜ ê¸°ë³¸ ì—°ì‚° 4ê°€ì§€ë¡œ ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ CRUD íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë©ë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        /* ê³ ë„í™” ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .term-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-content p {
            color: #cbd5e1;
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        .section-content p:last-child { margin-bottom: 0; }

        /* ì½”ë“œ ë¸”ë¡ */
        .code-tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap; }
        .code-tab {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s;
        }
        .code-tab.active {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
            color: #a855f7;
        }
        .code-block {
            position: relative;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
            display: none;
        }
        .code-block.active { display: block; }
        .code-block pre { padding: 1.5rem; margin: 0; overflow-x: auto; }
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
            line-height: 1.6;
        }
        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.3);
            border: none;
            border-radius: 6px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        .copy-btn:hover { background: rgba(168, 85, 247, 0.5); }

        /* ëŒ€í™” ì˜ˆì‹œ */
        .conversation-examples { display: flex; flex-direction: column; gap: 1.5rem; }
        .conv-item { background: rgba(0, 0, 0, 0.2); border-radius: 12px; padding: 1.25rem; }
        .conv-context { font-size: 0.9rem; color: #a855f7; font-weight: 500; margin-bottom: 0.75rem; }
        .conv-quote {
            color: #e2e8f0;
            font-style: italic;
            line-height: 1.7;
            margin: 0;
            padding-left: 1rem;
            border-left: 3px solid #a855f7;
        }

        /* ì£¼ì˜ì‚¬í•­ */
        .warning-list { display: flex; flex-direction: column; gap: 1rem; }
        .warning-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .warning-icon { font-size: 1.5rem; }
        .warning-item strong { color: #f1f5f9; display: block; margin-bottom: 0.25rem; }
        .warning-item p { color: #94a3b8; margin: 0; font-size: 0.95rem; }

        /* ê´€ë ¨ ìš©ì–´ */
        .related-terms { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .related-term-link {
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            color: #a855f7;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .related-term-link:hover { background: rgba(168, 85, 247, 0.2); transform: translateY(-2px); }

        /* ë” ë°°ìš°ê¸° */
        .learn-more { display: flex; flex-direction: column; gap: 0.75rem; }
        .learn-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            color: #00f5ff;
            text-decoration: none;
            transition: all 0.2s;
        }
        .learn-link:hover { background: rgba(0, 0, 0, 0.3); transform: translateX(5px); }

        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a { color: #64748b; text-decoration: none; transition: color 0.2s; }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english { font-size: 1.2rem; color: #94a3b8; margin-bottom: 1.5rem; }
        .term-description { font-size: 1.1rem; line-height: 1.8; color: #e2e8f0; }
        .term-actions { display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap; }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary { background: linear-gradient(135deg, #a855f7, #6366f1); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #e2e8f0; border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
        }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css?v=20260130002423">

</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#db">ë°ì´í„°ë² ì´ìŠ¤</a>
            <span>â€º</span>
            <span class="current">CRUD</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ—„ï¸</span>
                <span>ë°ì´í„°ë² ì´ìŠ¤</span>
            </div>
            <h1 class="term-title">CRUD</h1>
            <p class="term-english">Create, Read, Update, Delete</p>
            <div class="term-description">
                <p>ë°ì´í„°ì˜ ê¸°ë³¸ ì—°ì‚° 4ê°€ì§€(ìƒì„±, ì½ê¸°, ìˆ˜ì •, ì‚­ì œ)ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ REST APIê°€ CRUD íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ë©°, ë°ì´í„°ë² ì´ìŠ¤ì˜ INSERT, SELECT, UPDATE, DELETEì™€ ì§ì ‘ ë§¤í•‘ë©ë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#db" class="term-action-btn btn-secondary">
                    ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“– ìƒì„¸ ì„¤ëª…</h2>
            <div class="section-content">
                <p><strong>Create (ìƒì„±)</strong>: ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. SQLì—ì„œëŠ” INSERT, HTTPì—ì„œëŠ” POST ë©”ì„œë“œì— í•´ë‹¹í•©ë‹ˆë‹¤. íšŒì›ê°€ì…, ê¸€ ì‘ì„±, ì£¼ë¬¸ ìƒì„± ë“±ì´ ëŒ€í‘œì ì¸ ì˜ˆì…ë‹ˆë‹¤.</p>
                <p><strong>Read (ì½ê¸°)</strong>: ê¸°ì¡´ ë°ì´í„°ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤. SQLì—ì„œëŠ” SELECT, HTTPì—ì„œëŠ” GET ë©”ì„œë“œì— í•´ë‹¹í•©ë‹ˆë‹¤. ë‹¨ì¼ ì¡°íšŒ(getById)ì™€ ëª©ë¡ ì¡°íšŒ(getAll, ê²€ìƒ‰, í•„í„°ë§)ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.</p>
                <p><strong>Update (ìˆ˜ì •)</strong>: ê¸°ì¡´ ë°ì´í„°ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤. SQLì—ì„œëŠ” UPDATE, HTTPì—ì„œëŠ” PUT(ì „ì²´ êµì²´) ë˜ëŠ” PATCH(ë¶€ë¶„ ìˆ˜ì •)ì— í•´ë‹¹í•©ë‹ˆë‹¤. í”„ë¡œí•„ ìˆ˜ì •, ìƒí’ˆ ì •ë³´ ë³€ê²½ ë“±ì´ ìˆìŠµë‹ˆë‹¤.</p>
                <p><strong>Delete (ì‚­ì œ)</strong>: ë°ì´í„°ë¥¼ ì œê±°í•©ë‹ˆë‹¤. SQLì—ì„œëŠ” DELETE, HTTPì—ì„œëŠ” DELETE ë©”ì„œë“œì— í•´ë‹¹í•©ë‹ˆë‹¤. ì‹¤ì œ ì‚­ì œ(Hard Delete)ì™€ ë…¼ë¦¬ì  ì‚­ì œ(Soft Delete: is_deleted í”Œë˜ê·¸)ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.</p>
                <p><strong>CRUDì™€ REST API ë§¤í•‘</strong>: RESTful API ì„¤ê³„ì˜ ê¸°ë³¸ì…ë‹ˆë‹¤. ë¦¬ì†ŒìŠ¤ URL(ì˜ˆ: /users)ì— HTTP ë©”ì„œë“œë¥¼ ì¡°í•©í•˜ì—¬ CRUDë¥¼ í‘œí˜„í•©ë‹ˆë‹¤. GET /users(ëª©ë¡), GET /users/:id(ìƒì„¸), POST /users(ìƒì„±), PUT /users/:id(ìˆ˜ì •), DELETE /users/:id(ì‚­ì œ).</p>
            </div>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ’» ì½”ë“œ ì˜ˆì œ</h2>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="python">Python (FastAPI)</button>
                <button class="code-tab" data-lang="node">Node.js (Express)</button>
                <button class="code-tab" data-lang="sql">SQL (ì§ì ‘ ì¿¼ë¦¬)</button>
            </div>
            <div class="code-block active" data-lang="python">
                <pre><code class="language-python"># CRUD API ì˜ˆì œ - Python FastAPI + SQLAlchemy
from fastapi import FastAPI, HTTPException, Depends
from sqlalchemy import create_engine, Column, Integer, String, Boolean, DateTime
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker, Session
from pydantic import BaseModel, EmailStr
from datetime import datetime
from typing import List, Optional

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
DATABASE_URL = "postgresql://user:pass@localhost/mydb"
engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(bind=engine)
Base = declarative_base()


# ëª¨ë¸ ì •ì˜
class User(Base):
    __tablename__ = "users"

    id = Column(Integer, primary_key=True, index=True)
    email = Column(String(255), unique=True, nullable=False)
    username = Column(String(100), nullable=False)
    is_active = Column(Boolean, default=True)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, onupdate=datetime.utcnow)


# Pydantic ìŠ¤í‚¤ë§ˆ
class UserCreate(BaseModel):
    email: EmailStr
    username: str

class UserUpdate(BaseModel):
    email: Optional[EmailStr] = None
    username: Optional[str] = None
    is_active: Optional[bool] = None

class UserResponse(BaseModel):
    id: int
    email: str
    username: str
    is_active: bool
    created_at: datetime

    class Config:
        from_attributes = True


# FastAPI ì•±
app = FastAPI()


def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()


# ==============================================
# CREATE - ìƒˆ ì‚¬ìš©ì ìƒì„±
# ==============================================
@app.post("/users", response_model=UserResponse, status_code=201)
def create_user(user: UserCreate, db: Session = Depends(get_db)):
    """
    Create: ìƒˆë¡œìš´ ë¦¬ì†ŒìŠ¤ ìƒì„±
    - HTTP Method: POST
    - SQL: INSERT INTO users (email, username) VALUES (...)
    """
    # ì¤‘ë³µ ì²´í¬
    existing = db.query(User).filter(User.email == user.email).first()
    if existing:
        raise HTTPException(status_code=400, detail="Email already registered")

    db_user = User(email=user.email, username=user.username)
    db.add(db_user)
    db.commit()
    db.refresh(db_user)
    return db_user


# ==============================================
# READ - ì‚¬ìš©ì ì¡°íšŒ
# ==============================================
@app.get("/users", response_model=List[UserResponse])
def get_users(
    skip: int = 0,
    limit: int = 100,
    is_active: Optional[bool] = None,
    db: Session = Depends(get_db)
):
    """
    Read (List): ëª©ë¡ ì¡°íšŒ + í˜ì´ì§€ë„¤ì´ì…˜ + í•„í„°ë§
    - HTTP Method: GET
    - SQL: SELECT * FROM users WHERE ... LIMIT ... OFFSET ...
    """
    query = db.query(User)

    if is_active is not None:
        query = query.filter(User.is_active == is_active)

    return query.offset(skip).limit(limit).all()


@app.get("/users/{user_id}", response_model=UserResponse)
def get_user(user_id: int, db: Session = Depends(get_db)):
    """
    Read (Detail): ë‹¨ì¼ ë¦¬ì†ŒìŠ¤ ì¡°íšŒ
    - HTTP Method: GET
    - SQL: SELECT * FROM users WHERE id = ?
    """
    user = db.query(User).filter(User.id == user_id).first()
    if not user:
        raise HTTPException(status_code=404, detail="User not found")
    return user


# ==============================================
# UPDATE - ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •
# ==============================================
@app.put("/users/{user_id}", response_model=UserResponse)
def update_user(user_id: int, user_update: UserUpdate, db: Session = Depends(get_db)):
    """
    Update: ë¦¬ì†ŒìŠ¤ ìˆ˜ì •
    - HTTP Method: PUT (ì „ì²´ êµì²´) / PATCH (ë¶€ë¶„ ìˆ˜ì •)
    - SQL: UPDATE users SET ... WHERE id = ?
    """
    db_user = db.query(User).filter(User.id == user_id).first()
    if not db_user:
        raise HTTPException(status_code=404, detail="User not found")

    # Noneì´ ì•„ë‹Œ í•„ë“œë§Œ ì—…ë°ì´íŠ¸
    update_data = user_update.dict(exclude_unset=True)
    for field, value in update_data.items():
        setattr(db_user, field, value)

    db.commit()
    db.refresh(db_user)
    return db_user


# ==============================================
# DELETE - ì‚¬ìš©ì ì‚­ì œ
# ==============================================
@app.delete("/users/{user_id}", status_code=204)
def delete_user(user_id: int, db: Session = Depends(get_db)):
    """
    Delete: ë¦¬ì†ŒìŠ¤ ì‚­ì œ (Hard Delete)
    - HTTP Method: DELETE
    - SQL: DELETE FROM users WHERE id = ?
    """
    db_user = db.query(User).filter(User.id == user_id).first()
    if not db_user:
        raise HTTPException(status_code=404, detail="User not found")

    db.delete(db_user)
    db.commit()
    return None  # 204 No Content


# Soft Delete (ë…¼ë¦¬ì  ì‚­ì œ) ë²„ì „
@app.delete("/users/{user_id}/soft")
def soft_delete_user(user_id: int, db: Session = Depends(get_db)):
    """
    Soft Delete: ì‹¤ì œ ì‚­ì œí•˜ì§€ ì•Šê³  ë¹„í™œì„±í™”
    - is_active = False ë˜ëŠ” deleted_at íƒ€ì„ìŠ¤íƒ¬í”„ ì„¤ì •
    - ë°ì´í„° ë³µêµ¬ ê°€ëŠ¥, ê°ì‚¬ ì¶”ì  ìš©ì´
    """
    db_user = db.query(User).filter(User.id == user_id).first()
    if not db_user:
        raise HTTPException(status_code=404, detail="User not found")

    db_user.is_active = False
    db.commit()
    return {"message": "User deactivated"}
</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="node">
                
                <pre><code class="language-javascript">// CRUD API ì˜ˆì œ - Node.js Express + Prisma
const express = require('express');
const { PrismaClient } = require('@prisma/client');

const app = express();
const prisma = new PrismaClient();

app.use(express.json());

// ==============================================
// CREATE - ìƒˆ ì‚¬ìš©ì ìƒì„±
// ==============================================
app.post('/users', async (req, res) => {
    /**
     * Create: POST /users
     * SQL: INSERT INTO users (email, username) VALUES ($1, $2)
     */
    try {
        const { email, username } = req.body;

        // ìœ íš¨ì„± ê²€ì‚¬
        if (!email || !username) {
            return res.status(400).json({
                error: 'email and username are required'
            });
        }

        const user = await prisma.user.create({
            data: { email, username }
        });

        res.status(201).json(user);

    } catch (error) {
        if (error.code === 'P2002') {  // Unique constraint violation
            return res.status(400).json({ error: 'Email already exists' });
        }
        res.status(500).json({ error: error.message });
    }
});


// ==============================================
// READ - ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
// ==============================================
app.get('/users', async (req, res) => {
    /**
     * Read (List): GET /users?page=1&limit=10&search=john
     * SQL: SELECT * FROM users WHERE ... LIMIT ... OFFSET ...
     */
    try {
        const {
            page = 1,
            limit = 10,
            search,
            isActive
        } = req.query;

        const skip = (parseInt(page) - 1) * parseInt(limit);
        const take = parseInt(limit);

        // í•„í„° ì¡°ê±´ êµ¬ì„±
        const where = {};
        if (search) {
            where.OR = [
                { email: { contains: search, mode: 'insensitive' } },
                { username: { contains: search, mode: 'insensitive' } }
            ];
        }
        if (isActive !== undefined) {
            where.isActive = isActive === 'true';
        }

        // ë³‘ë ¬ë¡œ ë°ì´í„°ì™€ ì´ ê°œìˆ˜ ì¡°íšŒ
        const [users, total] = await Promise.all([
            prisma.user.findMany({
                where,
                skip,
                take,
                orderBy: { createdAt: 'desc' }
            }),
            prisma.user.count({ where })
        ]);

        res.json({
            data: users,
            pagination: {
                page: parseInt(page),
                limit: parseInt(limit),
                total,
                totalPages: Math.ceil(total / take)
            }
        });

    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});


// ==============================================
// READ - ë‹¨ì¼ ì‚¬ìš©ì ì¡°íšŒ
// ==============================================
app.get('/users/:id', async (req, res) => {
    /**
     * Read (Detail): GET /users/:id
     * SQL: SELECT * FROM users WHERE id = $1
     */
    try {
        const { id } = req.params;

        const user = await prisma.user.findUnique({
            where: { id: parseInt(id) },
            include: {
                posts: true,     // ê´€ê³„ ë°ì´í„° í¬í•¨
                profile: true
            }
        });

        if (!user) {
            return res.status(404).json({ error: 'User not found' });
        }

        res.json(user);

    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});


// ==============================================
// UPDATE - ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •
// ==============================================
app.put('/users/:id', async (req, res) => {
    /**
     * Update (Full): PUT /users/:id
     * SQL: UPDATE users SET email=$1, username=$2 WHERE id=$3
     */
    try {
        const { id } = req.params;
        const { email, username, isActive } = req.body;

        const user = await prisma.user.update({
            where: { id: parseInt(id) },
            data: { email, username, isActive }
        });

        res.json(user);

    } catch (error) {
        if (error.code === 'P2025') {  // Record not found
            return res.status(404).json({ error: 'User not found' });
        }
        res.status(500).json({ error: error.message });
    }
});

// PATCH - ë¶€ë¶„ ìˆ˜ì •
app.patch('/users/:id', async (req, res) => {
    /**
     * Update (Partial): PATCH /users/:id
     * ì „ë‹¬ëœ í•„ë“œë§Œ ì—…ë°ì´íŠ¸
     */
    try {
        const { id } = req.params;

        // undefined í•„ë“œ ì œì™¸
        const data = Object.fromEntries(
            Object.entries(req.body).filter(([_, v]) => v !== undefined)
        );

        const user = await prisma.user.update({
            where: { id: parseInt(id) },
            data
        });

        res.json(user);

    } catch (error) {
        if (error.code === 'P2025') {
            return res.status(404).json({ error: 'User not found' });
        }
        res.status(500).json({ error: error.message });
    }
});


// ==============================================
// DELETE - ì‚¬ìš©ì ì‚­ì œ
// ==============================================
app.delete('/users/:id', async (req, res) => {
    /**
     * Delete (Hard): DELETE /users/:id
     * SQL: DELETE FROM users WHERE id = $1
     */
    try {
        const { id } = req.params;

        await prisma.user.delete({
            where: { id: parseInt(id) }
        });

        res.status(204).send();  // No Content

    } catch (error) {
        if (error.code === 'P2025') {
            return res.status(404).json({ error: 'User not found' });
        }
        res.status(500).json({ error: error.message });
    }
});

// Soft Delete
app.delete('/users/:id/soft', async (req, res) => {
    try {
        const { id } = req.params;

        const user = await prisma.user.update({
            where: { id: parseInt(id) },
            data: {
                isActive: false,
                deletedAt: new Date()
            }
        });

        res.json({ message: 'User soft deleted', user });

    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});


app.listen(3000, () => console.log('Server running on port 3000'));
</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="sql">
                
                <pre><code class="language-sql">-- ============================================
-- CRUD SQL ì˜ˆì œ (PostgreSQL)
-- ============================================

-- í…Œì´ë¸” ìƒì„±
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    username VARCHAR(100) NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP  -- Soft Deleteìš©
);


-- ============================================
-- CREATE (INSERT)
-- ============================================

-- ë‹¨ì¼ ë ˆì½”ë“œ ì‚½ì…
INSERT INTO users (email, username)
VALUES ('john@example.com', 'john_doe')
RETURNING *;  -- ì‚½ì…ëœ ë ˆì½”ë“œ ë°˜í™˜ (PostgreSQL)

-- ë‹¤ì¤‘ ë ˆì½”ë“œ ì‚½ì…
INSERT INTO users (email, username) VALUES
    ('alice@example.com', 'alice'),
    ('bob@example.com', 'bob'),
    ('charlie@example.com', 'charlie');

-- UPSERT (ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸, ì—†ìœ¼ë©´ ì‚½ì…)
INSERT INTO users (email, username)
VALUES ('john@example.com', 'john_updated')
ON CONFLICT (email) DO UPDATE SET
    username = EXCLUDED.username,
    updated_at = CURRENT_TIMESTAMP;


-- ============================================
-- READ (SELECT)
-- ============================================

-- ì „ì²´ ì¡°íšŒ
SELECT * FROM users;

-- ì¡°ê±´ ì¡°íšŒ
SELECT * FROM users WHERE is_active = TRUE;

-- ë‹¨ì¼ ë ˆì½”ë“œ ì¡°íšŒ
SELECT * FROM users WHERE id = 1;
SELECT * FROM users WHERE email = 'john@example.com';

-- ê²€ìƒ‰ (ë¶€ë¶„ ì¼ì¹˜)
SELECT * FROM users
WHERE username ILIKE '%john%'  -- ëŒ€ì†Œë¬¸ì ë¬´ì‹œ (PostgreSQL)
   OR email ILIKE '%john%';

-- í˜ì´ì§€ë„¤ì´ì…˜
SELECT * FROM users
ORDER BY created_at DESC
LIMIT 10 OFFSET 0;  -- 1í˜ì´ì§€ (0~9)

SELECT * FROM users
ORDER BY created_at DESC
LIMIT 10 OFFSET 10;  -- 2í˜ì´ì§€ (10~19)

-- ì»¤ì„œ ê¸°ë°˜ í˜ì´ì§€ë„¤ì´ì…˜ (ëŒ€ìš©ëŸ‰ì— íš¨ìœ¨ì )
SELECT * FROM users
WHERE id > 100  -- ë§ˆì§€ë§‰ ì¡°íšŒ ID
ORDER BY id ASC
LIMIT 10;

-- ì§‘ê³„ì™€ í•¨ê»˜ ì¡°íšŒ
SELECT
    COUNT(*) as total,
    COUNT(*) FILTER (WHERE is_active) as active_count
FROM users;


-- ============================================
-- UPDATE
-- ============================================

-- ë‹¨ì¼ í•„ë“œ ì—…ë°ì´íŠ¸
UPDATE users
SET username = 'john_updated'
WHERE id = 1
RETURNING *;

-- ë‹¤ì¤‘ í•„ë“œ ì—…ë°ì´íŠ¸
UPDATE users SET
    username = 'john_updated',
    is_active = FALSE,
    updated_at = CURRENT_TIMESTAMP
WHERE id = 1;

-- ì¡°ê±´ë¶€ ì—…ë°ì´íŠ¸
UPDATE users SET
    is_active = FALSE
WHERE created_at < NOW() - INTERVAL '1 year'
  AND is_active = TRUE;

-- CASEë¥¼ ì´ìš©í•œ ì¡°ê±´ë¶€ ê°’ ì„¤ì •
UPDATE users SET
    is_active = CASE
        WHEN last_login_at < NOW() - INTERVAL '6 months' THEN FALSE
        ELSE is_active
    END;


-- ============================================
-- DELETE
-- ============================================

-- Hard Delete (ë¬¼ë¦¬ì  ì‚­ì œ)
DELETE FROM users WHERE id = 1;

-- ì¡°ê±´ë¶€ ì‚­ì œ
DELETE FROM users
WHERE is_active = FALSE
  AND created_at < NOW() - INTERVAL '1 year';

-- ê´€ë ¨ ë°ì´í„°ë„ í•¨ê»˜ ì‚­ì œ (CASCADE ì„¤ì • í•„ìš”)
DELETE FROM users WHERE id = 1;  -- posts, profilesë„ ì‚­ì œë¨

-- Soft Delete (ë…¼ë¦¬ì  ì‚­ì œ)
UPDATE users SET
    is_active = FALSE,
    deleted_at = CURRENT_TIMESTAMP
WHERE id = 1;

-- Soft Deleteëœ ë°ì´í„° ì œì™¸í•˜ê³  ì¡°íšŒ
SELECT * FROM users
WHERE deleted_at IS NULL;

-- Soft Delete ë³µêµ¬
UPDATE users SET
    is_active = TRUE,
    deleted_at = NULL
WHERE id = 1;


-- ============================================
-- CRUD ë§¤í•‘ ìš”ì•½
-- ============================================
-- | CRUD   | SQL      | HTTP   | ì„¤ëª…           |
-- |--------|----------|--------|----------------|
-- | Create | INSERT   | POST   | ìƒˆ ë¦¬ì†ŒìŠ¤ ìƒì„±   |
-- | Read   | SELECT   | GET    | ë¦¬ì†ŒìŠ¤ ì¡°íšŒ      |
-- | Update | UPDATE   | PUT    | ì „ì²´ ë¦¬ì†ŒìŠ¤ êµì²´  |
-- | Update | UPDATE   | PATCH  | ë¶€ë¶„ ë¦¬ì†ŒìŠ¤ ìˆ˜ì •  |
-- | Delete | DELETE   | DELETE | ë¦¬ì†ŒìŠ¤ ì‚­ì œ      |
</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ—£ï¸ ì‹¤ë¬´ì—ì„œ ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”</h2>
            <div class="conversation-examples">
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ API ì„¤ê³„ íšŒì˜ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "ì´ ë¦¬ì†ŒìŠ¤ì˜ CRUD APIë¶€í„° ì •ì˜í•©ì‹œë‹¤. POST /productsë¡œ ìƒì„±, GET /products/:idë¡œ ì¡°íšŒ, PUTìœ¼ë¡œ ì „ì²´ ìˆ˜ì •, PATCHë¡œ ë¶€ë¶„ ìˆ˜ì •, DELETEë¡œ ì‚­ì œ. RESTful ì»¨ë²¤ì…˜ ë”°ë¼ê°€ë©´ ë©ë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ë°ì´í„° ì‚­ì œ ì •ì±… ë…¼ì˜ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "ì‚¬ìš©ì ì‚­ì œëŠ” Soft Deleteë¡œ ê°€ì£ . is_deleted í”Œë˜ê·¸ ì“°ë©´ ë‚˜ì¤‘ì— ë³µêµ¬ë„ ê°€ëŠ¥í•˜ê³ , ê°ì‚¬ ë¡œê·¸ ì¶”ì ë„ ì‰½ìŠµë‹ˆë‹¤. ì‹¤ì œ ë¬¼ë¦¬ ì‚­ì œëŠ” 90ì¼ í›„ ë°°ì¹˜ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²Œ ì¢‹ê² ì–´ìš”."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ì„±ëŠ¥ ìµœì í™” ë¦¬ë·°ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "Read ë¹„ìœ¨ì´ 90%ê°€ ë„˜ìœ¼ë‹ˆê¹Œ ì½ê¸° ìµœì í™”ì— ì§‘ì¤‘í•´ì•¼ í•´ìš”. SELECT ì¿¼ë¦¬ì— ì ì ˆí•œ ì¸ë±ìŠ¤ ì¶”ê°€í•˜ê³ , ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°ëŠ” ìºì‹± ë ˆì´ì–´ ì¶”ê°€í•©ì‹œë‹¤. WriteëŠ” ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ë©´ ë˜ê³ ìš”."
                    </blockquote>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ -->
        <section class="term-section">
            <h2 class="section-title">âš ï¸ ì£¼ì˜ì‚¬í•­ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h2>
            <div class="warning-list">
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>GET ìš”ì²­ìœ¼ë¡œ ë°ì´í„° ë³€ê²½</strong>
                        <p>GETì€ ì¡°íšŒ ì „ìš©ì…ë‹ˆë‹¤. GET /users/1/deleteì²˜ëŸ¼ GETìœ¼ë¡œ ì‚­ì œí•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤. í¬ë¡¤ëŸ¬ë‚˜ í”„ë¦¬í˜ì¹˜ê°€ ì˜ë„ì¹˜ ì•Šì€ ì‚­ì œë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>WHERE ì—†ëŠ” UPDATE/DELETE</strong>
                        <p>WHERE ì ˆ ì—†ì´ UPDATEë‚˜ DELETE ì‹¤í–‰ ì‹œ ì „ì²´ ë°ì´í„°ê°€ ë³€ê²½/ì‚­ì œë©ë‹ˆë‹¤. í•­ìƒ ì¡°ê±´ì ˆì„ í™•ì¸í•˜ê³ , í”„ë¡œë•ì…˜ì—ì„œëŠ” íŠ¸ëœì­ì…˜ìœ¼ë¡œ ê°ì‹¸ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>N+1 ë¬¸ì œ</strong>
                        <p>ëª©ë¡ ì¡°íšŒ ì‹œ ê° í•­ëª©ì˜ ê´€ê³„ ë°ì´í„°ë¥¼ ê°œë³„ ì¿¼ë¦¬ë¡œ ì¡°íšŒí•˜ë©´ ì„±ëŠ¥ì´ ê¸‰ê²©íˆ ì €í•˜ë©ë‹ˆë‹¤. JOINì´ë‚˜ Eager Loadingì„ ì‚¬ìš©í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âœ…</span>
                    <div>
                        <strong>CRUD ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</strong>
                        <p>ë©±ë“±ì„± ë³´ì¥(PUT, DELETEëŠ” ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•´ë„ ê°™ì€ ê²°ê³¼), ì ì ˆí•œ HTTP ìƒíƒœì½”ë“œ ë°˜í™˜, í˜ì´ì§€ë„¤ì´ì…˜ í•„ìˆ˜, Soft Delete ê³ ë ¤, ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ”— ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-terms">
                <a href="/ko/term/REST-API/" class="related-term-link">REST API</a>
                <a href="/ko/term/HTTP-Method/" class="related-term-link">HTTP Method</a>
                <a href="/ko/term/SQL/" class="related-term-link">SQL</a>
                <a href="/ko/term/ORM/" class="related-term-link">ORM</a>
                <a href="/ko/term/Transaction/" class="related-term-link">Transaction</a>
                <a href="/ko/term/Soft-Delete/" class="related-term-link">Soft Delete</a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“š ë” ë°°ìš°ê¸°</h2>
            <div class="learn-more">
                <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" target="_blank" class="learn-link">
                    ğŸ“„ MDN - HTTP ìš”ì²­ ë©”ì„œë“œ
                </a>
                <a href="https://restfulapi.net/http-methods/" target="_blank" class="learn-link">
                    ğŸ“ RESTful API - HTTP Methods
                </a>
                <a href="https://www.postgresql.org/docs/current/dml.html" target="_blank" class="learn-link">
                    ğŸ“– PostgreSQL - Data Manipulation (DML)
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>
    function copyCode(btn) {
        const codeBlock = btn.parentElement.querySelector('code');
        navigator.clipboard.writeText(codeBlock.textContent).then(() => {
            btn.textContent = 'âœ… ë³µì‚¬ë¨!';
            setTimeout(() => btn.textContent = 'ğŸ“‹ ë³µì‚¬', 2000);
        });
    }

    document.querySelectorAll('.code-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const lang = this.dataset.lang;
            const section = this.closest('.term-section');
            section.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            section.querySelectorAll('.code-block').forEach(block => {
                block.classList.remove('active');
                if (block.dataset.lang === lang) block.classList.add('active');
            });
        });
    });
    </script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "78px", fabRight: "170px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js?v=20260130002423"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
