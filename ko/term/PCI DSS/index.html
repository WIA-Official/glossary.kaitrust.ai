<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCI DSS (ê²°ì œ ì¹´ë“œ ë³´ì•ˆ í‘œì¤€) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="PCI DSS(Payment Card Industry Data Security Standard)ëŠ” ì‹ ìš©ì¹´ë“œ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•œ ê¸€ë¡œë²Œ ë³´ì•ˆ í‘œì¤€ìœ¼ë¡œ, 12ê°œ ìš”êµ¬ì‚¬í•­ê³¼ 400ê°œ ì´ìƒì˜ í†µì œ í•­ëª©ì„ ì •ì˜í•©ë‹ˆë‹¤.">
    <meta name="keywords" content="PCI DSS, ê²°ì œì¹´ë“œë³´ì•ˆ, Payment Card Industry, ì¹´ë“œë°ì´í„°, CHD, CDE, SAQ, QSA, ASV, PAN, í† í°í™”, KAITRUST">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/PCI%20DSS/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/PCI%20DSS/">
    <meta property:title" content="PCI DSS (ê²°ì œ ì¹´ë“œ ë³´ì•ˆ í‘œì¤€) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="ê²°ì œ ì¹´ë“œ ë°ì´í„° ë³´í˜¸ë¥¼ ìœ„í•œ ê¸€ë¡œë²Œ ë³´ì•ˆ í‘œì¤€. 12ê°œ ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ì¹´ë“œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ë³´í˜¸.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="PCI DSS (ê²°ì œ ì¹´ë“œ ë³´ì•ˆ í‘œì¤€) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="ê²°ì œ ì¹´ë“œ ë°ì´í„° ë³´í˜¸ë¥¼ ìœ„í•œ ê¸€ë¡œë²Œ ë³´ì•ˆ í‘œì¤€. 12ê°œ ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ì¹´ë“œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ë³´í˜¸.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "PCI DSS",
        "alternateName": "Payment Card Industry Data Security Standard",
        "description": "ì‹ ìš©ì¹´ë“œ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•œ ê¸€ë¡œë²Œ ë³´ì•ˆ í‘œì¤€ìœ¼ë¡œ, 12ê°œ ìš”êµ¬ì‚¬í•­ê³¼ 400ê°œ ì´ìƒì˜ í†µì œ í•­ëª©ì„ ì •ì˜í•©ë‹ˆë‹¤. Visa, Mastercard, American Express ë“± ì£¼ìš” ì¹´ë“œì‚¬ê°€ ê³µë™ìœ¼ë¡œ ì œì •í–ˆìŠµë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        /* ê³ ë„í™” ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .term-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-content p {
            color: #cbd5e1;
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        .section-content p:last-child { margin-bottom: 0; }

        /* ì½”ë“œ ë¸”ë¡ */
        .code-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .code-tab {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s;
        }
        .code-tab.active {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
            color: #a855f7;
        }
        .code-block {
            position: relative;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
            display: none;
        }
        .code-block.active { display: block; }
        .code-block pre {
            padding: 1.5rem;
            margin: 0;
            overflow-x: auto;
        }
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
            line-height: 1.6;
        }
        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.3);
            border: none;
            border-radius: 6px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        .copy-btn:hover { background: rgba(168, 85, 247, 0.5); }

        /* ëŒ€í™” ì˜ˆì‹œ */
        .conversation-examples { display: flex; flex-direction: column; gap: 1.5rem; }
        .conv-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 1.25rem;
        }
        .conv-context {
            font-size: 0.9rem;
            color: #a855f7;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }
        .conv-quote {
            color: #e2e8f0;
            font-style: italic;
            line-height: 1.7;
            margin: 0;
            padding-left: 1rem;
            border-left: 3px solid #a855f7;
        }

        /* ì£¼ì˜ì‚¬í•­ */
        .warning-list { display: flex; flex-direction: column; gap: 1rem; }
        .warning-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .warning-icon { font-size: 1.5rem; }
        .warning-item strong { color: #f1f5f9; display: block; margin-bottom: 0.25rem; }
        .warning-item p { color: #94a3b8; margin: 0; font-size: 0.95rem; }

        /* ê´€ë ¨ ìš©ì–´ */
        .related-terms { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .related-term-link {
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            color: #a855f7;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .related-term-link:hover {
            background: rgba(168, 85, 247, 0.2);
            transform: translateY(-2px);
        }

        /* ë” ë°°ìš°ê¸° */
        .learn-more { display: flex; flex-direction: column; gap: 0.75rem; }
        .learn-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            color: #00f5ff;
            text-decoration: none;
            transition: all 0.2s;
        }
        .learn-link:hover { background: rgba(0, 0, 0, 0.3); transform: translateX(5px); }

        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a {
            color: #64748b;
            text-decoration: none;
            transition: color 0.2s;
        }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english {
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
        }
        .term-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }
        .term-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
        }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css?v=20260129231616">

</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#security">ë³´ì•ˆ</a>
            <span>â€º</span>
            <span class="current">PCI DSS</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ”’</span>
                <span>ë³´ì•ˆ</span>
            </div>
            <h1 class="term-title">PCI DSS</h1>
            <p class="term-english">Payment Card Industry Data Security Standard (ê²°ì œ ì¹´ë“œ ì‚°ì—… ë°ì´í„° ë³´ì•ˆ í‘œì¤€)</p>
            <div class="term-description">
                <p>PCI DSSëŠ” ì‹ ìš©ì¹´ë“œ, ì§ë¶ˆì¹´ë“œ ë“± ê²°ì œ ì¹´ë“œ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•œ ê¸€ë¡œë²Œ ë³´ì•ˆ í‘œì¤€ì…ë‹ˆë‹¤. Visa, Mastercard, American Express ë“± ì£¼ìš” ì¹´ë“œ ë¸Œëœë“œê°€ ê³µë™ ì„¤ë¦½í•œ PCI SSC(Security Standards Council)ì—ì„œ ê´€ë¦¬í•˜ë©°, ì¹´ë“œ ë°ì´í„°ë¥¼ ì €ì¥, ì²˜ë¦¬, ì „ì†¡í•˜ëŠ” ëª¨ë“  ì¡°ì§ì— ì ìš©ë©ë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#security" class="term-action-btn btn-secondary">
                    ğŸ”’ ë³´ì•ˆ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“– ìƒì„¸ ì„¤ëª…</h2>
            <div class="section-content">
                <p>PCI DSS(Payment Card Industry Data Security Standard)ëŠ” 2004ë…„ Visa, Mastercard, American Express, Discover, JCBì˜ 5ê°œ ì£¼ìš” ì¹´ë“œ ë¸Œëœë“œê°€ ê³µë™ìœ¼ë¡œ ì œì •í•œ ê²°ì œ ì¹´ë“œ ë³´ì•ˆ í‘œì¤€ì…ë‹ˆë‹¤. ì´ì „ì—ëŠ” ê° ì¹´ë“œì‚¬ê°€ ê°œë³„ ë³´ì•ˆ ê¸°ì¤€ì„ ìš´ì˜í–ˆìœ¼ë‚˜, í†µí•©ëœ ê¸€ë¡œë²Œ í‘œì¤€ì˜ í•„ìš”ì„±ì´ ëŒ€ë‘ë˜ì–´ PCI SSC(Security Standards Council)ê°€ ì„¤ë¦½ë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ ë²„ì „ì€ PCI DSS v4.0(2022ë…„ ë°œí‘œ)ì´ë©°, v4.0.1ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                <p>PCI DSSì˜ í•µì‹¬ì€ CHD(Cardholder Data)ì™€ SAD(Sensitive Authentication Data)ì˜ ë³´í˜¸ì…ë‹ˆë‹¤. CHDëŠ” PAN(Primary Account Number, ì¹´ë“œë²ˆí˜¸), ì¹´ë“œ ì†Œìœ ì ì´ë¦„, ë§Œë£Œì¼, ì„œë¹„ìŠ¤ ì½”ë“œë¥¼ í¬í•¨í•©ë‹ˆë‹¤. SADëŠ” í’€ ë§ˆê·¸ë„¤í‹± ìŠ¤íŠ¸ë¼ì´í”„ ë°ì´í„°, CVV/CVC, PINì„ í¬í•¨í•˜ë©°, ìŠ¹ì¸ í›„ ì €ì¥ì´ ê¸ˆì§€ë©ë‹ˆë‹¤. ì´ ë°ì´í„°ê°€ ì²˜ë¦¬ë˜ëŠ” í™˜ê²½ì„ CDE(Cardholder Data Environment)ë¼ í•˜ë©°, PCI DSS ì»´í”Œë¼ì´ì–¸ìŠ¤ì˜ í•µì‹¬ ë²”ìœ„ì…ë‹ˆë‹¤.</p>
                <p>í‘œì¤€ì€ 6ê°œ ëª©í‘œ ì•„ë˜ 12ê°œ ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤: (1) ë°©í™”ë²½ ì„¤ì¹˜ ë° ìœ ì§€, (2) ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, (3) ì €ì¥ëœ ì¹´ë“œ ë°ì´í„° ë³´í˜¸, (4) ì „ì†¡ ì¤‘ ì•”í˜¸í™”, (5) ì•ˆí‹°ë°”ì´ëŸ¬ìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´, (6) ë³´ì•ˆ ì‹œìŠ¤í…œ ê°œë°œ, (7) ì ‘ê·¼ ì œí•œ, (8) ê³ ìœ  ID ë¶€ì—¬, (9) ë¬¼ë¦¬ì  ì ‘ê·¼ ì œí•œ, (10) ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…, (11) ì •ê¸° í…ŒìŠ¤íŠ¸, (12) ì •ë³´ë³´ì•ˆ ì •ì±…. ê° ìš”êµ¬ì‚¬í•­ì—ëŠ” ì„¸ë¶€ í†µì œ í•­ëª©ì´ ìˆì–´ ì´ 400ê°œ ì´ìƒì˜ ì ê²€ í•­ëª©ì´ ìˆìŠµë‹ˆë‹¤.</p>
                <p>PCI DSS ì¤€ìˆ˜ëŠ” ì¹´ë“œ ê±°ë˜ëŸ‰ì— ë”°ë¼ 4ê°œ ë ˆë²¨ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. Level 1(ì—°ê°„ 600ë§Œ ê±´ ì´ìƒ)ì€ QSA(Qualified Security Assessor)ì˜ í˜„ì¥ ì‹¬ì‚¬ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤. Level 2-4ëŠ” SAQ(Self-Assessment Questionnaire)ë¡œ ìê°€ í‰ê°€ê°€ ê°€ëŠ¥í•˜ì§€ë§Œ, ì·¨ê¸‰í•˜ëŠ” ë°ì´í„° ìœ í˜•ì— ë”°ë¼ SAQ A, A-EP, B, C, D ë“± ì í•©í•œ ì–‘ì‹ì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤. ë¶„ê¸°ë³„ ASV(Approved Scanning Vendor) ì·¨ì•½ì  ìŠ¤ìº”ë„ í•„ìˆ˜ì…ë‹ˆë‹¤. ë¯¸ì¤€ìˆ˜ ì‹œ ì¹´ë“œì‚¬ë¡œë¶€í„° ê±°ë˜ ì •ì§€, ê³¼ì§•ê¸ˆ, ë°ì´í„° ìœ ì¶œ ì‹œ ë§‰ëŒ€í•œ ë³´ìƒ ì±…ì„ì„ ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ’» ì½”ë“œ ì˜ˆì œ</h2>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="python">Python (ì¹´ë“œ ë°ì´í„° ë³´í˜¸)</button>
                <button class="code-tab" data-lang="nodejs">Node.js (í† í°í™”)</button>
                <button class="code-tab" data-lang="sql">SQL (ë°ì´í„° ë§ˆìŠ¤í‚¹)</button>
            </div>
            <div class="code-block active" data-lang="python">
                <pre><code class="language-python"># PCI DSS ì¤€ìˆ˜ë¥¼ ìœ„í•œ ì¹´ë“œ ë°ì´í„° ì²˜ë¦¬ - Python
import re
import hashlib
import logging
from datetime import datetime
from typing import Optional, Dict
from cryptography.fernet import Fernet
from functools import wraps

# PCI DSS ìš”êµ¬ì‚¬í•­ 10: ë¡œê¹… ì„¤ì •
logging.basicConfig(
    filename='pci_audit.log',
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s'
)
audit_logger = logging.getLogger('PCI_AUDIT')


class PANValidator:
    """PAN(Primary Account Number) ê²€ì¦ ë° ë³´í˜¸ í´ë˜ìŠ¤"""

    # ì¹´ë“œ ë¸Œëœë“œë³„ BIN íŒ¨í„´ (ì²˜ìŒ 6ìë¦¬)
    CARD_PATTERNS = {
        'visa': r'^4[0-9]{12}(?:[0-9]{3})?$',
        'mastercard': r'^5[1-5][0-9]{14}$|^2[2-7][0-9]{14}$',
        'amex': r'^3[47][0-9]{13}$',
        'discover': r'^6(?:011|5[0-9]{2})[0-9]{12}$',
        'jcb': r'^(?:2131|1800|35\d{3})\d{11}$'
    }

    @staticmethod
    def luhn_check(pan: str) -> bool:
        """Luhn ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ PAN ìœ íš¨ì„± ê²€ì¦"""
        digits = [int(d) for d in pan if d.isdigit()]
        odd_sum = sum(digits[-1::-2])
        even_sum = sum(sum(divmod(2 * d, 10)) for d in digits[-2::-2])
        return (odd_sum + even_sum) % 10 == 0

    @staticmethod
    def identify_brand(pan: str) -> Optional[str]:
        """ì¹´ë“œ ë¸Œëœë“œ ì‹ë³„"""
        clean_pan = re.sub(r'\D', '', pan)
        for brand, pattern in PANValidator.CARD_PATTERNS.items():
            if re.match(pattern, clean_pan):
                return brand
        return None

    @staticmethod
    def validate(pan: str) -> Dict:
        """PAN ì¢…í•© ê²€ì¦"""
        clean_pan = re.sub(r'\D', '', pan)
        return {
            'valid_length': 13 <= len(clean_pan) <= 19,
            'valid_luhn': PANValidator.luhn_check(clean_pan),
            'brand': PANValidator.identify_brand(clean_pan)
        }


class PCICompliantStorage:
    """PCI DSS ì¤€ìˆ˜ ì¹´ë“œ ë°ì´í„° ì €ì¥ì†Œ

    ìš”êµ¬ì‚¬í•­ 3: ì €ì¥ëœ ì¹´ë“œí™€ë” ë°ì´í„° ë³´í˜¸
    """

    def __init__(self, encryption_key: bytes):
        self.cipher = Fernet(encryption_key)

    def mask_pan(self, pan: str) -> str:
        """PAN ë§ˆìŠ¤í‚¹ (ìš”êµ¬ì‚¬í•­ 3.4)

        ì²˜ìŒ 6ìë¦¬(BIN)ì™€ ë§ˆì§€ë§‰ 4ìë¦¬ë§Œ í‘œì‹œ ê°€ëŠ¥
        ì˜ˆ: 4111111111111111 -> 411111******1111
        """
        clean_pan = re.sub(r'\D', '', pan)
        if len(clean_pan) < 13:
            raise ValueError("Invalid PAN length")
        return f"{clean_pan[:6]}{'*' * (len(clean_pan) - 10)}{clean_pan[-4:]}"

    def encrypt_pan(self, pan: str) -> bytes:
        """PAN ì•”í˜¸í™” (ìš”êµ¬ì‚¬í•­ 3.5)

        AES-256 ì´ìƒ ê°•ë„ì˜ ì•”í˜¸í™” í•„ìˆ˜
        """
        clean_pan = re.sub(r'\D', '', pan)
        encrypted = self.cipher.encrypt(clean_pan.encode())

        audit_logger.info(f"PAN encrypted: last4={clean_pan[-4:]}")
        return encrypted

    def hash_pan(self, pan: str) -> str:
        """PAN í•´ì‹± (ê²€ìƒ‰ìš©, ë‹¨ë°©í–¥)

        SHA-256 ì´ìƒ ê¶Œì¥, ì†”íŠ¸ ì¶”ê°€
        """
        clean_pan = re.sub(r'\D', '', pan)
        salt = "PCI_DSS_SALT_DO_NOT_SHARE"  # ì‹¤ì œë¡œëŠ” ì•ˆì „í•˜ê²Œ ê´€ë¦¬
        return hashlib.sha256(f"{salt}{clean_pan}".encode()).hexdigest()

    def truncate_pan(self, pan: str) -> str:
        """PAN ìë¥´ê¸° (ë§ˆì§€ë§‰ 4ìë¦¬ë§Œ ì €ì¥)

        ì•”í˜¸í™” ì—†ì´ ì €ì¥ ê°€ëŠ¥í•œ í˜•íƒœ
        """
        clean_pan = re.sub(r'\D', '', pan)
        return clean_pan[-4:]


class SADProtection:
    """SAD(Sensitive Authentication Data) ë³´í˜¸

    ìš”êµ¬ì‚¬í•­ 3.2: ìŠ¹ì¸ í›„ SAD ì €ì¥ ê¸ˆì§€
    - í’€ íŠ¸ë™ ë°ì´í„° (ë§ˆê·¸ë„¤í‹± ìŠ¤íŠ¸ë¼ì´í”„)
    - CVV/CVC/CID
    - PIN/PIN ë¸”ë¡
    """

    FORBIDDEN_FIELDS = ['cvv', 'cvc', 'cvv2', 'cvc2', 'cid', 'pin',
                        'track1', 'track2', 'magnetic_stripe']

    @classmethod
    def validate_no_sad(cls, data: Dict) -> bool:
        """SAD ë°ì´í„° ì €ì¥ ì‹œë„ íƒì§€"""
        for field in cls.FORBIDDEN_FIELDS:
            if field in data or field.lower() in [k.lower() for k in data.keys()]:
                audit_logger.critical(
                    f"SAD STORAGE ATTEMPT BLOCKED: field={field}"
                )
                raise ValueError(
                    f"PCI DSS Violation: Storing {field} is prohibited after authorization"
                )
        return True

    @classmethod
    def scrub_sad(cls, data: Dict) -> Dict:
        """ì‘ë‹µ ë°ì´í„°ì—ì„œ SAD ì œê±°"""
        scrubbed = data.copy()
        for field in cls.FORBIDDEN_FIELDS:
            scrubbed.pop(field, None)
            # ëŒ€ì†Œë¬¸ì ë¬´ê´€í•˜ê²Œ ì œê±°
            for key in list(scrubbed.keys()):
                if key.lower() == field.lower():
                    del scrubbed[key]
        return scrubbed


def pci_audit_log(action: str):
    """PCI DSS ìš”êµ¬ì‚¬í•­ 10: ê°ì‚¬ ë¡œê·¸ ë°ì½”ë ˆì´í„°"""
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            user_id = kwargs.get('user_id', 'system')
            timestamp = datetime.utcnow().isoformat()

            audit_logger.info(
                f"ACTION_START: action={action}, user={user_id}, time={timestamp}"
            )

            try:
                result = func(*args, **kwargs)
                audit_logger.info(
                    f"ACTION_SUCCESS: action={action}, user={user_id}"
                )
                return result
            except Exception as e:
                audit_logger.error(
                    f"ACTION_FAILED: action={action}, user={user_id}, error={str(e)}"
                )
                raise
        return wrapper
    return decorator


# ì‚¬ìš© ì˜ˆì‹œ
if __name__ == "__main__":
    # ì•”í˜¸í™” í‚¤ ìƒì„± (ì‹¤ì œë¡œëŠ” HSM ë˜ëŠ” KMS ì‚¬ìš©)
    key = Fernet.generate_key()
    storage = PCICompliantStorage(key)

    test_pan = "4111111111111111"

    # PAN ê²€ì¦
    validation = PANValidator.validate(test_pan)
    print(f"PAN ê²€ì¦: {validation}")

    # ë§ˆìŠ¤í‚¹
    masked = storage.mask_pan(test_pan)
    print(f"ë§ˆìŠ¤í‚¹: {masked}")

    # ì•”í˜¸í™”
    encrypted = storage.encrypt_pan(test_pan)
    print(f"ì•”í˜¸í™”: {encrypted[:50]}...")

    # í•´ì‹±
    hashed = storage.hash_pan(test_pan)
    print(f"í•´ì‹œ: {hashed}")

    # SAD ê²€ì¦
    payment_data = {
        'pan': test_pan,
        'expiry': '12/25',
        'cvv': '123'  # ì´ê²ƒì€ ì €ì¥í•˜ë©´ ì•ˆ ë¨!
    }

    try:
        SADProtection.validate_no_sad(payment_data)
    except ValueError as e:
        print(f"SAD ìœ„ë°˜ íƒì§€: {e}")</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="nodejs">
                
                <pre><code class="language-javascript">// PCI DSS ì¤€ìˆ˜ í† í°í™” ì„œë¹„ìŠ¤ - Node.js
const crypto = require('crypto');
const { v4: uuidv4 } = require('uuid');

/**
 * PCI DSS ìš”êµ¬ì‚¬í•­ 3 ì¤€ìˆ˜ë¥¼ ìœ„í•œ í† í°í™” ì„œë¹„ìŠ¤
 * ì‹¤ì œ PANì„ í† í°ìœ¼ë¡œ ëŒ€ì²´í•˜ì—¬ CDE ë²”ìœ„ ìµœì†Œí™”
 */
class TokenizationService {
    constructor() {
        // í† í°-PAN ë§¤í•‘ ì €ì¥ì†Œ (ì‹¤ì œë¡œëŠ” HSM + ì•”í˜¸í™”ëœ DB)
        this.tokenVault = new Map();
        this.encryptionKey = crypto.randomBytes(32);
        this.algorithm = 'aes-256-gcm';
    }

    /**
     * PANì„ í† í°ìœ¼ë¡œ ë³€í™˜
     * @param {string} pan - ì¹´ë“œë²ˆí˜¸
     * @returns {object} - í† í° ë° ë§ˆìŠ¤í‚¹ëœ PAN
     */
    tokenize(pan) {
        const cleanPan = pan.replace(/\D/g, '');

        // Luhn ê²€ì¦
        if (!this.luhnCheck(cleanPan)) {
            throw new Error('Invalid PAN: Luhn check failed');
        }

        // ê¸°ì¡´ í† í° í™•ì¸ (ì¤‘ë³µ ë°©ì§€)
        for (const [token, encrypted] of this.tokenVault) {
            const decrypted = this.decrypt(encrypted);
            if (decrypted === cleanPan) {
                return {
                    token,
                    maskedPan: this.maskPan(cleanPan),
                    last4: cleanPan.slice(-4)
                };
            }
        }

        // ìƒˆ í† í° ìƒì„± (í¬ë§· ë³´ì¡´ ì˜µì…˜)
        const token = this.generateToken(cleanPan);

        // PAN ì•”í˜¸í™” í›„ ì €ì¥
        const encrypted = this.encrypt(cleanPan);
        this.tokenVault.set(token, encrypted);

        console.log(`[AUDIT] PAN tokenized: last4=${cleanPan.slice(-4)}, token=${token.slice(0, 8)}...`);

        return {
            token,
            maskedPan: this.maskPan(cleanPan),
            last4: cleanPan.slice(-4)
        };
    }

    /**
     * í† í°ì„ PANìœ¼ë¡œ ë³µì› (ê¶Œí•œ ìˆëŠ” ì‹œìŠ¤í…œë§Œ)
     * @param {string} token - í† í°
     * @param {string} purpose - ë³µì› ëª©ì  (ê°ì‚¬ìš©)
     * @returns {string} - ì›ë³¸ PAN
     */
    detokenize(token, purpose) {
        const encrypted = this.tokenVault.get(token);
        if (!encrypted) {
            throw new Error('Token not found');
        }

        const pan = this.decrypt(encrypted);

        console.log(`[AUDIT] PAN detokenized: token=${token.slice(0, 8)}..., purpose=${purpose}`);

        return pan;
    }

    /**
     * í¬ë§· ë³´ì¡´ í† í° ìƒì„± (FPE ìŠ¤íƒ€ì¼)
     * ì‹¤ì œë¡œëŠ” BIN(ì²˜ìŒ 6ìë¦¬) + ë§ˆì§€ë§‰ 4ìë¦¬ ìœ ì§€ ê°€ëŠ¥
     */
    generateToken(pan) {
        // ì˜µì…˜ 1: UUID ê¸°ë°˜ (ì™„ì „ ëœë¤)
        // return uuidv4().replace(/-/g, '').slice(0, 16);

        // ì˜µì…˜ 2: í¬ë§· ë³´ì¡´ (BIN + ëœë¤ + last4)
        const bin = pan.slice(0, 6);
        const last4 = pan.slice(-4);
        const middle = crypto.randomBytes(3).toString('hex').slice(0, 6);
        return `${bin}${middle}${last4}`;
    }

    /**
     * AES-256-GCM ì•”í˜¸í™”
     */
    encrypt(plaintext) {
        const iv = crypto.randomBytes(16);
        const cipher = crypto.createCipheriv(this.algorithm, this.encryptionKey, iv);

        let encrypted = cipher.update(plaintext, 'utf8', 'hex');
        encrypted += cipher.final('hex');
        const authTag = cipher.getAuthTag();

        return JSON.stringify({
            iv: iv.toString('hex'),
            authTag: authTag.toString('hex'),
            data: encrypted
        });
    }

    /**
     * AES-256-GCM ë³µí˜¸í™”
     */
    decrypt(encryptedJson) {
        const { iv, authTag, data } = JSON.parse(encryptedJson);

        const decipher = crypto.createDecipheriv(
            this.algorithm,
            this.encryptionKey,
            Buffer.from(iv, 'hex')
        );
        decipher.setAuthTag(Buffer.from(authTag, 'hex'));

        let decrypted = decipher.update(data, 'hex', 'utf8');
        decrypted += decipher.final('utf8');

        return decrypted;
    }

    /**
     * PAN ë§ˆìŠ¤í‚¹ (ìš”êµ¬ì‚¬í•­ 3.4)
     */
    maskPan(pan) {
        return `${pan.slice(0, 6)}${'*'.repeat(pan.length - 10)}${pan.slice(-4)}`;
    }

    /**
     * Luhn ì•Œê³ ë¦¬ì¦˜ ê²€ì¦
     */
    luhnCheck(pan) {
        let sum = 0;
        let isEven = false;

        for (let i = pan.length - 1; i >= 0; i--) {
            let digit = parseInt(pan[i], 10);

            if (isEven) {
                digit *= 2;
                if (digit > 9) digit -= 9;
            }

            sum += digit;
            isEven = !isEven;
        }

        return sum % 10 === 0;
    }
}

/**
 * PCI DSS ìš”êµ¬ì‚¬í•­ 4: ì „ì†¡ ì¤‘ ì•”í˜¸í™” ê²€ì¦ ë¯¸ë“¤ì›¨ì–´
 */
function requireTLS(req, res, next) {
    // X-Forwarded-Proto í—¤ë” ë˜ëŠ” ì§ì ‘ ì—°ê²° í™•ì¸
    const isSecure = req.secure ||
        req.headers['x-forwarded-proto'] === 'https' ||
        req.connection.encrypted;

    if (!isSecure && process.env.NODE_ENV === 'production') {
        console.log(`[AUDIT] INSECURE_CONNECTION_BLOCKED: ip=${req.ip}`);
        return res.status(403).json({
            error: 'PCI DSS Requirement 4: TLS required for cardholder data transmission'
        });
    }

    // TLS ë²„ì „ í™•ì¸ (1.2 ì´ìƒ í•„ìˆ˜)
    const tlsVersion = req.connection.getPeerCertificate?.()?.version;
    if (tlsVersion && parseFloat(tlsVersion) < 1.2) {
        return res.status(403).json({
            error: 'PCI DSS: TLS 1.2 or higher required'
        });
    }

    next();
}

// ì‚¬ìš© ì˜ˆì‹œ
const tokenService = new TokenizationService();

// í† í°í™”
const result = tokenService.tokenize('4111111111111111');
console.log('í† í°í™” ê²°ê³¼:', result);

// ë””í† í°í™” (ê²°ì œ ì²˜ë¦¬ ì‹œì—ë§Œ)
const pan = tokenService.detokenize(result.token, 'payment_processing');
console.log('ë³µì›ëœ PAN:', tokenService.maskPan(pan));

module.exports = { TokenizationService, requireTLS };</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="sql">
                
                <pre><code class="language-sql">-- PCI DSS ì¤€ìˆ˜ë¥¼ ìœ„í•œ SQL ë°ì´í„° ë³´í˜¸ ê¸°ë²•

-- =====================================================
-- ìš”êµ¬ì‚¬í•­ 3: ì €ì¥ëœ ì¹´ë“œí™€ë” ë°ì´í„° ë³´í˜¸
-- =====================================================

-- 1. ì¹´ë“œ ë°ì´í„° í…Œì´ë¸” êµ¬ì¡° (ì˜¬ë°”ë¥¸ ì„¤ê³„)
CREATE TABLE payment_tokens (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    token VARCHAR(32) NOT NULL UNIQUE,          -- í† í° (PAN ëŒ€ì²´)
    pan_hash VARCHAR(64) NOT NULL,              -- SHA-256 í•´ì‹œ (ê²€ìƒ‰ìš©)
    pan_last4 CHAR(4) NOT NULL,                 -- ë§ˆì§€ë§‰ 4ìë¦¬ (í‘œì‹œìš©)
    bin CHAR(6),                                -- BIN (ì²˜ìŒ 6ìë¦¬, ì„ íƒì )
    card_brand VARCHAR(20),                     -- Visa, Mastercard ë“±
    expiry_month SMALLINT,                      -- ë§Œë£Œ ì›” (ì•”í˜¸í™” ê°€ëŠ¥)
    expiry_year SMALLINT,                       -- ë§Œë£Œ ë…„
    cardholder_name_encrypted BYTEA,            -- ì•”í˜¸í™”ëœ ì¹´ë“œì†Œìœ ìëª…
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- CVV/CVCëŠ” ì ˆëŒ€ ì €ì¥í•˜ì§€ ì•ŠìŒ! (SAD)
    -- PINë„ ì ˆëŒ€ ì €ì¥í•˜ì§€ ì•ŠìŒ! (SAD)

    CONSTRAINT valid_expiry_month CHECK (expiry_month BETWEEN 1 AND 12),
    CONSTRAINT valid_last4 CHECK (pan_last4 ~ '^[0-9]{4}$')
);

-- 2. ì•”í˜¸í™”ëœ PAN ì €ì¥ì†Œ (ë³„ë„ ë³´ì•ˆ DB/HSM ê¶Œì¥)
CREATE TABLE pan_vault (
    token VARCHAR(32) PRIMARY KEY REFERENCES payment_tokens(token),
    encrypted_pan BYTEA NOT NULL,               -- AES-256 ì•”í˜¸í™”ëœ PAN
    key_id VARCHAR(36) NOT NULL,                -- ì•”í˜¸í™” í‚¤ ì‹ë³„ì
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- ì ‘ê·¼ ê°ì‚¬ìš© ì»¬ëŸ¼
    last_accessed_at TIMESTAMP,
    access_count INTEGER DEFAULT 0
);

-- 3. PAN ë§ˆìŠ¤í‚¹ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION mask_pan(pan TEXT)
RETURNS TEXT AS $$
BEGIN
    -- ì²˜ìŒ 6ìë¦¬ + ë§ˆìŠ¤í¬ + ë§ˆì§€ë§‰ 4ìë¦¬
    RETURN SUBSTRING(pan, 1, 6) ||
           REPEAT('*', LENGTH(pan) - 10) ||
           SUBSTRING(pan, LENGTH(pan) - 3);
END;
$$ LANGUAGE plpgsql IMMUTABLE;

-- ì˜ˆì‹œ: SELECT mask_pan('4111111111111111');
-- ê²°ê³¼: 411111******1111

-- 4. PAN í•´ì‹± í•¨ìˆ˜ (ê²€ìƒ‰ìš©)
CREATE OR REPLACE FUNCTION hash_pan(pan TEXT, salt TEXT DEFAULT 'PCI_SALT')
RETURNS TEXT AS $$
BEGIN
    RETURN encode(sha256((salt || pan)::bytea), 'hex');
END;
$$ LANGUAGE plpgsql IMMUTABLE;


-- =====================================================
-- ìš”êµ¬ì‚¬í•­ 7: ì¹´ë“œí™€ë” ë°ì´í„° ì ‘ê·¼ ì œí•œ
-- =====================================================

-- 1. ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)
CREATE ROLE pci_readonly;
CREATE ROLE pci_payment_processor;
CREATE ROLE pci_admin;

-- ì½ê¸° ì „ìš© ì—­í• : ë§ˆìŠ¤í‚¹ëœ ë°ì´í„°ë§Œ ì¡°íšŒ ê°€ëŠ¥
GRANT SELECT (id, token, pan_last4, card_brand, expiry_month, expiry_year)
ON payment_tokens TO pci_readonly;

-- ê²°ì œ ì²˜ë¦¬ ì—­í• : PAN vault ì ‘ê·¼ ê°€ëŠ¥
GRANT SELECT ON pan_vault TO pci_payment_processor;
GRANT EXECUTE ON FUNCTION mask_pan TO pci_payment_processor;

-- ê´€ë¦¬ì: ì „ì²´ ì ‘ê·¼ (ê°ì‚¬ ì¶”ì  í•„ìˆ˜)
GRANT ALL ON payment_tokens TO pci_admin;
GRANT ALL ON pan_vault TO pci_admin;


-- =====================================================
-- ìš”êµ¬ì‚¬í•­ 10: ë„¤íŠ¸ì›Œí¬ ë¦¬ì†ŒìŠ¤ ë° CHD ì ‘ê·¼ ì¶”ì 
-- =====================================================

-- 1. ê°ì‚¬ ë¡œê·¸ í…Œì´ë¸”
CREATE TABLE pci_audit_log (
    id BIGSERIAL PRIMARY KEY,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    user_name VARCHAR(100) NOT NULL,
    client_ip INET,
    action VARCHAR(50) NOT NULL,            -- SELECT, INSERT, UPDATE, DELETE
    table_name VARCHAR(100) NOT NULL,
    record_id UUID,
    column_accessed TEXT[],                 -- ì ‘ê·¼í•œ ì»¬ëŸ¼ ëª©ë¡
    query_text TEXT,                        -- ì‹¤í–‰ëœ ì¿¼ë¦¬ (ë§ˆìŠ¤í‚¹ëœ)
    success BOOLEAN NOT NULL,
    error_message TEXT
);

-- 2. ìë™ ê°ì‚¬ ë¡œê·¸ íŠ¸ë¦¬ê±°
CREATE OR REPLACE FUNCTION log_pan_access()
RETURNS TRIGGER AS $$
BEGIN
    INSERT INTO pci_audit_log (
        user_name, client_ip, action, table_name, record_id, success
    ) VALUES (
        current_user,
        inet_client_addr(),
        TG_OP,
        TG_TABLE_NAME,
        COALESCE(NEW.id, OLD.id),
        TRUE
    );
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER audit_pan_vault_access
AFTER SELECT OR INSERT OR UPDATE OR DELETE ON pan_vault
FOR EACH ROW EXECUTE FUNCTION log_pan_access();

-- 3. ë¯¼ê° ë°ì´í„° ì ‘ê·¼ ì‹œ ì•Œë¦¼
CREATE OR REPLACE FUNCTION alert_on_bulk_access()
RETURNS TRIGGER AS $$
DECLARE
    access_count INTEGER;
BEGIN
    -- ì§€ë‚œ 1ë¶„ê°„ ë™ì¼ ì‚¬ìš©ìì˜ ì ‘ê·¼ íšŸìˆ˜ í™•ì¸
    SELECT COUNT(*) INTO access_count
    FROM pci_audit_log
    WHERE user_name = current_user
    AND timestamp > NOW() - INTERVAL '1 minute'
    AND table_name = 'pan_vault';

    -- ì„ê³„ê°’ ì´ˆê³¼ ì‹œ ê²½ê³  (ëŒ€ëŸ‰ ë°ì´í„° ì¶”ì¶œ ì‹œë„ íƒì§€)
    IF access_count > 100 THEN
        RAISE WARNING 'PCI ALERT: Unusual bulk access detected for user %', current_user;
        -- ì‹¤ì œë¡œëŠ” SIEMìœ¼ë¡œ ì•Œë¦¼ ì „ì†¡
    END IF;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;


-- =====================================================
-- ìš”êµ¬ì‚¬í•­ 3.2: SAD ì €ì¥ ë°©ì§€ ì œì•½ì¡°ê±´
-- =====================================================

-- SAD ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” ì²´í¬
-- (ì‹¤ì œë¡œëŠ” DDL íŠ¸ë¦¬ê±°ë¡œ êµ¬í˜„)

-- ê¸ˆì§€ëœ ì»¬ëŸ¼ëª… ëª©ë¡
CREATE TABLE forbidden_columns (
    column_name VARCHAR(50) PRIMARY KEY
);

INSERT INTO forbidden_columns VALUES
    ('cvv'), ('cvc'), ('cvv2'), ('cvc2'), ('cid'),
    ('pin'), ('pin_block'),
    ('track1'), ('track2'), ('magnetic_stripe'),
    ('full_track_data');

-- DDL ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±° (PostgreSQL 9.3+)
CREATE OR REPLACE FUNCTION prevent_sad_columns()
RETURNS event_trigger AS $$
DECLARE
    obj record;
BEGIN
    FOR obj IN SELECT * FROM pg_event_trigger_ddl_commands()
    LOOP
        IF obj.command_tag IN ('CREATE TABLE', 'ALTER TABLE') THEN
            -- ê¸ˆì§€ëœ ì»¬ëŸ¼ëª… ì²´í¬ ë¡œì§
            RAISE NOTICE 'DDL command detected: %', obj.command_tag;
        END IF;
    END LOOP;
END;
$$ LANGUAGE plpgsql;

-- CREATE EVENT TRIGGER check_sad_columns
-- ON ddl_command_end
-- EXECUTE FUNCTION prevent_sad_columns();</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ—£ï¸ ì‹¤ë¬´ì—ì„œ ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”</h2>
            <div class="conversation-examples">
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ê²°ì œ ì‹œìŠ¤í…œ ì„¤ê³„ íšŒì˜ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "CDE ë²”ìœ„ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤. ìš°ë¦¬ ì„œë²„ì—ì„œ PANì„ ì§ì ‘ ì²˜ë¦¬í•˜ì§€ ë§ê³ , PCI ì¸ì¦ëœ ê²°ì œ ê²Œì´íŠ¸ì›¨ì´ì˜ iFrameì´ë‚˜ JavaScript SDKë¥¼ ì‚¬ìš©í•©ì‹œë‹¤. ê·¸ëŸ¬ë©´ SAQ A ë ˆë²¨ë¡œ ì»´í”Œë¼ì´ì–¸ìŠ¤ ë²”ìœ„ê°€ ì¤„ì–´ë“¤ê³ , í† í°ë§Œ ì €ì¥í•˜ë©´ ë©ë‹ˆë‹¤. CVVëŠ” ì ˆëŒ€ ì €ì¥í•˜ì§€ ë§ˆì„¸ìš”. ìŠ¹ì¸ í›„ ì €ì¥ì€ PCI DSS ìœ„ë°˜ì…ë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ PCI DSS ê°ì‚¬ ëŒ€ì‘ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "ì €í¬ëŠ” Level 2 ê°€ë§¹ì ìœ¼ë¡œ SAQ Dë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. ë¶„ê¸°ë³„ ASV ìŠ¤ìº” ê²°ê³¼ì™€ ì—°ê°„ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ ë³´ê³ ì„œê°€ ìˆìŠµë‹ˆë‹¤. PANì€ AES-256ìœ¼ë¡œ ì•”í˜¸í™”ë˜ì–´ ì €ì¥ë˜ê³ , í‚¤ëŠ” HSMì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë©˜í…Œì´ì…˜ì„ í†µí•´ CDEë¥¼ ë¶„ë¦¬í–ˆê³ , ì ‘ê·¼ ë¡œê·¸ëŠ” 1ë…„ê°„ ë³´ê´€í•©ë‹ˆë‹¤. ìš”êµ¬ì‚¬í•­ 10 ì¶©ì¡±ì„ ìœ„í•œ SIEM ëŒ€ì‹œë³´ë“œë¥¼ ë³´ì—¬ë“œë¦´ê¹Œìš”?"
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ê°œë°œíŒ€ì— ë³´ì•ˆ ìš”êµ¬ì‚¬í•­ ì „ë‹¬ ì‹œ</div>
                    <blockquote class="conv-quote">
                        "ê²°ì œ í˜ì´ì§€ëŠ” ë°˜ë“œì‹œ TLS 1.2 ì´ìƒìœ¼ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ í•˜ì„¸ìš”. ì¹´ë“œ ì…ë ¥ í¼ì€ PCI ì¸ì¦ëœ ê²°ì œì‚¬ì˜ í˜¸ìŠ¤í‹°ë“œ í•„ë“œë¥¼ ì‚¬ìš©í•˜ê³ , ìš°ë¦¬ ì„œë²„ë¡œëŠ” í† í°ë§Œ ì „ì†¡ë©ë‹ˆë‹¤. ë¡œê·¸ì— PANì´ ì°íˆì§€ ì•Šë„ë¡ ë§ˆìŠ¤í‚¹ í•„í„°ë¥¼ ì ìš©í•˜ê³ , ì—ëŸ¬ ë©”ì‹œì§€ì—ë„ ì¹´ë“œë²ˆí˜¸ê°€ ë…¸ì¶œë˜ë©´ ì•ˆ ë©ë‹ˆë‹¤. ì½”ë“œ ë¦¬ë·° ì‹œ ì´ ë¶€ë¶„ì„ íŠ¹íˆ í™•ì¸í•´ì£¼ì„¸ìš”."
                    </blockquote>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ -->
        <section class="term-section">
            <h2 class="section-title">âš ï¸ ì£¼ì˜ì‚¬í•­ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h2>
            <div class="warning-list">
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>CVV/PIN ì €ì¥ (SAD ì €ì¥ ê¸ˆì§€ ìœ„ë°˜)</strong>
                        <p>CVV, CVC, PIN, í’€ íŠ¸ë™ ë°ì´í„°ëŠ” ìŠ¹ì¸ í›„ ì ˆëŒ€ ì €ì¥í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤. ë©”ëª¨ë¦¬ì—ì„œë„ ì¦‰ì‹œ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤. ì´ ê·œì¹™ì„ ì–´ê¸°ë©´ ì¹´ë“œì‚¬ë¡œë¶€í„° ê±°ë˜ ì •ì§€, ë§‰ëŒ€í•œ ê³¼ì§•ê¸ˆ, ë°ì´í„° ìœ ì¶œ ì‹œ ì „ì²´ ì†í•´ë°°ìƒ ì±…ì„ì„ ì§‘ë‹ˆë‹¤.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>ë¡œê·¸ì— PAN ê¸°ë¡</strong>
                        <p>ë””ë²„ê·¸ ë¡œê·¸, ì—ëŸ¬ ë¡œê·¸, ì•¡ì„¸ìŠ¤ ë¡œê·¸ì— ì¹´ë“œë²ˆí˜¸ê°€ í‰ë¬¸ìœ¼ë¡œ ê¸°ë¡ë˜ë©´ PCI DSS ìœ„ë°˜ì…ë‹ˆë‹¤. ëª¨ë“  ë¡œê¹… í¬ì¸íŠ¸ì— PAN ë§ˆìŠ¤í‚¹ í•„í„°ë¥¼ ì ìš©í•˜ì„¸ìš”. ì¹´ë“œë²ˆí˜¸ íŒ¨í„´(16ìë¦¬ ìˆ«ì)ì„ ì •ê·œì‹ìœ¼ë¡œ íƒì§€í•´ ìë™ ë§ˆìŠ¤í‚¹í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>CDE ë²”ìœ„ í™•ëŒ€</strong>
                        <p>PANì´ ê²½ìœ í•˜ëŠ” ëª¨ë“  ì‹œìŠ¤í…œì´ CDEì— í¬í•¨ë©ë‹ˆë‹¤. ë²”ìœ„ê°€ ë„“ì–´ì§ˆìˆ˜ë¡ ì»´í”Œë¼ì´ì–¸ìŠ¤ ë¹„ìš©ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•©ë‹ˆë‹¤. í† í°í™”, P2PE(Point-to-Point Encryption), í˜¸ìŠ¤í‹°ë“œ ê²°ì œ í˜ì´ì§€ë¥¼ í™œìš©í•´ CDEë¥¼ ìµœì†Œí™”í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âœ…</span>
                    <div>
                        <strong>PCI DSS ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</strong>
                        <p>PCI ì¸ì¦ëœ ê²°ì œ ì„œë¹„ìŠ¤(Stripe, Adyen ë“±) ì‚¬ìš©, í† í°í™”ë¡œ PAN ì§ì ‘ ì €ì¥ íšŒí”¼, ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë©˜í…Œì´ì…˜ìœ¼ë¡œ CDE ê²©ë¦¬, HSM ê¸°ë°˜ í‚¤ ê´€ë¦¬, ë¶„ê¸°ë³„ ì·¨ì•½ì  ìŠ¤ìº”(ASV), ì—°ê°„ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸, ì§ì› ë³´ì•ˆ êµìœ¡ì„ ì‹¤í–‰í•˜ì„¸ìš”. SAQ ìœ í˜•ì„ ì‹ ì¤‘íˆ ì„ íƒí•´ ë²”ìœ„ë¥¼ ìµœì í™”í•˜ì„¸ìš”.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ”— ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-terms">
                <a href="/ko/term/SOC%202/" class="related-term-link">SOC 2</a>
                <a href="/ko/term/ISO%2027001/" class="related-term-link">ISO 27001</a>
                <a href="/ko/term/Encryption/" class="related-term-link">Encryption</a>
                <a href="/ko/term/Tokenization/" class="related-term-link">Tokenization</a>
                <a href="/ko/term/HSM/" class="related-term-link">HSM</a>
                <a href="/ko/term/Penetration%20Testing/" class="related-term-link">Penetration Testing</a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“š ë” ë°°ìš°ê¸°</h2>
            <div class="learn-more">
                <a href="https://www.pcisecuritystandards.org/" target="_blank" class="learn-link">
                    ğŸ›ï¸ PCI SSC ê³µì‹ ì‚¬ì´íŠ¸
                </a>
                <a href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf" target="_blank" class="learn-link">
                    ğŸ“‹ PCI DSS v4.0 ì „ë¬¸ (PDF)
                </a>
                <a href="https://stripe.com/docs/security/guide" target="_blank" class="learn-link">
                    ğŸ’³ Stripe - PCI ì»´í”Œë¼ì´ì–¸ìŠ¤ ê°€ì´ë“œ
                </a>
                <a href="https://docs.adyen.com/development-resources/pci-dss-compliance-guide" target="_blank" class="learn-link">
                    ğŸ’³ Adyen - PCI DSS ì¤€ìˆ˜ ê°€ì´ë“œ
                </a>
                <a href="https://aws.amazon.com/compliance/pci-dss-level-1-faqs/" target="_blank" class="learn-link">
                    â˜ï¸ AWS PCI DSS Level 1 FAQ
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>
    // ì½”ë“œ ë³µì‚¬ ê¸°ëŠ¥
    function copyCode(btn) {
        const codeBlock = btn.parentElement.querySelector('code');
        navigator.clipboard.writeText(codeBlock.textContent).then(() => {
            btn.textContent = 'âœ… ë³µì‚¬ë¨!';
            setTimeout(() => btn.textContent = 'ğŸ“‹ ë³µì‚¬', 2000);
        });
    }

    // ì½”ë“œ íƒ­ ì „í™˜
    document.querySelectorAll('.code-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const lang = this.dataset.lang;
            const section = this.closest('.term-section');

            section.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            section.querySelectorAll('.code-block').forEach(block => {
                block.classList.remove('active');
                if (block.dataset.lang === lang) {
                    block.classList.add('active');
                }
            });
        });
    });
    </script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "78px", fabRight: "170px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js?v=20260129231616"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
