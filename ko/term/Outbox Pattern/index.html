<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Outbox Pattern (ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="Outbox Patternì€ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ê³¼ ë©”ì‹œì§€ ë°œí–‰ì˜ ì›ìì„±ì„ ë³´ì¥í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤. ì´ë²¤íŠ¸ë¥¼ ë³„ë„ í…Œì´ë¸”ì— ì €ì¥ í›„ ë¹„ë™ê¸°ë¡œ ë°œí–‰í•˜ì—¬ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.">
    <meta name="keywords" content="Outbox Pattern, ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´, íŠ¸ëœì­ì…˜, ì´ë²¤íŠ¸ ì†Œì‹±, CDC, Debezium, Kafka, ë¶„ì‚° ì‹œìŠ¤í…œ, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤, AI ìš©ì–´, KAITRUST">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/Outbox%20Pattern/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/Outbox%20Pattern/">
    <meta property="og:title" content="Outbox Pattern (ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="Outbox Patternì€ ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ê³¼ ë©”ì‹œì§€ ë°œí–‰ì˜ ì›ìì„±ì„ ë³´ì¥í•˜ëŠ” ë¶„ì‚° ì‹œìŠ¤í…œ íŒ¨í„´ì…ë‹ˆë‹¤.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Outbox Pattern (ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="Outbox Patternì€ ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ê³¼ ë©”ì‹œì§€ ë°œí–‰ì˜ ì›ìì„±ì„ ë³´ì¥í•˜ëŠ” ë¶„ì‚° ì‹œìŠ¤í…œ íŒ¨í„´ì…ë‹ˆë‹¤.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "Outbox Pattern",
        "alternateName": "ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´",
        "description": "Outbox Patternì€ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ê³¼ ë©”ì‹œì§€ ë°œí–‰ì˜ ì›ìì„±ì„ ë³´ì¥í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        /* ê³ ë„í™” ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .term-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-content p {
            color: #cbd5e1;
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        .section-content p:last-child { margin-bottom: 0; }

        /* ì½”ë“œ ë¸”ë¡ */
        .code-tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap; }
        .code-tab {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s;
        }
        .code-tab.active {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
            color: #a855f7;
        }
        .code-block {
            position: relative;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
            display: none;
        }
        .code-block.active { display: block; }
        .code-block pre { padding: 1.5rem; margin: 0; overflow-x: auto; }
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
            line-height: 1.6;
        }
        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.3);
            border: none;
            border-radius: 6px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        .copy-btn:hover { background: rgba(168, 85, 247, 0.5); }

        /* ëŒ€í™” ì˜ˆì‹œ */
        .conversation-examples { display: flex; flex-direction: column; gap: 1.5rem; }
        .conv-item { background: rgba(0, 0, 0, 0.2); border-radius: 12px; padding: 1.25rem; }
        .conv-context { font-size: 0.9rem; color: #a855f7; font-weight: 500; margin-bottom: 0.75rem; }
        .conv-quote {
            color: #e2e8f0;
            font-style: italic;
            line-height: 1.7;
            margin: 0;
            padding-left: 1rem;
            border-left: 3px solid #a855f7;
        }

        /* ì£¼ì˜ì‚¬í•­ */
        .warning-list { display: flex; flex-direction: column; gap: 1rem; }
        .warning-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .warning-icon { font-size: 1.5rem; }
        .warning-item strong { color: #f1f5f9; display: block; margin-bottom: 0.25rem; }
        .warning-item p { color: #94a3b8; margin: 0; font-size: 0.95rem; }

        /* ê´€ë ¨ ìš©ì–´ */
        .related-terms { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .related-term-link {
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            color: #a855f7;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .related-term-link:hover { background: rgba(168, 85, 247, 0.2); transform: translateY(-2px); }

        /* ë” ë°°ìš°ê¸° */
        .learn-more { display: flex; flex-direction: column; gap: 0.75rem; }
        .learn-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            color: #00f5ff;
            text-decoration: none;
            transition: all 0.2s;
        }
        .learn-link:hover { background: rgba(0, 0, 0, 0.3); transform: translateX(5px); }

        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a { color: #64748b; text-decoration: none; transition: color 0.2s; }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english { font-size: 1.2rem; color: #94a3b8; margin-bottom: 1.5rem; }
        .term-description { font-size: 1.1rem; line-height: 1.8; color: #e2e8f0; }
        .term-actions { display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap; }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary { background: linear-gradient(135deg, #a855f7, #6366f1); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #e2e8f0; border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
        }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css?v=20260129232035">

</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#arch">ì•„í‚¤í…ì²˜</a>
            <span>â€º</span>
            <span class="current">Outbox Pattern</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ—ï¸</span>
                <span>ì•„í‚¤í…ì²˜</span>
            </div>
            <h1 class="term-title">Outbox Pattern</h1>
            <p class="term-english">ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´</p>
            <div class="term-description">
                <p>ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ê³¼ ë©”ì‹œì§€ ë°œí–‰ì˜ ì›ìì„±ì„ ë³´ì¥í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„° ë³€ê²½ ì‹œ ì´ë²¤íŠ¸ë¥¼ ê°™ì€ íŠ¸ëœì­ì…˜ ë‚´ Outbox í…Œì´ë¸”ì— ì €ì¥í•˜ê³ , ë³„ë„ í”„ë¡œì„¸ìŠ¤ê°€ ì´ë¥¼ ì½ì–´ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œ ë°œí–‰í•©ë‹ˆë‹¤. "ì´ì¤‘ ì“°ê¸°(Dual Write)" ë¬¸ì œë¥¼ í•´ê²°í•˜ì—¬ ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#arch" class="term-action-btn btn-secondary">
                    ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“– ìƒì„¸ ì„¤ëª…</h2>
            <div class="section-content">
                <p><strong>íŒ¨í„´ ì›ë¦¬:</strong> ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ "DB ì—…ë°ì´íŠ¸ í›„ Kafkaì— ë©”ì‹œì§€ ë°œí–‰"ì²˜ëŸ¼ ë‘ ì‹œìŠ¤í…œì— ë™ì‹œì— ì“°ëŠ” ê²ƒì€ ìœ„í—˜í•©ë‹ˆë‹¤. DB ì»¤ë°‹ì€ ì„±ê³µí–ˆëŠ”ë° Kafka ë°œí–‰ì´ ì‹¤íŒ¨í•˜ë©´ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•©ë‹ˆë‹¤. Outbox Patternì€ ë©”ì‹œì§€ë¥¼ DBì˜ outbox í…Œì´ë¸”ì— ë¨¼ì € ì €ì¥í•˜ê³ (ë‹¨ì¼ íŠ¸ëœì­ì…˜), ë³„ë„ í”„ë¡œì„¸ìŠ¤ê°€ ì´ë¥¼ ì½ì–´ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œ "at-least-once" ë°œí–‰í•©ë‹ˆë‹¤.</p>
                <p><strong>ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:</strong> ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹ , ì£¼ë¬¸-ê²°ì œ-ë°°ì†¡ ê°™ì€ Saga íŒ¨í„´ êµ¬í˜„, CDC(Change Data Capture) ê¸°ë°˜ ë°ì´í„° ë™ê¸°í™”ì— í™œìš©ë©ë‹ˆë‹¤. ì´ì»¤ë¨¸ìŠ¤ì—ì„œ ì£¼ë¬¸ ìƒì„± ì‹œ "ì£¼ë¬¸ ìƒì„± ì´ë²¤íŠ¸"ë¥¼ ì•ˆì „í•˜ê²Œ ë°œí–‰í•˜ê±°ë‚˜, ê²°ì œ ì„œë¹„ìŠ¤ê°€ ê²°ì œ ì™„ë£Œ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
                <p><strong>ì¥ì :</strong> ë°ì´í„° ì¼ê´€ì„±ì´ ë³´ì¥ë˜ê³  ë©”ì‹œì§€ ìœ ì‹¤ì´ ì—†ìŠµë‹ˆë‹¤. ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì¥ì•  ì‹œì—ë„ outboxì— ì €ì¥ë˜ì–´ ìˆì–´ ë³µêµ¬ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê¸°ì¡´ RDBMS íŠ¸ëœì­ì…˜ì„ í™œìš©í•˜ë¯€ë¡œ ìµìˆ™í•œ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í´ë§ ë°©ì‹ ëŒ€ì‹  Debezium ê°™ì€ CDC ë„êµ¬ë¡œ ì‹¤ì‹œê°„ ë°œí–‰ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                <p><strong>ë‹¨ì :</strong> ì¶”ê°€ í…Œì´ë¸”ê³¼ í”„ë¡œì„¸ìŠ¤(í´ëŸ¬ ë˜ëŠ” CDC)ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë©”ì‹œì§€ê°€ ì¤‘ë³µ ë°œí–‰ë  ìˆ˜ ìˆì–´ ìˆ˜ì‹ ìê°€ ë©±ë“±ì„±(Idempotency)ì„ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. Outbox í…Œì´ë¸”ì´ ì»¤ì§€ë©´ ì„±ëŠ¥ ì €í•˜ê°€ ìˆì–´ ì£¼ê¸°ì  ì •ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. CDC ë„êµ¬ ë„ì… ì‹œ ìš´ì˜ ë³µì¡ë„ê°€ ì¦ê°€í•©ë‹ˆë‹¤.</p>
                <p>Debezium + Kafka Connectë¥¼ í™œìš©í•˜ë©´ í´ë§ ì—†ì´ binlog/WALì„ ê°ì§€í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. AWSì—ì„œëŠ” DynamoDB Streams + Lambda, GCPì—ì„œëŠ” Cloud Spanner Change Streamsë¡œ ìœ ì‚¬í•˜ê²Œ êµ¬í˜„í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ’» ì½”ë“œ ì˜ˆì œ</h2>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="python">Python êµ¬í˜„</button>
                <button class="code-tab" data-lang="node">Node.js + Prisma</button>
                <button class="code-tab" data-lang="debezium">Debezium CDC</button>
            </div>
            <div class="code-block active" data-lang="python">
                <pre><code class="language-python"># Outbox Pattern êµ¬í˜„ - Python + SQLAlchemy
from sqlalchemy import create_engine, Column, String, DateTime, Text, Boolean
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from datetime import datetime
import json
import uuid
import threading
import time

Base = declarative_base()

# Outbox í…Œì´ë¸” ì •ì˜
class OutboxMessage(Base):
    """ì´ë²¤íŠ¸ë¥¼ ì €ì¥í•˜ëŠ” Outbox í…Œì´ë¸”"""
    __tablename__ = 'outbox'

    id = Column(String(36), primary_key=True, default=lambda: str(uuid.uuid4()))
    aggregate_type = Column(String(100), nullable=False)  # e.g., 'Order'
    aggregate_id = Column(String(100), nullable=False)    # e.g., order_id
    event_type = Column(String(100), nullable=False)      # e.g., 'OrderCreated'
    payload = Column(Text, nullable=False)                # JSON ë°ì´í„°
    created_at = Column(DateTime, default=datetime.utcnow)
    published = Column(Boolean, default=False)
    published_at = Column(DateTime, nullable=True)


class Order(Base):
    """ì£¼ë¬¸ ë„ë©”ì¸ ëª¨ë¸"""
    __tablename__ = 'orders'

    id = Column(String(36), primary_key=True, default=lambda: str(uuid.uuid4()))
    customer_id = Column(String(100), nullable=False)
    total_amount = Column(String(20), nullable=False)
    status = Column(String(50), default='PENDING')
    created_at = Column(DateTime, default=datetime.utcnow)


class OrderService:
    """ì£¼ë¬¸ ì„œë¹„ìŠ¤ - Outbox íŒ¨í„´ ì ìš©"""

    def __init__(self, session_factory):
        self.session_factory = session_factory

    def create_order(self, customer_id: str, items: list, total_amount: float) -> Order:
        """
        ì£¼ë¬¸ ìƒì„± + ì´ë²¤íŠ¸ë¥¼ Outboxì— ì €ì¥ (ë‹¨ì¼ íŠ¸ëœì­ì…˜)
        """
        session = self.session_factory()

        try:
            # 1. ì£¼ë¬¸ ìƒì„±
            order = Order(
                customer_id=customer_id,
                total_amount=str(total_amount),
                status='CREATED'
            )
            session.add(order)

            # 2. Outboxì— ì´ë²¤íŠ¸ ì €ì¥ (ê°™ì€ íŠ¸ëœì­ì…˜!)
            event_payload = {
                'order_id': order.id,
                'customer_id': customer_id,
                'items': items,
                'total_amount': total_amount,
                'status': 'CREATED',
                'created_at': datetime.utcnow().isoformat()
            }

            outbox_message = OutboxMessage(
                aggregate_type='Order',
                aggregate_id=order.id,
                event_type='OrderCreated',
                payload=json.dumps(event_payload)
            )
            session.add(outbox_message)

            # 3. ë‹¨ì¼ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì»¤ë°‹
            # DB ì €ì¥ê³¼ ì´ë²¤íŠ¸ ì €ì¥ì´ ì›ìì ìœ¼ë¡œ ì²˜ë¦¬ë¨!
            session.commit()

            print(f"âœ… ì£¼ë¬¸ ìƒì„± ì™„ë£Œ: {order.id}")
            print(f"âœ… Outbox ì´ë²¤íŠ¸ ì €ì¥: OrderCreated")

            return order

        except Exception as e:
            session.rollback()
            print(f"âŒ ì£¼ë¬¸ ìƒì„± ì‹¤íŒ¨: {e}")
            raise
        finally:
            session.close()


class OutboxPoller:
    """
    Outbox í´ëŸ¬ - ì£¼ê¸°ì ìœ¼ë¡œ Outboxë¥¼ ì½ì–´ ë©”ì‹œì§€ ë°œí–‰
    ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” Debezium CDC ì‚¬ìš© ê¶Œì¥
    """

    def __init__(self, session_factory, message_publisher):
        self.session_factory = session_factory
        self.publisher = message_publisher
        self.running = False

    def start(self, poll_interval: float = 1.0):
        """í´ë§ ì‹œì‘"""
        self.running = True
        thread = threading.Thread(target=self._poll_loop, args=(poll_interval,))
        thread.daemon = True
        thread.start()

    def stop(self):
        self.running = False

    def _poll_loop(self, interval: float):
        while self.running:
            self._process_outbox()
            time.sleep(interval)

    def _process_outbox(self):
        session = self.session_factory()

        try:
            # ë¯¸ë°œí–‰ ë©”ì‹œì§€ ì¡°íšŒ (FOR UPDATEë¡œ ë½)
            messages = session.query(OutboxMessage).filter(
                OutboxMessage.published == False
            ).order_by(OutboxMessage.created_at).limit(100).with_for_update().all()

            for msg in messages:
                try:
                    # ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œ ë°œí–‰
                    self.publisher.publish(
                        topic=f"{msg.aggregate_type.lower()}-events",
                        key=msg.aggregate_id,
                        value=msg.payload,
                        headers={
                            'event_type': msg.event_type,
                            'message_id': msg.id
                        }
                    )

                    # ë°œí–‰ ì™„ë£Œ í‘œì‹œ
                    msg.published = True
                    msg.published_at = datetime.utcnow()

                    print(f"ğŸ“¤ ì´ë²¤íŠ¸ ë°œí–‰: {msg.event_type} ({msg.aggregate_id})")

                except Exception as e:
                    print(f"âŒ ë°œí–‰ ì‹¤íŒ¨, ì¬ì‹œë„ ì˜ˆì •: {e}")
                    # ì‹¤íŒ¨í•´ë„ ë‹¤ìŒ í´ë§ì—ì„œ ì¬ì‹œë„

            session.commit()

        except Exception as e:
            session.rollback()
            print(f"âŒ Outbox ì²˜ë¦¬ ì˜¤ë¥˜: {e}")
        finally:
            session.close()


# Kafka ë°œí–‰ì ì˜ˆì‹œ
class KafkaMessagePublisher:
    def __init__(self, bootstrap_servers: str):
        from kafka import KafkaProducer
        self.producer = KafkaProducer(
            bootstrap_servers=bootstrap_servers,
            value_serializer=lambda v: v.encode('utf-8') if isinstance(v, str) else v
        )

    def publish(self, topic: str, key: str, value: str, headers: dict = None):
        header_list = [(k, v.encode()) for k, v in (headers or {}).items()]
        self.producer.send(topic, key=key.encode(), value=value, headers=header_list)
        self.producer.flush()


# ì‚¬ìš© ì˜ˆì‹œ
if __name__ == "__main__":
    engine = create_engine('postgresql://localhost/orders')
    Base.metadata.create_all(engine)
    Session = sessionmaker(bind=engine)

    # ì„œë¹„ìŠ¤ ìƒì„±
    order_service = OrderService(Session)

    # í´ëŸ¬ ì‹œì‘
    publisher = KafkaMessagePublisher('localhost:9092')
    poller = OutboxPoller(Session, publisher)
    poller.start()

    # ì£¼ë¬¸ ìƒì„± (DB + Outbox ì›ìì  ì €ì¥)
    order = order_service.create_order(
        customer_id='CUST-001',
        items=[{'product_id': 'PROD-1', 'quantity': 2}],
        total_amount=50000
    )</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="node">
                
                <pre><code class="language-typescript">// Outbox Pattern - Node.js + Prisma + TypeScript
import { PrismaClient, Prisma } from '@prisma/client';
import { Kafka, Producer } from 'kafkajs';
import { v4 as uuidv4 } from 'uuid';

const prisma = new PrismaClient();

// Prisma ìŠ¤í‚¤ë§ˆ (schema.prisma)
/*
model Order {
  id          String   @id @default(uuid())
  customerId  String
  totalAmount Decimal
  status      String   @default("PENDING")
  createdAt   DateTime @default(now())
}

model OutboxMessage {
  id            String    @id @default(uuid())
  aggregateType String
  aggregateId   String
  eventType     String
  payload       Json
  published     Boolean   @default(false)
  publishedAt   DateTime?
  createdAt     DateTime  @default(now())

  @@index([published, createdAt])
}
*/

interface OrderCreatedEvent {
  orderId: string;
  customerId: string;
  items: Array<{ productId: string; quantity: number }>;
  totalAmount: number;
  status: string;
  createdAt: string;
}

class OrderService {
  /**
   * ì£¼ë¬¸ ìƒì„± - Outbox íŒ¨í„´ìœ¼ë¡œ ì´ë²¤íŠ¸ ì €ì¥
   */
  async createOrder(
    customerId: string,
    items: Array<{ productId: string; quantity: number }>,
    totalAmount: number
  ) {
    // Prisma íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì›ìì„± ë³´ì¥
    const result = await prisma.$transaction(async (tx) => {
      // 1. ì£¼ë¬¸ ìƒì„±
      const order = await tx.order.create({
        data: {
          customerId,
          totalAmount,
          status: 'CREATED',
        },
      });

      // 2. Outboxì— ì´ë²¤íŠ¸ ì €ì¥ (ê°™ì€ íŠ¸ëœì­ì…˜!)
      const eventPayload: OrderCreatedEvent = {
        orderId: order.id,
        customerId,
        items,
        totalAmount,
        status: 'CREATED',
        createdAt: new Date().toISOString(),
      };

      await tx.outboxMessage.create({
        data: {
          aggregateType: 'Order',
          aggregateId: order.id,
          eventType: 'OrderCreated',
          payload: eventPayload as unknown as Prisma.JsonObject,
        },
      });

      console.log(`âœ… ì£¼ë¬¸ ìƒì„±: ${order.id}`);
      console.log(`âœ… Outbox ì €ì¥: OrderCreated`);

      return order;
    });

    return result;
  }

  /**
   * ì£¼ë¬¸ ì·¨ì†Œ - ìƒíƒœ ë³€ê²½ + ì´ë²¤íŠ¸ ì €ì¥
   */
  async cancelOrder(orderId: string, reason: string) {
    return await prisma.$transaction(async (tx) => {
      const order = await tx.order.update({
        where: { id: orderId },
        data: { status: 'CANCELLED' },
      });

      await tx.outboxMessage.create({
        data: {
          aggregateType: 'Order',
          aggregateId: orderId,
          eventType: 'OrderCancelled',
          payload: {
            orderId,
            reason,
            cancelledAt: new Date().toISOString(),
          } as Prisma.JsonObject,
        },
      });

      return order;
    });
  }
}

/**
 * Outbox í´ëŸ¬ - ë¯¸ë°œí–‰ ë©”ì‹œì§€ë¥¼ Kafkaë¡œ ë°œí–‰
 */
class OutboxPublisher {
  private producer: Producer;
  private isRunning = false;

  constructor(kafkaBrokers: string[]) {
    const kafka = new Kafka({
      clientId: 'outbox-publisher',
      brokers: kafkaBrokers,
    });
    this.producer = kafka.producer();
  }

  async start(pollIntervalMs: number = 1000) {
    await this.producer.connect();
    this.isRunning = true;

    console.log('ğŸš€ Outbox í´ëŸ¬ ì‹œì‘');

    while (this.isRunning) {
      await this.processOutbox();
      await this.sleep(pollIntervalMs);
    }
  }

  async stop() {
    this.isRunning = false;
    await this.producer.disconnect();
  }

  private async processOutbox() {
    // ë¯¸ë°œí–‰ ë©”ì‹œì§€ ì¡°íšŒ ë° ì²˜ë¦¬
    const messages = await prisma.outboxMessage.findMany({
      where: { published: false },
      orderBy: { createdAt: 'asc' },
      take: 100,
    });

    for (const msg of messages) {
      try {
        // Kafkaë¡œ ë°œí–‰
        await this.producer.send({
          topic: `${msg.aggregateType.toLowerCase()}-events`,
          messages: [
            {
              key: msg.aggregateId,
              value: JSON.stringify(msg.payload),
              headers: {
                eventType: msg.eventType,
                messageId: msg.id,
              },
            },
          ],
        });

        // ë°œí–‰ ì™„ë£Œ í‘œì‹œ
        await prisma.outboxMessage.update({
          where: { id: msg.id },
          data: {
            published: true,
            publishedAt: new Date(),
          },
        });

        console.log(`ğŸ“¤ ë°œí–‰: ${msg.eventType} (${msg.aggregateId})`);
      } catch (error) {
        console.error(`âŒ ë°œí–‰ ì‹¤íŒ¨: ${msg.id}`, error);
        // ë‹¤ìŒ í´ë§ì—ì„œ ì¬ì‹œë„
      }
    }
  }

  private sleep(ms: number): Promise<void> {
    return new Promise((resolve) => setTimeout(resolve, ms));
  }
}

/**
 * Outbox í´ë¦¬ë„ˆ - ì˜¤ë˜ëœ ë°œí–‰ ì™„ë£Œ ë©”ì‹œì§€ ì‚­ì œ
 */
async function cleanupOutbox(retentionDays: number = 7) {
  const cutoffDate = new Date();
  cutoffDate.setDate(cutoffDate.getDate() - retentionDays);

  const result = await prisma.outboxMessage.deleteMany({
    where: {
      published: true,
      publishedAt: { lt: cutoffDate },
    },
  });

  console.log(`ğŸ§¹ ${result.count}ê°œ ì˜¤ë˜ëœ Outbox ë©”ì‹œì§€ ì‚­ì œ`);
}

// ì‚¬ìš© ì˜ˆì‹œ
async function main() {
  const orderService = new OrderService();

  // ì£¼ë¬¸ ìƒì„± (ì›ìì ìœ¼ë¡œ DB + Outbox ì €ì¥)
  const order = await orderService.createOrder(
    'customer-123',
    [{ productId: 'prod-1', quantity: 2 }],
    50000
  );

  // Outbox í´ëŸ¬ ì‹œì‘ (ë³„ë„ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ ê¶Œì¥)
  const publisher = new OutboxPublisher(['localhost:9092']);
  await publisher.start();
}

main();</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="debezium">
                
                <pre><code class="language-json">// Debezium CDCë¥¼ ì‚¬ìš©í•œ Outbox Pattern
// í´ë§ ëŒ€ì‹  DB ë³€ê²½ ë¡œê·¸(binlog/WAL)ë¥¼ ì‹¤ì‹œê°„ ìº¡ì²˜

// 1. Outbox í…Œì´ë¸” ìƒì„± (PostgreSQL)
/*
CREATE TABLE outbox (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    aggregate_type VARCHAR(100) NOT NULL,
    aggregate_id VARCHAR(100) NOT NULL,
    event_type VARCHAR(100) NOT NULL,
    payload JSONB NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Debeziumì´ ì½ì€ í›„ ìë™ ì‚­ì œë¥¼ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX idx_outbox_created ON outbox(created_at);
*/

// 2. Debezium Connector ì„¤ì • (Kafka Connect)
{
  "name": "outbox-connector",
  "config": {
    "connector.class": "io.debezium.connector.postgresql.PostgresConnector",
    "database.hostname": "postgres",
    "database.port": "5432",
    "database.user": "debezium",
    "database.password": "secret",
    "database.dbname": "orders_db",
    "database.server.name": "orders",

    // Outbox í…Œì´ë¸”ë§Œ ìº¡ì²˜
    "table.include.list": "public.outbox",

    // Outbox ì´ë²¤íŠ¸ ë¼ìš°í„° ì‚¬ìš©
    "transforms": "outbox",
    "transforms.outbox.type": "io.debezium.transforms.outbox.EventRouter",

    // í† í”½ ë¼ìš°íŒ… ì„¤ì •
    "transforms.outbox.table.field.event.key": "aggregate_id",
    "transforms.outbox.table.field.event.type": "event_type",
    "transforms.outbox.table.field.event.payload": "payload",
    "transforms.outbox.route.by.field": "aggregate_type",
    "transforms.outbox.route.topic.replacement": "${routedByValue}-events",

    // ë°œí–‰ í›„ ë ˆì½”ë“œ ì‚­ì œ (ì„ íƒì‚¬í•­)
    "transforms.outbox.table.expand.json.payload": "true",

    // ìŠ¤ëƒ…ìƒ· ì„¤ì •
    "snapshot.mode": "initial",

    // ì˜¤í”„ì…‹ ì €ì¥
    "offset.storage.topic": "debezium-offsets",
    "offset.flush.interval.ms": "1000"
  }
}

// 3. ê²°ê³¼: aggregate_typeì— ë”°ë¼ ìë™ìœ¼ë¡œ í† í”½ ìƒì„±
// - Order â†’ order-events í† í”½
// - Payment â†’ payment-events í† í”½

// 4. Kafka Consumerì—ì„œ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
/*
{
  "key": "order-12345",
  "value": {
    "orderId": "order-12345",
    "customerId": "cust-001",
    "totalAmount": 50000,
    "status": "CREATED",
    "createdAt": "2024-01-15T10:30:00Z"
  },
  "headers": {
    "id": "msg-uuid-xxx",
    "eventType": "OrderCreated"
  }
}
*/

// 5. Docker Compose ì˜ˆì‹œ
/*
version: '3.8'
services:
  zookeeper:
    image: confluentinc/cp-zookeeper:7.5.0
    environment:
      ZOOKEEPER_CLIENT_PORT: 2181

  kafka:
    image: confluentinc/cp-kafka:7.5.0
    depends_on:
      - zookeeper
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1

  connect:
    image: debezium/connect:2.4
    depends_on:
      - kafka
      - postgres
    environment:
      BOOTSTRAP_SERVERS: kafka:9092
      GROUP_ID: outbox-connect
      CONFIG_STORAGE_TOPIC: connect-configs
      OFFSET_STORAGE_TOPIC: connect-offsets
      STATUS_STORAGE_TOPIC: connect-status
    ports:
      - "8083:8083"

  postgres:
    image: postgres:15
    environment:
      POSTGRES_USER: debezium
      POSTGRES_PASSWORD: secret
      POSTGRES_DB: orders_db
    command:
      - "postgres"
      - "-c"
      - "wal_level=logical"  # CDC í•„ìˆ˜ ì„¤ì •
*/

// 6. Connector ë“±ë¡ API í˜¸ì¶œ
/*
curl -X POST http://localhost:8083/connectors \
  -H "Content-Type: application/json" \
  -d @outbox-connector.json
*/</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ—£ï¸ ì‹¤ë¬´ì—ì„œ ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”</h2>
            <div class="conversation-examples">
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ ì„¤ê³„ ì‹œ</div>
                    <blockquote class="conv-quote">
                        "ì£¼ë¬¸ ìƒì„±í•˜ê³  Kafkaì— ì§ì ‘ ë°œí–‰í•˜ë©´ Dual Write ë¬¸ì œê°€ ìƒê¹ë‹ˆë‹¤. DB ì»¤ë°‹ í›„ Kafka ì¥ì•  ë‚˜ë©´ ì´ë²¤íŠ¸ ìœ ì‹¤ì´ì—ìš”. Outbox íŒ¨í„´ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ê°™ì€ íŠ¸ëœì­ì…˜ì— ì €ì¥í•˜ê³ , Debeziumì´ CDCë¡œ ì½ì–´ì„œ ë°œí–‰í•˜ë©´ at-least-once ë³´ì¥ë©ë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ë©”ì‹œì§€ ì¤‘ë³µ ì²˜ë¦¬ ë…¼ì˜ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "Outbox íŒ¨í„´ì€ at-least-onceë¼ì„œ ì¤‘ë³µ ë°œí–‰ë  ìˆ˜ ìˆì–´ìš”. ìˆ˜ì‹ ì ì¸¡ì—ì„œ message_idë¡œ ë©±ë“±ì„± ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. Inbox íŒ¨í„´ì„ ê°™ì´ ì“°ë©´ ìˆ˜ì‹  ì¸¡ë„ ì¤‘ë³µ ì²˜ë¦¬ë¥¼ DB ë ˆë²¨ì—ì„œ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ Outbox í…Œì´ë¸” ê´€ë¦¬ ë…¼ì˜ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "Outbox í…Œì´ë¸”ì´ ê³„ì† ìŒ“ì´ë©´ ì„±ëŠ¥ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤. ë°œí–‰ ì™„ë£Œëœ ë ˆì½”ë“œëŠ” 7ì¼ ì •ë„ ë³´ê´€ í›„ ì‚­ì œí•˜ëŠ” ë°°ì¹˜ë¥¼ ëŒë¦¬ì„¸ìš”. ë˜ëŠ” Debeziumì˜ delete ëª¨ë“œë¥¼ ì¼œë©´ ìº¡ì²˜ í›„ ìë™ ì‚­ì œë©ë‹ˆë‹¤."
                    </blockquote>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ -->
        <section class="term-section">
            <h2 class="section-title">âš ï¸ ì£¼ì˜ì‚¬í•­ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h2>
            <div class="warning-list">
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>ë©”ì‹œì§€ ìˆœì„œ ë³´ì¥ ì•ˆí•¨</strong>
                        <p>ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ê°€ í´ë§í•˜ë©´ ìˆœì„œê°€ ë’¤ë°”ë€” ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆœì„œê°€ ì¤‘ìš”í•˜ë©´ aggregate_id ê¸°ì¤€ íŒŒí‹°ì…”ë‹í•˜ê±°ë‚˜ ë‹¨ì¼ í´ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>Outbox í…Œì´ë¸” ë¹„ëŒ€í™”</strong>
                        <p>ë°œí–‰ ì™„ë£Œëœ ë ˆì½”ë“œë¥¼ ì‚­ì œí•˜ì§€ ì•Šìœ¼ë©´ í…Œì´ë¸”ì´ ì»¤ì ¸ ì¿¼ë¦¬ ì„±ëŠ¥ì´ ì €í•˜ë©ë‹ˆë‹¤. ì£¼ê¸°ì ì¸ ì •ë¦¬(retention) ì •ì±…ì„ ë°˜ë“œì‹œ êµ¬í˜„í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>ì¤‘ë³µ ë©”ì‹œì§€ ë¯¸ì²˜ë¦¬</strong>
                        <p>at-least-once ë°œí–‰ì´ë¯€ë¡œ ìˆ˜ì‹ ìê°€ ì¤‘ë³µì„ ì²˜ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ê°€ ê¼¬ì…ë‹ˆë‹¤. message_id ê¸°ë°˜ ë©±ë“±ì„± ë˜ëŠ” Inbox íŒ¨í„´ì„ ì ìš©í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âœ…</span>
                    <div>
                        <strong>Outbox íŒ¨í„´ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</strong>
                        <p>CDC(Debezium) í™œìš©ìœ¼ë¡œ ì‹¤ì‹œê°„ ë°œí–‰, message_idë¡œ ë©±ë“±ì„±, ë°œí–‰ ì™„ë£Œ ë ˆì½”ë“œ ì •ë¦¬, ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ë¯¸ë°œí–‰ ë©”ì‹œì§€ ê°ì§€.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ”— ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-terms">
                <a href="/ko/term/Inbox%20Pattern/" class="related-term-link">Inbox Pattern</a>
                <a href="/ko/term/Event%20Sourcing/" class="related-term-link">Event Sourcing</a>
                <a href="/ko/term/Saga%20Pattern/" class="related-term-link">Saga Pattern</a>
                <a href="/ko/term/CDC/" class="related-term-link">CDC</a>
                <a href="/ko/term/Kafka/" class="related-term-link">Kafka</a>
                <a href="/ko/term/ACID/" class="related-term-link">ACID</a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“š ë” ë°°ìš°ê¸°</h2>
            <div class="learn-more">
                <a href="https://debezium.io/documentation/reference/stable/transformations/outbox-event-router.html" target="_blank" class="learn-link">
                    ğŸ“„ Debezium - Outbox Event Router
                </a>
                <a href="https://microservices.io/patterns/data/transactional-outbox.html" target="_blank" class="learn-link">
                    ğŸ“ Microservices.io - Transactional Outbox
                </a>
                <a href="https://www.confluent.io/blog/outbox-pattern-for-microservices/" target="_blank" class="learn-link">
                    ğŸ“– Confluent - Outbox Pattern ê°€ì´ë“œ
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>
    function copyCode(btn) {
        const codeBlock = btn.parentElement.querySelector('code');
        navigator.clipboard.writeText(codeBlock.textContent).then(() => {
            btn.textContent = 'âœ… ë³µì‚¬ë¨!';
            setTimeout(() => btn.textContent = 'ğŸ“‹ ë³µì‚¬', 2000);
        });
    }

    document.querySelectorAll('.code-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const lang = this.dataset.lang;
            const section = this.closest('.term-section');
            section.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            section.querySelectorAll('.code-block').forEach(block => {
                block.classList.remove('active');
                if (block.dataset.lang === lang) block.classList.add('active');
            });
        });
    });
    </script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "78px", fabRight: "170px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js?v=20260129231616"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
