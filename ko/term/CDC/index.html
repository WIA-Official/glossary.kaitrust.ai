<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDC (Change Data Capture) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="CDCëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ìº¡ì²˜í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. Debezium, Kafka Connect ë“±ì„ í†µí•´ ì‹œìŠ¤í…œ ê°„ ë°ì´í„° ë™ê¸°í™”, ì´ë²¤íŠ¸ ì†Œì‹±, ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ETLì— í•µì‹¬ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.">
    <meta name="keywords" content="CDC, Change Data Capture, Debezium, Kafka, ë°ì´í„° ë™ê¸°í™”, ì´ë²¤íŠ¸ ì†Œì‹±, ETL, ì‹¤ì‹œê°„, AI ìš©ì–´, KAITRUST">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/CDC/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/CDC/">
    <meta property="og:title" content="CDC (Change Data Capture) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="CDCëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ìº¡ì²˜í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CDC (Change Data Capture) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="CDCëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ìº¡ì²˜í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "CDC",
        "alternateName": "Change Data Capture",
        "description": "CDCëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ìº¡ì²˜í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        /* ê³ ë„í™” ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .term-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-content p { color: #cbd5e1; line-height: 1.8; margin-bottom: 1rem; }
        .section-content p:last-child { margin-bottom: 0; }
        .code-tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap; }
        .code-tab { padding: 0.5rem 1rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: #94a3b8; cursor: pointer; transition: all 0.2s; }
        .code-tab.active { background: rgba(168,85,247,0.2); border-color: #a855f7; color: #a855f7; }
        .code-block { position: relative; background: #0f172a; border-radius: 12px; overflow: hidden; display: none; }
        .code-block.active { display: block; }
        .code-block pre { padding: 1.5rem; margin: 0; overflow-x: auto; }
        .code-block code { font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; color: #e2e8f0; line-height: 1.6; }
        .copy-btn { position: absolute; top: 0.75rem; right: 0.75rem; padding: 0.5rem 1rem; background: rgba(168,85,247,0.3); border: none; border-radius: 6px; color: #e2e8f0; cursor: pointer; font-size: 0.85rem; }
        .copy-btn:hover { background: rgba(168,85,247,0.5); }
        .conversation-examples { display: flex; flex-direction: column; gap: 1.5rem; }
        .conv-item { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 1.25rem; }
        .conv-context { font-size: 0.9rem; color: #a855f7; font-weight: 500; margin-bottom: 0.75rem; }
        .conv-quote { color: #e2e8f0; font-style: italic; line-height: 1.7; margin: 0; padding-left: 1rem; border-left: 3px solid #a855f7; }
        .warning-list { display: flex; flex-direction: column; gap: 1rem; }
        .warning-item { display: flex; gap: 1rem; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 10px; }
        .warning-icon { font-size: 1.5rem; }
        .warning-item strong { color: #f1f5f9; display: block; margin-bottom: 0.25rem; }
        .warning-item p { color: #94a3b8; margin: 0; font-size: 0.95rem; }
        .related-terms { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .related-term-link { padding: 0.5rem 1rem; background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.3); border-radius: 20px; color: #a855f7; text-decoration: none; font-size: 0.9rem; transition: all 0.2s; }
        .related-term-link:hover { background: rgba(168,85,247,0.2); transform: translateY(-2px); }
        .learn-more { display: flex; flex-direction: column; gap: 0.75rem; }
        .learn-link { display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 10px; color: #00f5ff; text-decoration: none; transition: all 0.2s; }
        .learn-link:hover { background: rgba(0,0,0,0.3); transform: translateX(5px); }
        .term-detail-container { max-width: 900px; margin: 0 auto; padding: 120px 2rem 4rem; position: relative; z-index: 1; }
        .breadcrumb { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 2rem; font-size: 0.9rem; flex-wrap: wrap; }
        .breadcrumb a { color: #64748b; text-decoration: none; transition: color 0.2s; }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header { background: linear-gradient(145deg, rgba(15,23,42,0.9), rgba(30,41,59,0.6)); border: 1px solid rgba(168,85,247,0.2); border-radius: 24px; padding: 3rem; margin-bottom: 2rem; position: relative; overflow: hidden; }
        .term-category-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(168,85,247,0.2); border-radius: 20px; font-size: 0.85rem; color: #a855f7; margin-bottom: 1rem; }
        .term-title { font-family: 'Orbitron', sans-serif; font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem; background: linear-gradient(135deg, #ffffff, #a855f7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .term-english { font-size: 1.2rem; color: #94a3b8; margin-bottom: 1.5rem; }
        .term-description { font-size: 1.1rem; line-height: 1.8; color: #e2e8f0; }
        .term-actions { display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap; }
        .term-action-btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: 12px; font-size: 0.9rem; text-decoration: none; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #a855f7, #6366f1); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(168,85,247,0.3); }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #e2e8f0; border: 1px solid rgba(255,255,255,0.2); }
        .btn-secondary:hover { background: rgba(255,255,255,0.2); }
        @media (max-width: 768px) { .term-detail-container { padding: 100px 1rem 2rem; } .term-detail-header { padding: 2rem 1.5rem; } .term-title { font-size: 1.8rem; } }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css">

</head>
<body>
    <div class="particle-container" id="particles"></div>
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a><span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a><span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#db">ë°ì´í„°ë² ì´ìŠ¤</a><span>â€º</span>
            <span class="current">CDC</span>
        </nav>

        <article class="term-detail-header">
            <div class="term-category-badge"><span>ğŸ—„ï¸</span><span>ë°ì´í„°ë² ì´ìŠ¤</span></div>
            <h1 class="term-title">CDC</h1>
            <p class="term-english">Change Data Capture - Real-time Data Synchronization</p>
            <div class="term-description">
                <p>CDC(Change Data Capture)ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­(INSERT, UPDATE, DELETE)ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ìº¡ì²˜í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. Debezium, Kafka Connect ë“±ì„ í†µí•´ ì‹œìŠ¤í…œ ê°„ ë°ì´í„° ë™ê¸°í™”, ì´ë²¤íŠ¸ ì†Œì‹±, ì‹¤ì‹œê°„ ETLì— í•µì‹¬ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°</a>
                <a href="https://glossary.kaitrust.ai/#db" class="term-action-btn btn-secondary">ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ë”ë³´ê¸°</a>
            </div>
        </article>

        <section class="term-section">
            <h2 class="section-title">ğŸ“– ìƒì„¸ ì„¤ëª…</h2>
            <div class="section-content">
                <p><strong>CDCì˜ í•µì‹¬ ì›ë¦¬</strong> - CDCëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ íŠ¸ëœì­ì…˜ ë¡œê·¸(WAL, Binlog)ë¥¼ ì½ì–´ ë³€ê²½ ì‚¬í•­ì„ ì¶”ì¶œí•©ë‹ˆë‹¤. í´ë§ ë°©ì‹ê³¼ ë‹¬ë¦¬ ì›ë³¸ DBì— ë¶€í•˜ë¥¼ ì£¼ì§€ ì•Šìœ¼ë©°, ì‚­ì œëœ ë°ì´í„°ë„ ìº¡ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³€ê²½ ìˆœì„œê°€ ë³´ì¥ë˜ì–´ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.</p>
                <p><strong>Debeziumì˜ ì—­í• </strong> - Red Hatì´ ê°œë°œí•œ ì˜¤í”ˆì†ŒìŠ¤ CDC í”Œë«í¼ Debeziumì€ MySQL, PostgreSQL, MongoDB, SQL Server ë“± ë‹¤ì–‘í•œ DBë¥¼ ì§€ì›í•©ë‹ˆë‹¤. Kafka Connect ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ë©°, ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ Kafka í† í”½ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í•©ë‹ˆë‹¤. ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì™€ í†µí•©í•´ ìŠ¤í‚¤ë§ˆ ì§„í™”ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                <p><strong>CDC í™œìš© ì‚¬ë¡€</strong> - ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ ë°ì´í„° ë™ê¸°í™”, CQRS íŒ¨í„´ì˜ ì½ê¸° ëª¨ë¸ ì—…ë°ì´íŠ¸, ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ì‹¤ì‹œê°„ ì ì¬, ìºì‹œ ë¬´íš¨í™”, ê°ì‚¬ ë¡œê·¸ ìƒì„±, ê²€ìƒ‰ ì¸ë±ìŠ¤ ë™ê¸°í™”(Elasticsearch) ë“±ì— í™œìš©ë©ë‹ˆë‹¤. ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤.</p>
                <p><strong>ë¡œê·¸ ê¸°ë°˜ vs ì¿¼ë¦¬ ê¸°ë°˜</strong> - ë¡œê·¸ ê¸°ë°˜ CDC(Debezium)ëŠ” íŠ¸ëœì­ì…˜ ë¡œê·¸ë¥¼ ì½ì–´ ì‹¤ì‹œê°„ì„±ì´ ë†’ê³  ë¶€í•˜ê°€ ì ìŠµë‹ˆë‹¤. ì¿¼ë¦¬ ê¸°ë°˜ CDC(íƒ€ì„ìŠ¤íƒ¬í”„ í´ë§)ëŠ” êµ¬í˜„ì´ ê°„ë‹¨í•˜ì§€ë§Œ ì‚­ì œ ê°ì§€ê°€ ì–´ë µê³  ì§€ì—°ì´ ìˆìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ë¡œê·¸ ê¸°ë°˜ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
                <p><strong>Outbox íŒ¨í„´ê³¼ì˜ ê²°í•©</strong> - íŠ¸ëœì­ì…˜ê³¼ ì´ë²¤íŠ¸ ë°œí–‰ì˜ ì›ìì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ Outbox íŒ¨í„´ê³¼ CDCë¥¼ í•¨ê»˜ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ í…Œì´ë¸” ë³€ê²½ê³¼ Outbox í…Œì´ë¸” ì‚½ì…ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ê³ , CDCê°€ Outbox í…Œì´ë¸”ì„ ê°ì‹œí•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <section class="term-section">
            <h2 class="section-title">ğŸ’» ì½”ë“œ ì˜ˆì œ</h2>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="debezium">Debezium ì„¤ì •</button>
                <button class="code-tab" data-lang="kafka">Kafka Consumer</button>
                <button class="code-tab" data-lang="python">Python CDC ì²˜ë¦¬</button>
            </div>
            <div class="code-block active" data-lang="debezium">
                <pre><code class="language-json">// Debezium MySQL Connector ì„¤ì • (Kafka Connect REST API)
// POST /connectors

{
  "name": "mysql-orders-connector",
  "config": {
    "connector.class": "io.debezium.connector.mysql.MySqlConnector",
    "database.hostname": "mysql-primary",
    "database.port": "3306",
    "database.user": "debezium",
    "database.password": "${secrets:mysql-password}",
    "database.server.id": "184054",
    "topic.prefix": "dbserver1",
    "database.include.list": "ecommerce",
    "table.include.list": "ecommerce.orders,ecommerce.order_items",

    // ìŠ¤í‚¤ë§ˆ íˆìŠ¤í† ë¦¬ (DDL ë³€ê²½ ì¶”ì )
    "schema.history.internal.kafka.bootstrap.servers": "kafka:9092",
    "schema.history.internal.kafka.topic": "schema-changes.ecommerce",

    // ë³€í™˜ ì„¤ì •
    "transforms": "route,unwrap",
    "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
    "transforms.route.regex": "([^.]+)\\.([^.]+)\\.([^.]+)",
    "transforms.route.replacement": "cdc.$3",

    // Outbox íŒ¨í„´ ì§€ì›
    "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
    "transforms.unwrap.drop.tombstones": "false",
    "transforms.unwrap.delete.handling.mode": "rewrite",

    // ìŠ¤ëƒ…ìƒ· ì„¤ì •
    "snapshot.mode": "initial",
    "snapshot.locking.mode": "minimal",

    // ì˜¤í”„ì…‹ ì €ì¥
    "offset.storage.topic": "connect-offsets",
    "offset.flush.interval.ms": "10000"
  }
}

// í† í”½ ë©”ì‹œì§€ ì˜ˆì‹œ (orders í…Œì´ë¸” UPDATE)
/*
{
  "before": {
    "id": 1001,
    "status": "pending",
    "total": 50000
  },
  "after": {
    "id": 1001,
    "status": "shipped",
    "total": 50000
  },
  "source": {
    "version": "2.4.0.Final",
    "connector": "mysql",
    "name": "dbserver1",
    "ts_ms": 1706277600000,
    "db": "ecommerce",
    "table": "orders",
    "server_id": 184054,
    "gtid": null,
    "file": "mysql-bin.000003",
    "pos": 12345
  },
  "op": "u",  // c=create, u=update, d=delete, r=read(snapshot)
  "ts_ms": 1706277600100
}
*/</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="kafka">
                
                <pre><code class="language-java">// Kafka Consumerë¡œ CDC ì´ë²¤íŠ¸ ì²˜ë¦¬ (Java)
import org.apache.kafka.clients.consumer.*;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;

public class CDCEventConsumer {
    private final ObjectMapper mapper = new ObjectMapper();

    public void consumeCDCEvents() {
        Properties props = new Properties();
        props.put("bootstrap.servers", "kafka:9092");
        props.put("group.id", "order-sync-service");
        props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
        props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
        props.put("auto.offset.reset", "earliest");
        props.put("enable.auto.commit", "false");

        try (KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props)) {
            consumer.subscribe(List.of("cdc.orders"));

            while (true) {
                ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));

                for (ConsumerRecord&lt;String, String&gt; record : records) {
                    processCDCEvent(record.value());
                }

                consumer.commitSync();  // ì²˜ë¦¬ ì™„ë£Œ í›„ ì»¤ë°‹
            }
        }
    }

    private void processCDCEvent(String eventJson) throws Exception {
        JsonNode event = mapper.readTree(eventJson);
        String operation = event.get("op").asText();

        switch (operation) {
            case "c" -> handleCreate(event.get("after"));
            case "u" -> handleUpdate(event.get("before"), event.get("after"));
            case "d" -> handleDelete(event.get("before"));
            case "r" -> handleSnapshot(event.get("after"));
        }
    }

    private void handleUpdate(JsonNode before, JsonNode after) {
        Long orderId = after.get("id").asLong();
        String oldStatus = before.get("status").asText();
        String newStatus = after.get("status").asText();

        if (!oldStatus.equals(newStatus)) {
            System.out.println("Order " + orderId + ": " + oldStatus + " â†’ " + newStatus);
            // ì½ê¸° ëª¨ë¸ ì—…ë°ì´íŠ¸, ì•Œë¦¼ ë°œì†¡ ë“±
            updateReadModel(orderId, after);
            sendNotification(orderId, newStatus);
        }
    }
}</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="python">
                
                <pre><code class="language-python"># Pythonìœ¼ë¡œ CDC ì´ë²¤íŠ¸ ì²˜ë¦¬
from kafka import KafkaConsumer
from dataclasses import dataclass
from typing import Optional, Dict, Any
import json

@dataclass
class CDCEvent:
    operation: str  # c, u, d, r
    before: Optional[Dict[str, Any]]
    after: Optional[Dict[str, Any]]
    source: Dict[str, Any]
    timestamp: int

    @classmethod
    def from_json(cls, data: dict) -> "CDCEvent":
        return cls(
            operation=data.get("op"),
            before=data.get("before"),
            after=data.get("after"),
            source=data.get("source", {}),
            timestamp=data.get("ts_ms", 0)
        )


class OrderCDCProcessor:
    def __init__(self, kafka_servers: str):
        self.consumer = KafkaConsumer(
            "cdc.orders",
            bootstrap_servers=kafka_servers,
            group_id="order-analytics",
            value_deserializer=lambda m: json.loads(m.decode("utf-8")),
            auto_offset_reset="earliest",
            enable_auto_commit=False
        )

    def process_events(self):
        """CDC ì´ë²¤íŠ¸ ì²˜ë¦¬ ë£¨í”„"""
        for message in self.consumer:
            try:
                event = CDCEvent.from_json(message.value)
                self.handle_event(event)
                self.consumer.commit()
            except Exception as e:
                print(f"Error processing event: {e}")
                # Dead Letter Queueë¡œ ì „ì†¡

    def handle_event(self, event: CDCEvent):
        """ì´ë²¤íŠ¸ íƒ€ì…ë³„ ì²˜ë¦¬"""
        handlers = {
            "c": self.on_create,
            "u": self.on_update,
            "d": self.on_delete,
            "r": self.on_snapshot
        }

        handler = handlers.get(event.operation)
        if handler:
            handler(event)

    def on_create(self, event: CDCEvent):
        """ìƒˆ ì£¼ë¬¸ ìƒì„±"""
        order = event.after
        print(f"âœ… New order: #{order['id']} - {order['total']}ì›")
        # ë¶„ì„ ì‹œìŠ¤í…œì— ì „ì†¡
        self.send_to_analytics("order_created", order)

    def on_update(self, event: CDCEvent):
        """ì£¼ë¬¸ ìƒíƒœ ë³€ê²½"""
        before, after = event.before, event.after

        # ë³€ê²½ëœ í•„ë“œ ê°ì§€
        changes = {
            k: (before.get(k), after.get(k))
            for k in after.keys()
            if before.get(k) != after.get(k)
        }

        if "status" in changes:
            old, new = changes["status"]
            print(f"ğŸ“¦ Order #{after['id']}: {old} â†’ {new}")

            if new == "shipped":
                self.notify_shipping(after)
            elif new == "delivered":
                self.update_inventory(after)

    def on_delete(self, event: CDCEvent):
        """ì£¼ë¬¸ ì‚­ì œ (Soft delete ê¶Œì¥)"""
        order = event.before
        print(f"ğŸ—‘ï¸ Order deleted: #{order['id']}")
        # ì¸ë±ìŠ¤ì—ì„œ ì œê±°
        self.remove_from_search_index(order['id'])

    def send_to_analytics(self, event_type: str, data: dict):
        """ë¶„ì„ ì‹œìŠ¤í…œìœ¼ë¡œ ì „ì†¡"""
        # ClickHouse, BigQuery ë“±ìœ¼ë¡œ ì ì¬
        pass


if __name__ == "__main__":
    processor = OrderCDCProcessor("kafka:9092")
    processor.process_events()</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
        </section>

        <section class="term-section">
            <h2 class="section-title">ğŸ’¬ í˜„ì—… ëŒ€í™” ì˜ˆì‹œ</h2>
            <div class="conversation-examples">
                <div class="conv-item">
                    <div class="conv-context">ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ì•„í‚¤í…ì²˜ íšŒì˜ì—ì„œ</div>
                    <p class="conv-quote">"Elasticsearch ë™ê¸°í™”ë¥¼ í´ë§ìœ¼ë¡œ í•˜ê³  ìˆëŠ”ë°, ì‚­ì œ ì´ë²¤íŠ¸ë¥¼ ë†“ì¹˜ê³  ìˆì–´ìš”. Debeziumìœ¼ë¡œ CDC íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ë©´ binlogì—ì„œ DELETEê¹Œì§€ ìº¡ì²˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§€ì—°ë„ ìˆ˜ì‹­ ë°€ë¦¬ì´ˆë¡œ ì¤„ì–´ë“¤ì–´ìš”."</p>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ë°±ì—”ë“œ ê°œë°œìê°€ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¤ê³„ì—ì„œ</div>
                    <p class="conv-quote">"ì£¼ë¬¸ ì„œë¹„ìŠ¤ì—ì„œ ë°°ì†¡ ì„œë¹„ìŠ¤ë¡œ ì´ë²¤íŠ¸ë¥¼ ë³´ë‚´ì•¼ í•˜ëŠ”ë°, ë¶„ì‚° íŠ¸ëœì­ì…˜ì€ í”¼í•˜ê³  ì‹¶ì–´ìš”. Outbox íŒ¨í„´ì´ë‘ CDCë¥¼ ì¡°í•©í•´ì„œ ìµœì¢… ì¼ê´€ì„±ì„ ë³´ì¥í•˜ëŠ” ê²Œ ì–´ë–¨ê¹Œìš”? ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë©”ì‹œì§•ì´ ê¹”ë”í•˜ê²Œ ë¶„ë¦¬ë©ë‹ˆë‹¤."</p>
                </div>
                <div class="conv-item">
                    <div class="conv-context">DBAê°€ ì„±ëŠ¥ ê²€í† ì—ì„œ</div>
                    <p class="conv-quote">"Debeziumì´ MySQLì˜ binlogë¥¼ ì½ëŠ” ê±´ ìŠ¬ë ˆì´ë¸Œ ë³µì œì™€ ê°™ì€ ë°©ì‹ì´ë¼ ë©”ì¸ DB ë¶€í•˜ê°€ ê±°ì˜ ì—†ì–´ìš”. ë‹¨, binlog_formatì€ ROWë¡œ ì„¤ì •í•´ì•¼ í•˜ê³ , ë³´ê´€ ê¸°ê°„ë„ ì¶©ë¶„íˆ ì¡ì•„ì•¼ ì¥ì•  ë³µêµ¬ê°€ ìˆ˜ì›”í•©ë‹ˆë‹¤."</p>
                </div>
            </div>
        </section>

        <section class="term-section">
            <h2 class="section-title">âš ï¸ ì£¼ì˜ì‚¬í•­</h2>
            <div class="warning-list">
                <div class="warning-item">
                    <div class="warning-icon">ğŸ“‹</div>
                    <div>
                        <strong>ìŠ¤í‚¤ë§ˆ ë³€ê²½ ê´€ë¦¬ í•„ìˆ˜</strong>
                        <p>í…Œì´ë¸” DDL ë³€ê²½ ì‹œ CDC ì»¤ë„¥í„°ê°€ ì¤‘ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œ ë²„ì „ ê´€ë¦¬í•˜ê³ , í˜¸í™˜ ê°€ëŠ¥í•œ ë³€ê²½ë§Œ ì ìš©í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <div class="warning-icon">â°</div>
                    <div>
                        <strong>ì´ˆê¸° ìŠ¤ëƒ…ìƒ· ì‹œê°„ ê³ ë ¤</strong>
                        <p>ëŒ€ìš©ëŸ‰ í…Œì´ë¸”ì˜ ì´ˆê¸° ìŠ¤ëƒ…ìƒ·ì€ ìˆ˜ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì ì§„ì  ìŠ¤ëƒ…ìƒ·ì´ë‚˜ ë³‘ë ¬ ì²˜ë¦¬ ì˜µì…˜ì„ í™œìš©í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <div class="warning-icon">ğŸ”„</div>
                    <div>
                        <strong>ì¤‘ë³µ ì²˜ë¦¬ ëŒ€ë¹„</strong>
                        <p>ì¥ì•  ë³µêµ¬ ì‹œ ì´ë²¤íŠ¸ê°€ ì¬ì „ì†¡ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì»¨ìŠˆë¨¸ì—ì„œ ë©±ë“±ì„±ì„ ë³´ì¥í•˜ê±°ë‚˜ ì¤‘ë³µ ì²´í¬ ë¡œì§ì„ êµ¬í˜„í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <div class="warning-icon">ğŸ’¾</div>
                    <div>
                        <strong>ë¡œê·¸ ë³´ê´€ ê¸°ê°„ í™•ì¸</strong>
                        <p>binlog/WAL ë³´ê´€ ê¸°ê°„ì´ ì§§ìœ¼ë©´ ì»¤ë„¥í„° ì¬ì‹œì‘ ì‹œ ëˆ„ë½ì´ ë°œìƒí•©ë‹ˆë‹¤. ìµœì†Œ 7ì¼ ì´ìƒ ë³´ê´€ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="term-section">
            <h2 class="section-title">ğŸ”— ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-terms">
                <a href="/ko/term/Debezium/" class="related-term-link">Debezium</a>
                <a href="/ko/term/Kafka/" class="related-term-link">Kafka</a>
                <a href="/ko/term/Outbox%20Pattern/" class="related-term-link">Outbox Pattern</a>
                <a href="/ko/term/CQRS/" class="related-term-link">CQRS</a>
                <a href="/ko/term/ì´ë²¤íŠ¸%20ë“œë¦¬ë¸/" class="related-term-link">ì´ë²¤íŠ¸ ë“œë¦¬ë¸</a>
                <a href="/ko/term/ETL/" class="related-term-link">ETL</a>
            </div>
        </section>

        <section class="term-section">
            <h2 class="section-title">ğŸ“š ë” ë°°ìš°ê¸°</h2>
            <div class="learn-more">
                <a href="https://debezium.io/documentation/" target="_blank" rel="noopener" class="learn-link">
                    <span>ğŸ“–</span> Debezium ê³µì‹ ë¬¸ì„œ
                </a>
                <a href="https://www.confluent.io/blog/tag/change-data-capture/" target="_blank" rel="noopener" class="learn-link">
                    <span>ğŸ“–</span> Confluent CDC ë¸”ë¡œê·¸
                </a>
            </div>
        </section>
    </main>

    <!-- Engagement Kit -->
    <div id="kaitrust-engagement-kit"></div>
    <link rel="stylesheet" href="/components/engagement-kit/engagement-kit.css?v=20260130015843">
    <script src="/components/engagement-kit/engagement-kit.js?v=20260130015843"></script>

        <div id="kaitrust-footer"></div>

    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>
        document.querySelectorAll('.code-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const lang = tab.dataset.lang;
                const section = tab.closest('.term-section');
                section.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
                section.querySelectorAll('.code-block').forEach(b => b.classList.remove('active'));
                tab.classList.add('active');
                section.querySelector(`.code-block[data-lang="${lang}"]`).classList.add('active');
            });
        });
        function copyCode(btn) {
            const code = btn.previousElementSibling.querySelector('code').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const originalText = btn.textContent;
                btn.textContent = 'âœ… ë³µì‚¬ë¨!';
                setTimeout(() => btn.textContent = originalText, 2000);
            });
        }
    </script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "78px", fabRight: "170px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
