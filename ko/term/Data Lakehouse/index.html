<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Lakehouse (ë°ì´í„° ë ˆì´í¬í•˜ìš°ìŠ¤) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="ë°ì´í„° ë ˆì´í¬ì™€ ì›¨ì–´í•˜ìš°ìŠ¤ë¥¼ ê²°í•©í•œ ì•„í‚¤í…ì²˜. ACID íŠ¸ëœì­ì…˜ê³¼ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í†µí•© ë°ì´í„° í”Œë«í¼.">
    <meta name="keywords" content="Data Lakehouse, ë°ì´í„° ë ˆì´í¬í•˜ìš°ìŠ¤, AI ìš©ì–´, KAITRUST, AI ë°±ê³¼ì‚¬ì „, ë°ì´í„°ê³µí•™">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/Data%20Lakehouse/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/Data%20Lakehouse/">
    <meta property="og:title" content="Data Lakehouse (ë°ì´í„° ë ˆì´í¬í•˜ìš°ìŠ¤) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="ë°ì´í„° ë ˆì´í¬ì™€ ì›¨ì–´í•˜ìš°ìŠ¤ë¥¼ ê²°í•©í•œ ì•„í‚¤í…ì²˜. ACID íŠ¸ëœì­ì…˜ê³¼ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í†µí•© ë°ì´í„° í”Œë«í¼.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Data Lakehouse (ë°ì´í„° ë ˆì´í¬í•˜ìš°ìŠ¤) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="ë°ì´í„° ë ˆì´í¬ì™€ ì›¨ì–´í•˜ìš°ìŠ¤ë¥¼ ê²°í•©í•œ ì•„í‚¤í…ì²˜. ACID íŠ¸ëœì­ì…˜ê³¼ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í†µí•© ë°ì´í„° í”Œë«í¼.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "Data Lakehouse",
        "description": "ë°ì´í„° ë ˆì´í¬ì™€ ì›¨ì–´í•˜ìš°ìŠ¤ë¥¼ ê²°í•©í•œ ì•„í‚¤í…ì²˜. ACID íŠ¸ëœì­ì…˜ê³¼ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í†µí•© ë°ì´í„° í”Œë«í¼.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">
    <link rel="stylesheet" href="/glossary/css/term-sections.css">

    <style>
        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a {
            color: #64748b;
            text-decoration: none;
            transition: color 0.2s;
        }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english {
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
        }
        .term-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }
        .term-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        .related-section {
            margin-top: 3rem;
        }
        .related-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #f1f5f9;
        }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#data">ë°ì´í„°ê³µí•™</a>
            <span>â€º</span>
            <span class="current">Data Lakehouse</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ“Š</span>
                <span>ë°ì´í„°ê³µí•™</span>
            </div>
            <h1 class="term-title">Data Lakehouse</h1>
            <p class="term-english">ë°ì´í„° ë ˆì´í¬í•˜ìš°ìŠ¤</p>
            <div class="term-description">
                <p>ë°ì´í„° ë ˆì´í¬ì™€ ì›¨ì–´í•˜ìš°ìŠ¤ë¥¼ ê²°í•©í•œ ì•„í‚¤í…ì²˜. ACID íŠ¸ëœì­ì…˜ê³¼ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í†µí•© ë°ì´í„° í”Œë«í¼.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#data" class="term-action-btn btn-secondary">
                    ğŸ“Š ë°ì´í„°ê³µí•™ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… ì„¹ì…˜ -->
        <section class="term-section" id="detail-title">
            <h2>ìƒì„¸ ì„¤ëª…</h2>
            <p>Data LakehouseëŠ” Data Lakeì˜ ìœ ì—°ì„±ê³¼ í™•ì¥ì„±, Data Warehouseì˜ ë°ì´í„° ê´€ë¦¬ ê¸°ëŠ¥ê³¼ ì„±ëŠ¥ì„ ê²°í•©í•œ ì°¨ì„¸ëŒ€ ë°ì´í„° ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤. ê¸°ì¡´ì—ëŠ” ì›ì‹œ ë°ì´í„°ë¥¼ Data Lakeì— ì €ì¥í•˜ê³ , ë¶„ì„ìš© ë°ì´í„°ë¥¼ ë³„ë„ì˜ Data Warehouseë¡œ ETLí•˜ëŠ” 2ë‹¨ê³„ ì•„í‚¤í…ì²˜ê°€ ì¼ë°˜ì ì´ì—ˆìŠµë‹ˆë‹¤. LakehouseëŠ” ì´ëŸ¬í•œ ì¤‘ë³µ ì €ì¥ê³¼ ë³µì¡í•œ ë°ì´í„° ì´ë™ì„ ì œê±°í•˜ê³ , ë‹¨ì¼ í”Œë«í¼ì—ì„œ ëª¨ë“  ë°ì´í„° ì›Œí¬ë¡œë“œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.</p>
            <p>Lakehouseì˜ í•µì‹¬ ê¸°ìˆ ì€ ì˜¤í”ˆ í…Œì´ë¸” í¬ë§·ì¸ Delta Lake, Apache Iceberg, Apache Hudiì…ë‹ˆë‹¤. ì´ë“¤ì€ ê°ì²´ ìŠ¤í† ë¦¬ì§€(S3, ADLS, GCS) ìœ„ì—ì„œ ACID íŠ¸ëœì­ì…˜, ìŠ¤í‚¤ë§ˆ ì§„í™”, íƒ€ì„ íŠ¸ë˜ë¸”, ë™ì‹œì„± ì œì–´ ê°™ì€ ì›¨ì–´í•˜ìš°ìŠ¤ ìˆ˜ì¤€ì˜ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. íŒŒì¼ ê¸°ë°˜ ìŠ¤í† ë¦¬ì§€ì˜ ë¹„ìš© íš¨ìœ¨ì„±ì„ ìœ ì§€í•˜ë©´ì„œë„ ì•ˆì •ì ì¸ ë°ì´í„° ê´€ë¦¬ê°€ ê°€ëŠ¥í•´ì§„ ê²ƒì…ë‹ˆë‹¤. íŠ¹íˆ ë©”íƒ€ë°ì´í„° ë ˆì´ì–´ë¥¼ í†µí•´ Parquet íŒŒì¼ë“¤ì„ í…Œì´ë¸”ì²˜ëŸ¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <p>Lakehouse ì•„í‚¤í…ì²˜ëŠ” BI ë¶„ì„, ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°, ë¨¸ì‹ ëŸ¬ë‹ì„ ë‹¨ì¼ ë°ì´í„° ë³µì‚¬ë³¸ì—ì„œ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´ ë°ì´í„° ì¼ê´€ì„±ì´ ë³´ì¥ë©ë‹ˆë‹¤. ê³¼ê±°ì—ëŠ” ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ê°€ Lakeì˜ ì›ì‹œ ë°ì´í„°ë¡œ, ë¶„ì„ê°€ê°€ Warehouseì˜ ì •ì œ ë°ì´í„°ë¡œ ê°ê° ì‘ì—…í–ˆëŠ”ë°, ì´ë¡œ ì¸í•´ ë™ì¼í•œ ì§€í‘œê°€ ë‹¤ë¥´ê²Œ ê³„ì‚°ë˜ëŠ” ë¬¸ì œê°€ ë¹ˆë²ˆí–ˆìŠµë‹ˆë‹¤. LakehouseëŠ” Single Source of Truthë¥¼ ì‹¤í˜„í•˜ì—¬ ì´ëŸ¬í•œ ë°ì´í„° ì‚¬ì¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.</p>
            <p>ì£¼ìš” Lakehouse í”Œë«í¼ìœ¼ë¡œëŠ” Databricks (Delta Lake ê¸°ë°˜), Snowflake (Iceberg ì§€ì›), AWS Lake Formation, Google BigLake ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì€ SQL ì¿¼ë¦¬ ì—”ì§„(Spark SQL, Trino, Presto), ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬(Structured Streaming), ML ì›Œí¬ë¡œë“œ(MLflow, Feature Store)ë¥¼ í†µí•© ì œê³µí•©ë‹ˆë‹¤. ìµœê·¼ì—ëŠ” Unity Catalog, Nessie ê°™ì€ í†µí•© ì¹´íƒˆë¡œê·¸ë¥¼ í†µí•´ ë°ì´í„° ê±°ë²„ë„ŒìŠ¤ì™€ ì ‘ê·¼ ì œì–´ë„ ê°•í™”ë˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ ì„¹ì…˜ -->
        <section class="term-section">
            <h2>ì½”ë“œ ì˜ˆì œ</h2>
            <p>Delta Lake ê¸°ë°˜ Data Lakehouseì—ì„œ ACID íŠ¸ëœì­ì…˜, ìŠ¤í‚¤ë§ˆ ì§„í™”, íƒ€ì„ íŠ¸ë˜ë¸”ì„ í™œìš©í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p>
            <div class="code-block" onclick="copyCode(this)">
                <div class="code-header">
                    <span>Python (PySpark + Delta Lake - Lakehouse Architecture)</span>
                    <button class="copy-btn">ë³µì‚¬</button>
                </div>
                <pre><code># Data Lakehouse êµ¬í˜„ (Delta Lake ê¸°ë°˜)
from pyspark.sql import SparkSession
from pyspark.sql.functions import *
from pyspark.sql.types import *
from delta import *
from delta.tables import DeltaTable

# Spark Session with Delta Lake
spark = SparkSession.builder \
    .appName("DataLakehouse") \
    .config("spark.sql.extensions", "io.delta.sql.DeltaSparkSessionExtension") \
    .config("spark.sql.catalog.spark_catalog", "org.apache.spark.sql.delta.catalog.DeltaCatalog") \
    .config("spark.databricks.delta.retentionDurationCheck.enabled", "false") \
    .getOrCreate()

LAKEHOUSE_PATH = "s3a://company-lakehouse"

# ============================================
# 1. Delta Table ìƒì„± (ACID íŠ¸ëœì­ì…˜ ì§€ì›)
# ============================================
def create_delta_table():
    """íŒŒí‹°ì…˜ê³¼ Z-Order ìµœì í™”ê°€ ì ìš©ëœ Delta í…Œì´ë¸” ìƒì„±"""

    # ìŠ¤í‚¤ë§ˆ ì •ì˜
    schema = StructType([
        StructField("order_id", StringType(), False),
        StructField("customer_id", StringType(), False),
        StructField("product_id", StringType(), False),
        StructField("quantity", IntegerType(), True),
        StructField("amount", DecimalType(10, 2), True),
        StructField("order_date", DateType(), False),
        StructField("status", StringType(), True),
        StructField("region", StringType(), True)
    ])

    # Delta í…Œì´ë¸” ìƒì„± (SQL)
    spark.sql(f"""
        CREATE TABLE IF NOT EXISTS lakehouse.orders (
            order_id STRING NOT NULL,
            customer_id STRING NOT NULL,
            product_id STRING NOT NULL,
            quantity INT,
            amount DECIMAL(10, 2),
            order_date DATE NOT NULL,
            status STRING,
            region STRING
        )
        USING DELTA
        PARTITIONED BY (order_date)
        LOCATION '{LAKEHOUSE_PATH}/orders'
        TBLPROPERTIES (
            'delta.autoOptimize.optimizeWrite' = 'true',
            'delta.autoOptimize.autoCompact' = 'true',
            'delta.dataSkippingNumIndexedCols' = '8'
        )
    """)

    print("Delta table created with auto-optimization")

# ============================================
# 2. MERGE (Upsert) ì‘ì—… - CDC ì²˜ë¦¬
# ============================================
def merge_cdc_data(cdc_df):
    """Change Data Captureë¥¼ Delta í…Œì´ë¸”ì— ë¨¸ì§€"""

    delta_table = DeltaTable.forPath(spark, f"{LAKEHOUSE_PATH}/orders")

    # MERGE INTO - Insert, Update, Delete í•œ ë²ˆì— ì²˜ë¦¬
    delta_table.alias("target").merge(
        cdc_df.alias("source"),
        "target.order_id = source.order_id"
    ).whenMatchedUpdate(
        condition="source.operation = 'UPDATE'",
        set={
            "quantity": "source.quantity",
            "amount": "source.amount",
            "status": "source.status",
            "region": "source.region"
        }
    ).whenMatchedDelete(
        condition="source.operation = 'DELETE'"
    ).whenNotMatchedInsert(
        condition="source.operation = 'INSERT'",
        values={
            "order_id": "source.order_id",
            "customer_id": "source.customer_id",
            "product_id": "source.product_id",
            "quantity": "source.quantity",
            "amount": "source.amount",
            "order_date": "source.order_date",
            "status": "source.status",
            "region": "source.region"
        }
    ).execute()

    print(f"Merged {cdc_df.count()} CDC records")

# ============================================
# 3. ìŠ¤í‚¤ë§ˆ ì§„í™” (Schema Evolution)
# ============================================
def evolve_schema():
    """ë¬´ì¤‘ë‹¨ ìŠ¤í‚¤ë§ˆ ë³€ê²½"""

    # ìƒˆ ì»¬ëŸ¼ ì¶”ê°€ (ìë™ ìŠ¤í‚¤ë§ˆ ë¨¸ì§€)
    spark.sql(f"""
        ALTER TABLE delta.`{LAKEHOUSE_PATH}/orders`
        ADD COLUMNS (
            discount_rate DECIMAL(5, 2) COMMENT 'í• ì¸ìœ¨',
            loyalty_points INT COMMENT 'ì ë¦½ í¬ì¸íŠ¸'
        )
    """)

    # ì»¬ëŸ¼ íƒ€ì… ë³€ê²½ (ì•ˆì „í•œ í™•ì¥ë§Œ ê°€ëŠ¥)
    spark.sql(f"""
        ALTER TABLE delta.`{LAKEHOUSE_PATH}/orders`
        ALTER COLUMN amount TYPE DECIMAL(15, 2)
    """)

    # ìë™ ìŠ¤í‚¤ë§ˆ ë¨¸ì§€ë¡œ ë°ì´í„° ì“°ê¸°
    new_data_with_extra_column = spark.createDataFrame([
        ("ORD-999", "CUST-1", "PROD-1", 2, 150.00, "2024-01-15", "completed", "ì„œìš¸", 0.1, 150)
    ], ["order_id", "customer_id", "product_id", "quantity", "amount",
        "order_date", "status", "region", "discount_rate", "loyalty_points"])

    new_data_with_extra_column.write \
        .format("delta") \
        .mode("append") \
        .option("mergeSchema", "true") \
        .save(f"{LAKEHOUSE_PATH}/orders")

    print("Schema evolved successfully")

# ============================================
# 4. Time Travel - ê³¼ê±° ë°ì´í„° ì¡°íšŒ
# ============================================
def time_travel_queries():
    """Delta Lake íƒ€ì„ íŠ¸ë˜ë¸” ê¸°ëŠ¥ í™œìš©"""

    # íŠ¹ì • ë²„ì „ì˜ ë°ì´í„° ì¡°íšŒ
    df_version_5 = spark.read \
        .format("delta") \
        .option("versionAsOf", 5) \
        .load(f"{LAKEHOUSE_PATH}/orders")

    print(f"Version 5 record count: {df_version_5.count()}")

    # íŠ¹ì • ì‹œì ì˜ ë°ì´í„° ì¡°íšŒ
    df_yesterday = spark.read \
        .format("delta") \
        .option("timestampAsOf", "2024-01-14 00:00:00") \
        .load(f"{LAKEHOUSE_PATH}/orders")

    # ë²„ì „ ê°„ ë³€ê²½ ì‚¬í•­ í™•ì¸
    changes = spark.sql(f"""
        SELECT * FROM delta.`{LAKEHOUSE_PATH}/orders`
        VERSION AS OF 10
        EXCEPT
        SELECT * FROM delta.`{LAKEHOUSE_PATH}/orders`
        VERSION AS OF 9
    """)

    print(f"Changes between v9 and v10: {changes.count()} rows")

    # í…Œì´ë¸” íˆìŠ¤í† ë¦¬ ì¡°íšŒ
    history = spark.sql(f"DESCRIBE HISTORY delta.`{LAKEHOUSE_PATH}/orders`")
    history.select("version", "timestamp", "operation", "operationMetrics").show(10)

    # ì˜ëª»ëœ ë³€ê²½ ë¡¤ë°±
    spark.sql(f"""
        RESTORE TABLE delta.`{LAKEHOUSE_PATH}/orders`
        TO VERSION AS OF 8
    """)
    print("Table restored to version 8")

# ============================================
# 5. ì„±ëŠ¥ ìµœì í™” (Z-Order, OPTIMIZE)
# ============================================
def optimize_table():
    """ì¿¼ë¦¬ ì„±ëŠ¥ ìµœì í™”"""

    # íŒŒì¼ ë³‘í•© ë° ìµœì í™”
    spark.sql(f"""
        OPTIMIZE delta.`{LAKEHOUSE_PATH}/orders`
        WHERE order_date >= '2024-01-01'
    """)

    # Z-Order í´ëŸ¬ìŠ¤í„°ë§ (ìì£¼ í•„í„°ë§ë˜ëŠ” ì»¬ëŸ¼)
    spark.sql(f"""
        OPTIMIZE delta.`{LAKEHOUSE_PATH}/orders`
        ZORDER BY (customer_id, product_id)
    """)

    # ë¶ˆí•„ìš”í•œ íŒŒì¼ ì •ë¦¬ (Vacuum)
    spark.sql(f"""
        VACUUM delta.`{LAKEHOUSE_PATH}/orders`
        RETAIN 168 HOURS  -- 7ì¼ ë³´ì¡´
    """)

    # í…Œì´ë¸” í†µê³„ ìˆ˜ì§‘
    spark.sql(f"ANALYZE TABLE delta.`{LAKEHOUSE_PATH}/orders` COMPUTE STATISTICS")

    print("Table optimized with Z-Order clustering")

# ============================================
# 6. ìŠ¤íŠ¸ë¦¬ë° + ë°°ì¹˜ í†µí•© (Unified Processing)
# ============================================
def unified_streaming_batch():
    """ë™ì¼ í…Œì´ë¸”ì—ì„œ ìŠ¤íŠ¸ë¦¬ë°ê³¼ ë°°ì¹˜ ë™ì‹œ ì²˜ë¦¬"""

    # ìŠ¤íŠ¸ë¦¬ë° ì“°ê¸° (Kafka -> Delta)
    kafka_stream = spark.readStream \
        .format("kafka") \
        .option("kafka.bootstrap.servers", "kafka:9092") \
        .option("subscribe", "orders") \
        .load()

    orders_stream = kafka_stream \
        .select(from_json(col("value").cast("string"), order_schema).alias("data")) \
        .select("data.*")

    # Delta í…Œì´ë¸”ë¡œ ìŠ¤íŠ¸ë¦¬ë° (ACID ë³´ì¥)
    query = orders_stream.writeStream \
        .format("delta") \
        .outputMode("append") \
        .option("checkpointLocation", f"{LAKEHOUSE_PATH}/checkpoints/orders") \
        .trigger(processingTime="1 minute") \
        .start(f"{LAKEHOUSE_PATH}/orders")

    # ë™ì‹œì— ë°°ì¹˜ ì½ê¸° ê°€ëŠ¥ (ìŠ¤íŠ¸ë¦¬ë°ê³¼ ì¶©ëŒ ì—†ìŒ)
    batch_df = spark.read.format("delta").load(f"{LAKEHOUSE_PATH}/orders")
    daily_summary = batch_df \
        .filter(col("order_date") == current_date()) \
        .groupBy("region") \
        .agg(
            count("order_id").alias("orders"),
            sum("amount").alias("revenue")
        )

    print("Streaming and batch processing running concurrently")
    return query

# ============================================
# 7. Unity Catalog í†µí•© (ê±°ë²„ë„ŒìŠ¤)
# ============================================
def setup_governance():
    """Unity Catalogë¡œ ë°ì´í„° ê±°ë²„ë„ŒìŠ¤ ì„¤ì •"""

    # ì¹´íƒˆë¡œê·¸ ë° ìŠ¤í‚¤ë§ˆ ìƒì„±
    spark.sql("CREATE CATALOG IF NOT EXISTS main")
    spark.sql("CREATE SCHEMA IF NOT EXISTS main.sales")

    # ê´€ë¦¬ í…Œì´ë¸” ìƒì„±
    spark.sql("""
        CREATE TABLE IF NOT EXISTS main.sales.orders
        USING DELTA
        AS SELECT * FROM delta.`s3a://company-lakehouse/orders`
    """)

    # ì—´ ìˆ˜ì¤€ ë³´ì•ˆ (Column Masking)
    spark.sql("""
        ALTER TABLE main.sales.orders
        ALTER COLUMN customer_id SET MASK mask_customer_id
    """)

    # í–‰ ìˆ˜ì¤€ ë³´ì•ˆ (Row-Level Security)
    spark.sql("""
        ALTER TABLE main.sales.orders
        SET ROW FILTER region_filter ON (region)
    """)

    # ì ‘ê·¼ ê¶Œí•œ ì„¤ì •
    spark.sql("GRANT SELECT ON TABLE main.sales.orders TO `analysts`")
    spark.sql("GRANT ALL PRIVILEGES ON TABLE main.sales.orders TO `data_engineers`")

    print("Governance policies applied via Unity Catalog")

# ============================================
# Lakehouse íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
# ============================================
if __name__ == "__main__":
    create_delta_table()
    evolve_schema()
    optimize_table()
    time_travel_queries()
    setup_governance()

    print("Data Lakehouse setup completed!")</code></pre>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì œ ì„¹ì…˜ -->
        <section class="term-section">
            <h2>ì‹¤ë¬´ì—ì„œ ìì£¼ ë“±ì¥í•˜ëŠ” ëŒ€í™” ì˜ˆì œ</h2>
            <div class="conv-tabs">
                <button class="conv-tab active" data-type="meeting">íŒ€ íšŒì˜</button>
                <button class="conv-tab" data-type="interview">ê¸°ìˆ  ë©´ì ‘</button>
                <button class="conv-tab" data-type="review">ì½”ë“œ ë¦¬ë·°</button>
            </div>

            <div class="conv-content active" data-type="meeting">
                <div class="conv-item">
                    <div class="conv-role">CTO</div>
                    <div class="conv-text">"í˜„ì¬ Data Lakeì—ì„œ Redshiftë¡œ ETLí•˜ëŠ” íŒŒì´í”„ë¼ì¸ ìš´ì˜ ë¹„ìš©ì´ ë„ˆë¬´ ë†’ìŠµë‹ˆë‹¤. ë°ì´í„° ì¤‘ë³µ ì €ì¥ë„ ë¬¸ì œê³ ìš”. Lakehouseë¡œ ì „í™˜í•˜ë©´ ì–´ë–¤ ì´ì ì´ ìˆì„ê¹Œìš”?"</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ë°ì´í„° ì•„í‚¤í…íŠ¸</div>
                    <div class="conv-text">"Lakehouseë¡œ ì „í™˜í•˜ë©´ S3ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì§ì ‘ SQLë¡œ ë¶„ì„í•  ìˆ˜ ìˆì–´ Redshift ë¹„ìš©ì„ ëŒ€í­ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Delta Lakeë‚˜ Icebergë¥¼ ì ìš©í•˜ë©´ ACID íŠ¸ëœì­ì…˜, ìŠ¤í‚¤ë§ˆ ì§„í™”, íƒ€ì„ íŠ¸ë˜ë¸” ê¸°ëŠ¥ìœ¼ë¡œ ë°ì´í„° í’ˆì§ˆë„ ì›¨ì–´í•˜ìš°ìŠ¤ ìˆ˜ì¤€ìœ¼ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤. ETL ëŒ€ì‹  ELTë¡œ ì „í™˜í•´ì„œ íŒŒì´í”„ë¼ì¸ë„ ë‹¨ìˆœí™”ë©ë‹ˆë‹¤."</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸</div>
                    <div class="conv-text">"ML íŒ€ ì…ì¥ì—ì„œëŠ” Feature Storeì™€ í•™ìŠµ ë°ì´í„°ê°€ ë¶„ì„ ë°ì´í„°ì™€ ê°™ì€ í”Œë«í¼ì— ìˆìœ¼ë©´ ë°ì´í„° ì¼ê´€ì„± ë¬¸ì œê°€ í•´ê²°ë©ë‹ˆë‹¤. í˜„ì¬ëŠ” Lakeì™€ Warehouse ë°ì´í„°ê°€ ë‹¬ë¼ì„œ ëª¨ë¸ ì„±ëŠ¥ ê²€ì¦ì´ ì–´ë ¤ì› ê±°ë“ ìš”."</div>
                </div>
            </div>

            <div class="conv-content" data-type="interview">
                <div class="conv-item">
                    <div class="conv-role">ë©´ì ‘ê´€</div>
                    <div class="conv-text">"Data Lakehouseê°€ ê¸°ì¡´ 2-tier ì•„í‚¤í…ì²˜(Lake + Warehouse)ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ì´ìœ ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”."</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ì§€ì›ì</div>
                    <div class="conv-text">"ê¸°ì¡´ ì•„í‚¤í…ì²˜ì—ì„œ Data LakeëŠ” ì €ë ´í•œ ìŠ¤í† ë¦¬ì§€ì™€ ë‹¤ì–‘í•œ ë°ì´í„° í¬ë§· ì§€ì›ì´ ì¥ì ì´ì§€ë§Œ, íŠ¸ëœì­ì…˜ ì§€ì›ì´ ì—†ê³  ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ê°€ ì–´ë µìŠµë‹ˆë‹¤. WarehouseëŠ” ACIDì™€ SQL ì„±ëŠ¥ì´ ìš°ìˆ˜í•˜ì§€ë§Œ ë¹„ìš©ì´ ë†’ê³  ë¹„ì •í˜• ë°ì´í„° ì²˜ë¦¬ê°€ ì œí•œì ì…ë‹ˆë‹¤. LakehouseëŠ” Delta Lake, Iceberg ê°™ì€ ì˜¤í”ˆ í…Œì´ë¸” í¬ë§·ìœ¼ë¡œ ê°ì²´ ìŠ¤í† ë¦¬ì§€ ìœ„ì—ì„œ íŠ¸ëœì­ì…˜, ìŠ¤í‚¤ë§ˆ ì§„í™”, íƒ€ì„ íŠ¸ë˜ë¸”ì„ ì§€ì›í•´ ë‘ ì¥ì ì„ ëª¨ë‘ ì·¨í•©ë‹ˆë‹¤."</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ë©´ì ‘ê´€</div>
                    <div class="conv-text">"Delta Lake, Iceberg, Hudi ì¤‘ ì–´ë–¤ ê²ƒì„ ì„ íƒí• ì§€ ê¸°ì¤€ì´ ìˆë‚˜ìš”?"</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ì§€ì›ì</div>
                    <div class="conv-text">"Delta LakeëŠ” Databricks ìƒíƒœê³„ì—ì„œ ìµœì í™”ë˜ì–´ ìˆê³ , Sparkì™€ì˜ í†µí•©ì´ ê°€ì¥ ê°•ë ¥í•©ë‹ˆë‹¤. IcebergëŠ” ë²¤ë” ì¤‘ë¦½ì ì´ê³  Trino, Flink, Snowflake ë“± ë‹¤ì–‘í•œ ì—”ì§„ ì§€ì›ì´ ìš°ìˆ˜í•©ë‹ˆë‹¤. íŠ¹íˆ íŒŒí‹°ì…˜ ì§„í™”ì™€ Hidden Partitioningì´ ê°•ì ì…ë‹ˆë‹¤. HudiëŠ” Uberì—ì„œ ë§Œë“¤ì–´ ì¦ë¶„ ì²˜ë¦¬(Incremental Processing)ì™€ ìŠ¤íŠ¸ë¦¬ë° ìˆ˜ì§‘ì— ê°•ì ì´ ìˆìŠµë‹ˆë‹¤. ê¸°ì¡´ ìŠ¤íƒê³¼ í˜¸í™˜ì„±, íŒ€ì˜ ê¸°ìˆ  ì—­ëŸ‰ì„ ê³ ë ¤í•´ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤."</div>
                </div>
            </div>

            <div class="conv-content" data-type="review">
                <div class="conv-item">
                    <div class="conv-role">ì‹œë‹ˆì–´ ì—”ì§€ë‹ˆì–´</div>
                    <div class="conv-text">"Delta í…Œì´ë¸”ì— ë§¤ì‹œê°„ append í•˜ê³  ìˆëŠ”ë°, ì‘ì€ íŒŒì¼ì´ ì—„ì²­ë‚˜ê²Œ ë§ì•„ì¡Œë„¤ìš”. ì¿¼ë¦¬ ì„±ëŠ¥ì´ ê¸‰ê²©íˆ ì €í•˜ë˜ê³  ìˆì–´ìš”."</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ì£¼ë‹ˆì–´ ì—”ì§€ë‹ˆì–´</div>
                    <div class="conv-text">"Auto-optimization ì„¤ì •ì´ ì•ˆ ë˜ì–´ ìˆì—ˆë„¤ìš”. delta.autoOptimize.optimizeWriteì™€ autoCompactë¥¼ í™œì„±í™”í•˜ê³ , ì¼ê°„ OPTIMIZE ì‘ì—…ë„ ìŠ¤ì¼€ì¤„ë§í•˜ê² ìŠµë‹ˆë‹¤."</div>
                </div>
                <div class="conv-item">
                    <div class="conv-role">ì‹œë‹ˆì–´ ì—”ì§€ë‹ˆì–´</div>
                    <div class="conv-text">"ì¢‹ì•„ìš”. ê·¸ë¦¬ê³  customer_idë¡œ ìì£¼ í•„í„°ë§í•˜ë‹ˆê¹Œ Z-Order í´ëŸ¬ìŠ¤í„°ë§ë„ ì ìš©í•˜ì„¸ìš”. VACUUMë„ ì£¼ê¸°ì ìœ¼ë¡œ ëŒë ¤ì„œ ì˜¤ë˜ëœ ë²„ì „ íŒŒì¼ì„ ì •ë¦¬í•´ì•¼ ìŠ¤í† ë¦¬ì§€ ë¹„ìš©ë„ ê´€ë¦¬ë©ë‹ˆë‹¤. ë‹¨, VACUUM ì „ì— íƒ€ì„ íŠ¸ë˜ë¸”ì´ í•„ìš”í•œ ê¸°ê°„ì„ í™•ì¸í•˜ê³  retention ê¸°ê°„ì„ ì„¤ì •í•˜ì„¸ìš”."</div>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ ì„¹ì…˜ -->
        <section class="term-section">
            <h2>ì£¼ì˜ì‚¬í•­</h2>
            <ul class="warning-list">
                <li><strong>í…Œì´ë¸” í¬ë§· ì„ íƒ:</strong> Delta Lake, Iceberg, Hudi ê°ê°ì˜ ì¥ë‹¨ì ê³¼ ì—ì½”ì‹œìŠ¤í…œ í˜¸í™˜ì„±ì„ ì¶©ë¶„íˆ ê²€í† í•˜ì„¸ìš”. í•œë²ˆ ì„ íƒí•˜ë©´ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¹„ìš©ì´ í¬ë¯€ë¡œ ì‹ ì¤‘í•œ ê²°ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.</li>
                <li><strong>Small Files Problem:</strong> ìŠ¤íŠ¸ë¦¬ë°ì´ë‚˜ ë¹ˆë²ˆí•œ ë°°ì¹˜ë¡œ ì‘ì€ íŒŒì¼ì´ ëˆ„ì ë˜ë©´ ë©”íƒ€ë°ì´í„° ì—°ì‚°ê³¼ ì¿¼ë¦¬ ì„±ëŠ¥ì´ ì €í•˜ë©ë‹ˆë‹¤. Auto-compaction, OPTIMIZE, ì ì ˆí•œ íŒŒí‹°ì…˜ ì „ëµì„ ì ìš©í•˜ì„¸ìš”.</li>
                <li><strong>VACUUM ì£¼ì˜:</strong> VACUUMìœ¼ë¡œ ì˜¤ë˜ëœ íŒŒì¼ì„ ì‚­ì œí•˜ë©´ í•´ë‹¹ ë²„ì „ìœ¼ë¡œ íƒ€ì„ íŠ¸ë˜ë¸”ì´ ë¶ˆê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ê·œì • ì¤€ìˆ˜ë‚˜ ê°ì‚¬ ìš”ê±´ì„ ê³ ë ¤í•˜ì—¬ retention ê¸°ê°„ì„ ì„¤ì •í•˜ì„¸ìš”.</li>
                <li><strong>ìŠ¤í‚¤ë§ˆ ì§„í™” í˜¸í™˜ì„±:</strong> ì»¬ëŸ¼ ì¶”ê°€ëŠ” ì•ˆì „í•˜ì§€ë§Œ, ì»¬ëŸ¼ ì‚­ì œë‚˜ íƒ€ì… ë³€ê²½ì€ ê¸°ì¡´ ë°ì´í„°ë‚˜ downstream ì‹œìŠ¤í…œì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³€ê²½ ì „ ì˜í–¥ ë²”ìœ„ë¥¼ ë¶„ì„í•˜ì„¸ìš”.</li>
                <li><strong>ì»´í“¨íŠ¸ ë¹„ìš©:</strong> LakehouseëŠ” ìŠ¤í† ë¦¬ì§€ëŠ” ì €ë ´í•˜ì§€ë§Œ Spark ê°™ì€ ë¶„ì‚° ì»´í“¨íŒ… ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤. ì¿¼ë¦¬ íŒ¨í„´ì— ë§ê²Œ í´ëŸ¬ìŠ¤í„° í¬ê¸°ë¥¼ ì¡°ì •í•˜ê³ , í•„ìš”ì‹œ ì„œë²„ë¦¬ìŠ¤ ì˜µì…˜ì„ ê²€í† í•˜ì„¸ìš”.</li>
            </ul>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ ì„¹ì…˜ -->
        <section class="term-section">
            <h2>ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-grid">
                <a href="/ko/term/Data%20Lake/" class="related-term">
                    <span class="related-arrow">â†’</span>
                    <span>Data Lake</span>
                </a>
                <a href="/ko/term/Data%20Warehouse/" class="related-term">
                    <span class="related-arrow">â†’</span>
                    <span>Data Warehouse</span>
                </a>
                <a href="/ko/term/Apache%20Iceberg/" class="related-term">
                    <span class="related-arrow">â†’</span>
                    <span>Apache Iceberg</span>
                </a>
                <a href="/ko/term/Apache%20Hudi/" class="related-term">
                    <span class="related-arrow">â†’</span>
                    <span>Apache Hudi</span>
                </a>
                <a href="/ko/term/Databricks/" class="related-term">
                    <span class="related-arrow">â†’</span>
                    <span>Databricks</span>
                </a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° ì„¹ì…˜ -->
        <section class="term-section">
            <h2>ë” ë°°ìš°ê¸°</h2>
            <ul class="resource-list">
                <li>
                    <a href="https://www.databricks.com/glossary/data-lakehouse" target="_blank">
                        <span class="resource-icon">ğŸ“„</span>
                        <span>Databricks - What is a Data Lakehouse?</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.cidrdb.org/cidr2021/papers/cidr2021_paper17.pdf" target="_blank">
                        <span class="resource-icon">ğŸ“š</span>
                        <span>Lakehouse: A New Generation of Open Platforms (ë…¼ë¬¸)</span>
                    </a>
                </li>
                <li>
                    <a href="https://delta.io/learn/getting-started/" target="_blank">
                        <span class="resource-icon">ğŸ“</span>
                        <span>Delta Lake ì‹œì‘ ê°€ì´ë“œ</span>
                    </a>
                </li>
            </ul>
        </section>
    </main>

    <!-- Engagement Kit -->
    <div id="kaitrust-engagement-kit"></div>
    <link rel="stylesheet" href="/components/engagement-kit/engagement-kit.css?v=20260130015843">
    <script src="/components/engagement-kit/engagement-kit.js?v=20260130020328"></script>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "38px", fabRight: "30px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
    <script src="/glossary/js/term-sections.js"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js?v=20260130012"></script>
    <script src="/kaitrust-i18n.js?v=20260130012"></script>
</body>
</html>
