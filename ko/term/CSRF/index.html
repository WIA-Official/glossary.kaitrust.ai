<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSRF (Cross-Site Request Forgery) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="CSRFëŠ” ì‚¬ìš©ìì˜ ì¸ì¦ëœ ì„¸ì…˜ì„ ì•…ìš©í•˜ì—¬ ì•…ì˜ì  ìš”ì²­ì„ ì „ì†¡í•˜ëŠ” ì›¹ ë³´ì•ˆ ê³µê²©ì…ë‹ˆë‹¤. CSRF í† í°, SameSite ì¿ í‚¤, Origin ê²€ì¦ìœ¼ë¡œ ë°©ì–´í•©ë‹ˆë‹¤. OWASP Top 10 ì·¨ì•½ì ì…ë‹ˆë‹¤.">
    <meta name="keywords" content="CSRF, Cross-Site Request Forgery, ì‚¬ì´íŠ¸ê°„ ìš”ì²­ ìœ„ì¡°, ì›¹ ë³´ì•ˆ, CSRF í† í°, SameSite Cookie, OWASP, XSS, ì›¹ ì·¨ì•½ì , ì„¸ì…˜ í•˜ì´ì¬í‚¹, ì¿ í‚¤ ë³´ì•ˆ, KAITRUST">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/CSRF/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/CSRF/">
    <meta property="og:title" content="CSRF (Cross-Site Request Forgery) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="CSRFëŠ” ì‚¬ìš©ìì˜ ì¸ì¦ëœ ì„¸ì…˜ì„ ì•…ìš©í•˜ì—¬ ì•…ì˜ì  ìš”ì²­ì„ ì „ì†¡í•˜ëŠ” ì›¹ ë³´ì•ˆ ê³µê²©ì…ë‹ˆë‹¤. CSRF í† í°, SameSite ì¿ í‚¤ë¡œ ë°©ì–´í•©ë‹ˆë‹¤.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CSRF (Cross-Site Request Forgery) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="CSRFëŠ” ì‚¬ìš©ìì˜ ì¸ì¦ëœ ì„¸ì…˜ì„ ì•…ìš©í•˜ì—¬ ì•…ì˜ì  ìš”ì²­ì„ ì „ì†¡í•˜ëŠ” ì›¹ ë³´ì•ˆ ê³µê²©ì…ë‹ˆë‹¤. CSRF í† í°, SameSite ì¿ í‚¤ë¡œ ë°©ì–´í•©ë‹ˆë‹¤.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "CSRF",
        "alternateName": "Cross-Site Request Forgery",
        "description": "CSRFëŠ” ì‚¬ìš©ìì˜ ì¸ì¦ëœ ì„¸ì…˜ì„ ì•…ìš©í•˜ì—¬ ì•…ì˜ì  ìš”ì²­ì„ ì „ì†¡í•˜ëŠ” ì›¹ ë³´ì•ˆ ê³µê²©ì…ë‹ˆë‹¤. CSRF í† í°, SameSite ì¿ í‚¤, Origin ê²€ì¦ìœ¼ë¡œ ë°©ì–´í•©ë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        /* ê³ ë„í™” ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .term-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-content p {
            color: #cbd5e1;
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        .section-content p:last-child { margin-bottom: 0; }

        /* ì½”ë“œ ë¸”ë¡ */
        .code-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .code-tab {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s;
        }
        .code-tab.active {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
            color: #a855f7;
        }
        .code-block {
            position: relative;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
            display: none;
        }
        .code-block.active { display: block; }
        .code-block pre {
            padding: 1.5rem;
            margin: 0;
            overflow-x: auto;
        }
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
            line-height: 1.6;
        }
        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.3);
            border: none;
            border-radius: 6px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        .copy-btn:hover { background: rgba(168, 85, 247, 0.5); }

        /* ëŒ€í™” ì˜ˆì‹œ */
        .conversation-examples { display: flex; flex-direction: column; gap: 1.5rem; }
        .conv-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 1.25rem;
        }
        .conv-context {
            font-size: 0.9rem;
            color: #a855f7;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }
        .conv-quote {
            color: #e2e8f0;
            font-style: italic;
            line-height: 1.7;
            margin: 0;
            padding-left: 1rem;
            border-left: 3px solid #a855f7;
        }

        /* ì£¼ì˜ì‚¬í•­ */
        .warning-list { display: flex; flex-direction: column; gap: 1rem; }
        .warning-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .warning-icon { font-size: 1.5rem; }
        .warning-item strong { color: #f1f5f9; display: block; margin-bottom: 0.25rem; }
        .warning-item p { color: #94a3b8; margin: 0; font-size: 0.95rem; }

        /* ê´€ë ¨ ìš©ì–´ */
        .related-terms { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .related-term-link {
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            color: #a855f7;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .related-term-link:hover {
            background: rgba(168, 85, 247, 0.2);
            transform: translateY(-2px);
        }

        /* ë” ë°°ìš°ê¸° */
        .learn-more { display: flex; flex-direction: column; gap: 0.75rem; }
        .learn-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            color: #00f5ff;
            text-decoration: none;
            transition: all 0.2s;
        }
        .learn-link:hover { background: rgba(0, 0, 0, 0.3); transform: translateX(5px); }

        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a {
            color: #64748b;
            text-decoration: none;
            transition: color 0.2s;
        }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english {
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
        }
        .term-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }
        .term-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
        }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css">

</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#security">ë³´ì•ˆ</a>
            <span>â€º</span>
            <span class="current">CSRF</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ”’</span>
                <span>ë³´ì•ˆ</span>
            </div>
            <h1 class="term-title">CSRF</h1>
            <p class="term-english">Cross-Site Request Forgery</p>
            <div class="term-description">
                <p>ì‚¬ì´íŠ¸ ê°„ ìš”ì²­ ìœ„ì¡° ê³µê²©. ì‚¬ìš©ìì˜ ì¸ì¦ëœ ì„¸ì…˜ì„ ì•…ìš©í•˜ì—¬ ì˜ë„í•˜ì§€ ì•Šì€ ìš”ì²­ì„ ì„œë²„ì— ì „ì†¡í•˜ëŠ” ì›¹ ë³´ì•ˆ ì·¨ì•½ì ì…ë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#security" class="term-action-btn btn-secondary">
                    ğŸ”’ ë³´ì•ˆ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“– ìƒì„¸ ì„¤ëª…</h2>
            <div class="section-content">
                <p>CSRF(Cross-Site Request Forgery)ëŠ” ì‚¬ìš©ìê°€ ì¸ì¦ëœ ìƒíƒœì—ì„œ ì•…ì˜ì  ìš”ì²­ì„ ì˜ë„ì¹˜ ì•Šê²Œ ì‹¤í–‰í•˜ê²Œ ë§Œë“œëŠ” ì›¹ ê³µê²©ì…ë‹ˆë‹¤. ê³µê²©ìëŠ” í”¼í•´ìê°€ ë¡œê·¸ì¸í•œ ì‚¬ì´íŠ¸ì— ëŒ€í•œ ìš”ì²­ì„ ì•…ì„± í˜ì´ì§€ì— ìˆ¨ê²¨ë†“ê³ , í”¼í•´ìê°€ í•´ë‹¹ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•˜ë©´ ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì¿ í‚¤ë¥¼ í¬í•¨í•´ ìš”ì²­ì„ ì „ì†¡í•©ë‹ˆë‹¤. ì€í–‰ ì†¡ê¸ˆ, ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, ì´ë©”ì¼ ì£¼ì†Œ ìˆ˜ì • ê°™ì€ ì¤‘ìš”í•œ ì‘ì—…ì´ í”¼í•´ì ëª¨ë¥´ê²Œ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                <p>CSRF ê³µê²©ì´ ì„±ê³µí•˜ë ¤ë©´ ì„¸ ê°€ì§€ ì¡°ê±´ì´ í•„ìš”í•©ë‹ˆë‹¤. ì²«ì§¸, í”¼í•´ìê°€ ëŒ€ìƒ ì‚¬ì´íŠ¸ì— ë¡œê·¸ì¸ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë‘˜ì§¸, ì„¸ì…˜ ì¿ í‚¤ê°€ ìš”ì²­ì— ìë™ìœ¼ë¡œ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì…‹ì§¸, ëŒ€ìƒ ì•¡ì…˜ì˜ íŒŒë¼ë¯¸í„°ê°€ ì˜ˆì¸¡ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì§€ ì•Šìœ¼ë©´ CSRFì— ì·¨ì•½í•©ë‹ˆë‹¤. XSSê°€ "ì‹ ë¢°ëœ ì‚¬ì´íŠ¸ì—ì„œ ì•…ì„± ì½”ë“œ ì‹¤í–‰"ì´ë¼ë©´, CSRFëŠ” "ì•…ì„± ì‚¬ì´íŠ¸ì—ì„œ ì‹ ë¢°ëœ ìš”ì²­ ì „ì†¡"ì…ë‹ˆë‹¤.</p>
                <p>CSRF ë°©ì–´ì˜ í•µì‹¬ì€ CSRF í† í°(Anti-CSRF Token)ì…ë‹ˆë‹¤. ì„œë²„ê°€ ì„¸ì…˜ë³„ë¡œ ê³ ìœ í•œ í† í°ì„ ìƒì„±í•˜ê³ , ëª¨ë“  ìƒíƒœ ë³€ê²½ ìš”ì²­ì— ì´ í† í°ì„ í¬í•¨í•˜ë„ë¡ ìš”êµ¬í•©ë‹ˆë‹¤. ê³µê²©ìëŠ” í”¼í•´ìì˜ í† í° ê°’ì„ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ìœ íš¨í•œ ìš”ì²­ì„ ë§Œë“¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Django, Rails, Spring Security ê°™ì€ ì£¼ìš” í”„ë ˆì„ì›Œí¬ëŠ” CSRF í† í°ì„ ë‚´ì¥ ì§€ì›í•©ë‹ˆë‹¤. SPA(Single Page Application)ì—ì„œëŠ” í† í°ì„ HTTP í—¤ë”ë¡œ ì „ì†¡í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
                <p>í˜„ëŒ€ ë¸Œë¼ìš°ì €ì˜ SameSite ì¿ í‚¤ ì†ì„±ì€ CSRF ë°©ì–´ì˜ ìƒˆë¡œìš´ í‘œì¤€ì…ë‹ˆë‹¤. SameSite=Strictì€ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìš”ì²­ì— ì¿ í‚¤ë¥¼ ì „í˜€ ë³´ë‚´ì§€ ì•Šê³ , SameSite=LaxëŠ” ì•ˆì „í•œ ë©”ì„œë“œ(GET)ì˜ íƒ‘ë ˆë²¨ ë„¤ë¹„ê²Œì´ì…˜ì—ë§Œ ì¿ í‚¤ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. Chrome 80ë¶€í„° SameSite=Laxê°€ ê¸°ë³¸ê°’ì´ ë˜ë©´ì„œ ë§ì€ CSRF ê³µê²©ì´ ìë™ ì°¨ë‹¨ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ SameSiteë§Œìœ¼ë¡œëŠ” ì™„ì „í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ CSRF í† í°ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p>
            </div>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ’» ì½”ë“œ ì˜ˆì œ</h2>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="node">Node.js/Express</button>
                <button class="code-tab" data-lang="django">Django</button>
                <button class="code-tab" data-lang="react">React SPA</button>
            </div>
            <div class="code-block active" data-lang="node">
                <pre><code class="language-javascript">// CSRF ë°©ì–´ - Node.js Express ì˜ˆì œ
const express = require('express');
const csrf = require('csurf');
const cookieParser = require('cookie-parser');

const app = express();

// ì¿ í‚¤ íŒŒì„œ ì„¤ì •
app.use(cookieParser());
app.use(express.urlencoded({ extended: false }));

// CSRF ë¯¸ë“¤ì›¨ì–´ ì„¤ì •
const csrfProtection = csrf({
    cookie: {
        httpOnly: true,
        secure: process.env.NODE_ENV === 'production',
        sameSite: 'strict'  // SameSite ì¿ í‚¤ ì„¤ì •
    }
});

// CSRF í† í°ì„ ì¿ í‚¤ë¡œ ì „ë‹¬ (SPAìš©)
app.get('/api/csrf-token', csrfProtection, (req, res) => {
    res.json({ csrfToken: req.csrfToken() });
});

// ë¡œê·¸ì¸ í¼ (ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§)
app.get('/login', csrfProtection, (req, res) => {
    res.send(`
        <form method="POST" action="/login">
            <input type="hidden" name="_csrf" value="${req.csrfToken()}">
            <input type="email" name="email" placeholder="ì´ë©”ì¼">
            <input type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <button type="submit">ë¡œê·¸ì¸</button>
        </form>
    `);
});

// ë¡œê·¸ì¸ ì²˜ë¦¬ - CSRF í† í° ê²€ì¦ ìë™ ìˆ˜í–‰
app.post('/login', csrfProtection, (req, res) => {
    // CSRF í† í°ì´ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ 403 ì—ëŸ¬ ë°œìƒ
    const { email, password } = req.body;
    // ì¸ì¦ ë¡œì§...
    res.send('ë¡œê·¸ì¸ ì„±ê³µ');
});

// ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ - ë¯¼ê°í•œ ì‘ì—…ì— CSRF í•„ìˆ˜
app.post('/api/change-password', csrfProtection, (req, res) => {
    const { currentPassword, newPassword } = req.body;

    // í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (CSRFì™€ ë³„ê°œë¡œ ì¶”ê°€ ë³´ì•ˆ)
    if (!verifyCurrentPassword(req.user, currentPassword)) {
        return res.status(401).json({ error: 'í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤' });
    }

    // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì²˜ë¦¬...
    res.json({ message: 'ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤' });
});

// CSRF ì—ëŸ¬ í•¸ë“¤ëŸ¬
app.use((err, req, res, next) => {
    if (err.code === 'EBADCSRFTOKEN') {
        res.status(403).json({
            error: 'CSRF í† í°ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤',
            message: 'ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆê±°ë‚˜ ìš”ì²­ì´ ìœ„ì¡°ë˜ì—ˆìŠµë‹ˆë‹¤'
        });
    } else {
        next(err);
    }
});

// ì¿ í‚¤ ì„¤ì • ì˜ˆì‹œ - SameSite í¬í•¨
app.post('/api/session', (req, res) => {
    res.cookie('sessionId', 'abc123', {
        httpOnly: true,
        secure: true,
        sameSite: 'lax',  // í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìš”ì²­ ì œí•œ
        maxAge: 24 * 60 * 60 * 1000  // 24ì‹œê°„
    });
    res.json({ success: true });
});</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="django">
                
                <pre><code class="language-python"># CSRF ë°©ì–´ - Django ì˜ˆì œ
# DjangoëŠ” CSRF ë³´í˜¸ê°€ ê¸°ë³¸ í™œì„±í™”

# settings.py
CSRF_COOKIE_SECURE = True  # HTTPSì—ì„œë§Œ ì¿ í‚¤ ì „ì†¡
CSRF_COOKIE_HTTPONLY = True  # JavaScriptì—ì„œ ì¿ í‚¤ ì ‘ê·¼ ë¶ˆê°€
CSRF_COOKIE_SAMESITE = 'Lax'  # SameSite ì„¤ì •
CSRF_TRUSTED_ORIGINS = ['https://example.com']  # ì‹ ë¢° ë„ë©”ì¸

# views.py
from django.views.decorators.csrf import csrf_protect, ensure_csrf_cookie
from django.middleware.csrf import get_token
from django.http import JsonResponse

# í…œí”Œë¦¿ì—ì„œ CSRF í† í° ì‚¬ìš©
# {% csrf_token %} - í¼ì— hidden í•„ë“œë¡œ í† í° ì‚½ì…

@ensure_csrf_cookie  # ì¿ í‚¤ì— CSRF í† í° ì„¤ì •
def get_csrf_token(request):
    """SPAë¥¼ ìœ„í•œ CSRF í† í° ì—”ë“œí¬ì¸íŠ¸"""
    return JsonResponse({'csrfToken': get_token(request)})

@csrf_protect  # CSRF ê²€ì¦ ê°•ì œ
def change_password(request):
    """ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ - CSRF ë³´í˜¸ í•„ìˆ˜"""
    if request.method == 'POST':
        current_password = request.POST.get('current_password')
        new_password = request.POST.get('new_password')

        # í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (ì¶”ê°€ ë³´ì•ˆ)
        if not request.user.check_password(current_password):
            return JsonResponse({'error': 'í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜'}, status=401)

        request.user.set_password(new_password)
        request.user.save()
        return JsonResponse({'message': 'ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ë¨'})

# AJAX ìš”ì²­ì—ì„œ CSRF í† í° ì „ì†¡ (JavaScript)
"""
// ì¿ í‚¤ì—ì„œ CSRF í† í° ì½ê¸°
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// fetch ìš”ì²­ì— CSRF í† í° í¬í•¨
fetch('/api/change-password', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': getCookie('csrftoken')  // í—¤ë”ë¡œ ì „ì†¡
    },
    credentials: 'include',  // ì¿ í‚¤ í¬í•¨
    body: JSON.stringify({ new_password: 'newPass123' })
});
"""

# REST Frameworkì—ì„œ CSRF
from rest_framework.decorators import api_view
from rest_framework.response import Response

@api_view(['POST'])
def api_transfer_money(request):
    """
    DRFëŠ” SessionAuthentication ì‚¬ìš© ì‹œ CSRF ê²€ì¦ ìˆ˜í–‰
    TokenAuthentication ì‚¬ìš© ì‹œ CSRF ë¶ˆí•„ìš” (í† í° ìì²´ê°€ ì¸ì¦)
    """
    amount = request.data.get('amount')
    to_account = request.data.get('to_account')
    # ì†¡ê¸ˆ ì²˜ë¦¬...
    return Response({'success': True})</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="react">
                <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                <pre><code class="language-javascript">// CSRF ë°©ì–´ - React SPA ì˜ˆì œ
import axios from 'axios';
import { useEffect, useState } from 'react';

// Axios ì¸ìŠ¤í„´ìŠ¤ ì„¤ì • - CSRF í† í° ìë™ í¬í•¨
const api = axios.create({
    baseURL: '/api',
    withCredentials: true,  // ì¿ í‚¤ í¬í•¨
});

// ì‘ë‹µì—ì„œ CSRF í† í° ì¿ í‚¤ ì¶”ì¶œ
function getCsrfToken() {
    const name = 'csrftoken';
    const cookies = document.cookie.split(';');
    for (let cookie of cookies) {
        const [cookieName, cookieValue] = cookie.trim().split('=');
        if (cookieName === name) {
            return decodeURIComponent(cookieValue);
        }
    }
    return null;
}

// ìš”ì²­ ì¸í„°ì…‰í„° - ëª¨ë“  ìš”ì²­ì— CSRF í† í° ì¶”ê°€
api.interceptors.request.use(config => {
    const csrfToken = getCsrfToken();
    if (csrfToken) {
        config.headers['X-CSRFToken'] = csrfToken;
    }
    return config;
});

// CSRF í† í° ì´ˆê¸°í™” í›…
function useCsrfToken() {
    const [isReady, setIsReady] = useState(false);

    useEffect(() => {
        // ì•± ì‹œì‘ ì‹œ CSRF í† í° ì¿ í‚¤ íšë“
        api.get('/csrf-token')
            .then(() => setIsReady(true))
            .catch(err => console.error('CSRF í† í° ì´ˆê¸°í™” ì‹¤íŒ¨:', err));
    }, []);

    return isReady;
}

// ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í¼ ì»´í¬ë„ŒíŠ¸
function ChangePasswordForm() {
    const csrfReady = useCsrfToken();
    const [formData, setFormData] = useState({
        currentPassword: '',
        newPassword: '',
        confirmPassword: ''
    });
    const [error, setError] = useState('');
    const [success, setSuccess] = useState(false);

    const handleSubmit = async (e) => {
        e.preventDefault();
        setError('');

        if (formData.newPassword !== formData.confirmPassword) {
            setError('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
            return;
        }

        try {
            // CSRF í† í°ì´ í—¤ë”ì— ìë™ í¬í•¨ë¨
            await api.post('/change-password', {
                current_password: formData.currentPassword,
                new_password: formData.newPassword
            });
            setSuccess(true);
        } catch (err) {
            if (err.response?.status === 403) {
                setError('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
            } else {
                setError(err.response?.data?.error || 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');
            }
        }
    };

    if (!csrfReady) {
        return <div>ë¡œë”© ì¤‘...</div>;
    }

    return (
        <form onSubmit={handleSubmit}>
            {error && <div className="error">{error}</div>}
            {success && <div className="success">ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤</div>}

            <input
                type="password"
                placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸"
                value={formData.currentPassword}
                onChange={e => setFormData({...formData, currentPassword: e.target.value})}
                required
            />
            <input
                type="password"
                placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸"
                value={formData.newPassword}
                onChange={e => setFormData({...formData, newPassword: e.target.value})}
                required
            />
            <input
                type="password"
                placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸"
                value={formData.confirmPassword}
                onChange={e => setFormData({...formData, confirmPassword: e.target.value})}
                required
            />
            <button type="submit">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
        </form>
    );
}</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ—£ï¸ ì‹¤ë¬´ì—ì„œ ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”</h2>
            <div class="conversation-examples">
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ë³´ì•ˆ ê°ì‚¬ í”¼ë“œë°±ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ APIì— CSRF ë³´í˜¸ê°€ ì—†ë„¤ìš”. ê³µê²©ìê°€ ì•…ì„± í˜ì´ì§€ì—ì„œ í”¼í•´ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Djangoë¼ë©´ @csrf_protect ë°ì½”ë ˆì´í„° ì¶”ê°€í•˜ê³ , í”„ë¡ íŠ¸ì—ì„œ X-CSRFToken í—¤ë” ì „ì†¡í•˜ë„ë¡ ìˆ˜ì •í•´ì£¼ì„¸ìš”."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ SPA ì•„í‚¤í…ì²˜ ì„¤ê³„ ì‹œ</div>
                    <blockquote class="conv-quote">
                        "React ì•±ì—ì„œ ì„¸ì…˜ ì¿ í‚¤ ì¸ì¦ ì“°ë©´ CSRF í† í° í•„ìˆ˜ì…ë‹ˆë‹¤. ì•± ì´ˆê¸°í™” ì‹œì ì— /api/csrf-token í˜¸ì¶œí•´ì„œ ì¿ í‚¤ ë°›ê³ , ëª¨ë“  POST/PUT/DELETE ìš”ì²­ì— X-CSRFToken í—¤ë” ë„£ìœ¼ì„¸ìš”. JWT í† í° ì¸ì¦ì´ë©´ CSRFëŠ” ë¶ˆí•„ìš”í•©ë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ì¿ í‚¤ ì„¤ì • ë…¼ì˜ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "ì„¸ì…˜ ì¿ í‚¤ì— SameSite=Lax ì„¤ì •í•˜ì„¸ìš”. Chrome 80 ì´í›„ ê¸°ë³¸ê°’ì´ê¸´ í•œë° ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤. ê²°ì œì²˜ëŸ¼ ë¯¼ê°í•œ ì‘ì—…ì€ SameSite=Strictì™€ CSRF í† í°ì„ í•¨ê»˜ ì‚¬ìš©í•˜ì„¸ìš”."
                    </blockquote>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ -->
        <section class="term-section">
            <h2 class="section-title">âš ï¸ ì£¼ì˜ì‚¬í•­ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h2>
            <div class="warning-list">
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>GET ìš”ì²­ìœ¼ë¡œ ìƒíƒœ ë³€ê²½</strong>
                        <p>GET ìš”ì²­ì€ CSRF í† í° ê²€ì¦ì„ ê±´ë„ˆë›°ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ê³„ì • ì‚­ì œ, ì†¡ê¸ˆ, ì„¤ì • ë³€ê²½ ê°™ì€ ìƒíƒœ ë³€ê²½ì€ ë°˜ë“œì‹œ POST/PUT/DELETEë¥¼ ì‚¬ìš©í•˜ê³  CSRF í† í°ì„ ê²€ì¦í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>CSRF í† í°ì„ URLì— ë…¸ì¶œ</strong>
                        <p>CSRF í† í°ì„ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡í•˜ë©´ Referer í—¤ë”ë‚˜ ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ì— ë…¸ì¶œë©ë‹ˆë‹¤. í•­ìƒ POST ë°”ë””ë‚˜ ì»¤ìŠ¤í…€ í—¤ë”(X-CSRFToken)ë¡œ ì „ì†¡í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>SameSiteë§Œ ë¯¿ê³  CSRF í† í° ìƒëµ</strong>
                        <p>SameSite ì¿ í‚¤ëŠ” êµ¬í˜• ë¸Œë¼ìš°ì €ì—ì„œ ì§€ì›ë˜ì§€ ì•Šê³ , ì„œë¸Œë„ë©”ì¸ ê³µê²©ì— ì·¨ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°©ì–´ ì‹¬ì¸µí™”ë¥¼ ìœ„í•´ CSRF í† í°ê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âœ…</span>
                    <div>
                        <strong>CSRF ë°©ì–´ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</strong>
                        <p>í”„ë ˆì„ì›Œí¬ì˜ ë‚´ì¥ CSRF ë³´í˜¸ë¥¼ í™œìš©í•˜ê³ , ë¯¼ê°í•œ ì‘ì—…ì—ëŠ” ì¬ì¸ì¦(í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸)ì„ ìš”êµ¬í•˜ì„¸ìš”. Origin/Referer í—¤ë” ê²€ì¦ì„ ì¶”ê°€í•˜ê³ , ì„¸ì…˜ ì¿ í‚¤ì— SameSite=Lax ì´ìƒì„ ì„¤ì •í•˜ì„¸ìš”.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ”— ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-terms">
                <a href="/ko/term/XSS/" class="related-term-link">XSS</a>
                <a href="/ko/term/Cookie/" class="related-term-link">Cookie</a>
                <a href="/ko/term/Session/" class="related-term-link">Session</a>
                <a href="/ko/term/JWT/" class="related-term-link">JWT</a>
                <a href="/ko/term/OWASP/" class="related-term-link">OWASP</a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“š ë” ë°°ìš°ê¸°</h2>
            <div class="learn-more">
                <a href="https://owasp.org/www-community/attacks/csrf" target="_blank" class="learn-link">
                    ğŸ“„ OWASP CSRF ê³µê²© ê°€ì´ë“œ
                </a>
                <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" class="learn-link">
                    ğŸ“ MDN SameSite Cookie ë¬¸ì„œ
                </a>
                <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" target="_blank" class="learn-link">
                    ğŸ“– OWASP CSRF ë°©ì–´ ì¹˜íŠ¸ì‹œíŠ¸
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>
    function copyCode(btn) {
        const codeBlock = btn.parentElement.querySelector('code');
        navigator.clipboard.writeText(codeBlock.textContent).then(() => {
            btn.textContent = 'âœ… ë³µì‚¬ë¨!';
            setTimeout(() => btn.textContent = 'ğŸ“‹ ë³µì‚¬', 2000);
        });
    }

    document.querySelectorAll('.code-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const lang = this.dataset.lang;
            const section = this.closest('.term-section');

            section.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            section.querySelectorAll('.code-block').forEach(block => {
                block.classList.remove('active');
                if (block.dataset.lang === lang) {
                    block.classList.add('active');
                }
            });
        });
    });
    </script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "78px", fabRight: "170px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
