<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XDR (í™•ì¥ëœ íƒì§€ ë° ëŒ€ì‘) | KAITRUST AI ë°±ê³¼ì‚¬ì „</title>
    <meta name="description" content="XDR(Extended Detection and Response)ì€ ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ, ì´ë©”ì¼ ë“± ì „ì²´ ê³µê²© í‘œë©´ì—ì„œ ìœ„í˜‘ì„ í†µí•© íƒì§€í•˜ê³  ëŒ€ì‘í•˜ëŠ” ë³´ì•ˆ í”Œë«í¼ì…ë‹ˆë‹¤.">
    <meta name="keywords" content="XDR, Extended Detection and Response, í™•ì¥ íƒì§€ ëŒ€ì‘, EDR, SIEM, í†µí•© ë³´ì•ˆ, ìƒê´€ ë¶„ì„, ìœ„í˜‘ íƒì§€, KAITRUST">
    <link rel="canonical" href="https://glossary.kaitrust.ai/ko/term/XDR/">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://glossary.kaitrust.ai/ko/term/XDR/">
    <meta property="og:title" content="XDR (í™•ì¥ëœ íƒì§€ ë° ëŒ€ì‘) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta property="og:description" content="ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ ì „ì²´ ê³µê²© í‘œë©´ì„ í†µí•© íƒì§€í•˜ê³  ëŒ€ì‘í•˜ëŠ” ì°¨ì„¸ëŒ€ ë³´ì•ˆ í”Œë«í¼. EDRì˜ ì§„í™”ëœ í˜•íƒœ.">
    <meta property="og:image" content="https://kaitrust.ai/images/og-glossary.png">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:site_name" content="KAITRUST AI ë°±ê³¼ì‚¬ì „">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="XDR (í™•ì¥ëœ íƒì§€ ë° ëŒ€ì‘) | KAITRUST AI ë°±ê³¼ì‚¬ì „">
    <meta name="twitter:description" content="ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ ì „ì²´ ê³µê²© í‘œë©´ì„ í†µí•© íƒì§€í•˜ê³  ëŒ€ì‘í•˜ëŠ” ì°¨ì„¸ëŒ€ ë³´ì•ˆ í”Œë«í¼. EDRì˜ ì§„í™”ëœ í˜•íƒœ.">
    <meta name="twitter:image" content="https://kaitrust.ai/images/og-glossary.png">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DefinedTerm",
        "name": "XDR",
        "alternateName": "Extended Detection and Response",
        "description": "ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ, ì´ë©”ì¼ ë“± ë‹¤ì–‘í•œ ë³´ì•ˆ ê³„ì¸µì˜ ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬ ìœ„í˜‘ì„ íƒì§€í•˜ê³  ëŒ€ì‘í•˜ëŠ” ë³´ì•ˆ í”Œë«í¼ì…ë‹ˆë‹¤.",
        "inDefinedTermSet": {
            "@type": "DefinedTermSet",
            "name": "KAITRUST AI ë°±ê³¼ì‚¬ì „",
            "url": "https://glossary.kaitrust.ai/"
        }
    }
    </script>

    <link rel="icon" type="image/png" href="https://kaitrust.ai/favicon.png">
    <link rel="apple-touch-icon" href="https://kaitrust.ai/favicon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/kaitrust-common.css">
    <link rel="stylesheet" href="/css/light-mode.css">
    <link rel="stylesheet" href="/components/ask-ai/kaitrust-ai-modal.css">

    <style>
        /* ê³ ë„í™” ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .term-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(168, 85, 247, 0.1);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(168, 85, 247, 0.2);
        }
        .section-content p {
            color: #cbd5e1;
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        .section-content p:last-child { margin-bottom: 0; }

        /* ì½”ë“œ ë¸”ë¡ */
        .code-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .code-tab {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.2s;
        }
        .code-tab.active {
            background: rgba(168, 85, 247, 0.2);
            border-color: #a855f7;
            color: #a855f7;
        }
        .code-block {
            position: relative;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
            display: none;
        }
        .code-block.active { display: block; }
        .code-block pre {
            padding: 1.5rem;
            margin: 0;
            overflow-x: auto;
        }
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
            line-height: 1.6;
        }
        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.3);
            border: none;
            border-radius: 6px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        .copy-btn:hover { background: rgba(168, 85, 247, 0.5); }

        /* ëŒ€í™” ì˜ˆì‹œ */
        .conversation-examples { display: flex; flex-direction: column; gap: 1.5rem; }
        .conv-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 1.25rem;
        }
        .conv-context {
            font-size: 0.9rem;
            color: #a855f7;
            font-weight: 500;
            margin-bottom: 0.75rem;
        }
        .conv-quote {
            color: #e2e8f0;
            font-style: italic;
            line-height: 1.7;
            margin: 0;
            padding-left: 1rem;
            border-left: 3px solid #a855f7;
        }

        /* ì£¼ì˜ì‚¬í•­ */
        .warning-list { display: flex; flex-direction: column; gap: 1rem; }
        .warning-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .warning-icon { font-size: 1.5rem; }
        .warning-item strong { color: #f1f5f9; display: block; margin-bottom: 0.25rem; }
        .warning-item p { color: #94a3b8; margin: 0; font-size: 0.95rem; }

        /* ê´€ë ¨ ìš©ì–´ */
        .related-terms { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .related-term-link {
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            color: #a855f7;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .related-term-link:hover {
            background: rgba(168, 85, 247, 0.2);
            transform: translateY(-2px);
        }

        /* ë” ë°°ìš°ê¸° */
        .learn-more { display: flex; flex-direction: column; gap: 0.75rem; }
        .learn-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            color: #00f5ff;
            text-decoration: none;
            transition: all 0.2s;
        }
        .learn-link:hover { background: rgba(0, 0, 0, 0.3); transform: translateX(5px); }

        .term-detail-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }
        .breadcrumb a {
            color: #64748b;
            text-decoration: none;
            transition: color 0.2s;
        }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb span { color: #64748b; }
        .breadcrumb .current { color: var(--accent); font-weight: 500; }
        .term-detail-header {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.6));
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        .term-category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(168, 85, 247, 0.2);
            border-radius: 20px;
            font-size: 0.85rem;
            color: #a855f7;
            margin-bottom: 1rem;
        }
        .term-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #ffffff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .term-english {
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
        }
        .term-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e2e8f0;
        }
        .term-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .term-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.3);
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        @media (max-width: 768px) {
            .term-detail-container { padding: 100px 1rem 2rem; }
            .term-detail-header { padding: 2rem 1.5rem; }
            .term-title { font-size: 1.8rem; }
        }
    </style>
    <link rel="stylesheet" href="/glossary/css/term-sections.css?v=20260129232035">

</head>
<body>
    <!-- Particle Background -->
    <div class="particle-container" id="particles"></div>

    <!-- Header -->
        <div id="kaitrust-header"></div>

    <main class="term-detail-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="https://kaitrust.ai">í™ˆ</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai">AI ë°±ê³¼ì‚¬ì „</a>
            <span>â€º</span>
            <a href="https://glossary.kaitrust.ai/#security">ë³´ì•ˆ</a>
            <span>â€º</span>
            <span class="current">XDR</span>
        </nav>

        <!-- Term Header -->
        <article class="term-detail-header">
            <div class="term-category-badge">
                <span>ğŸ”’</span>
                <span>ë³´ì•ˆ</span>
            </div>
            <h1 class="term-title">XDR</h1>
            <p class="term-english">Extended Detection and Response (í™•ì¥ëœ íƒì§€ ë° ëŒ€ì‘)</p>
            <div class="term-description">
                <p>ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ, ì´ë©”ì¼, ì•„ì´ë´í‹°í‹° ë“± ë‹¤ì–‘í•œ ë³´ì•ˆ ê³„ì¸µì˜ ë°ì´í„°ë¥¼ ë‹¨ì¼ í”Œë«í¼ì—ì„œ í†µí•© ìˆ˜ì§‘í•˜ê³ , í¬ë¡œìŠ¤-ë ˆì´ì–´ ìƒê´€ ë¶„ì„ì„ í†µí•´ ìœ„í˜‘ì„ íƒì§€í•˜ë©°, í†µí•©ëœ ëŒ€ì‘ì„ ì œê³µí•˜ëŠ” ì°¨ì„¸ëŒ€ ë³´ì•ˆ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.</p>
            </div>
            <div class="term-actions">
                <a href="https://glossary.kaitrust.ai" class="term-action-btn btn-primary">
                    ğŸ“š ì „ì²´ ìš©ì–´ ë³´ê¸°
                </a>
                <a href="https://glossary.kaitrust.ai/#security" class="term-action-btn btn-secondary">
                    ğŸ”’ ë³´ì•ˆ ë”ë³´ê¸°
                </a>
            </div>
        </article>

        <!-- ìƒì„¸ ì„¤ëª… -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“– ìƒì„¸ ì„¤ëª…</h2>
            <div class="section-content">
                <p>XDR(Extended Detection and Response)ì€ EDR(ì—”ë“œí¬ì¸íŠ¸)ì˜ ê°œë…ì„ í™•ì¥í•˜ì—¬ ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ ì›Œí¬ë¡œë“œ, ì´ë©”ì¼, ì•„ì´ë´í‹°í‹° ë“± ì „ì²´ IT ì¸í”„ë¼ì—ì„œ ë°œìƒí•˜ëŠ” ë³´ì•ˆ ì´ë²¤íŠ¸ë¥¼ í†µí•© ìˆ˜ì§‘í•˜ê³  ë¶„ì„í•˜ëŠ” í”Œë«í¼ì…ë‹ˆë‹¤. ê°œë³„ ë³´ì•ˆ ë„êµ¬ê°€ ê°ìì˜ ì‚¬ì¼ë¡œì—ì„œ ì•Œë¦¼ì„ ìƒì„±í•˜ëŠ” ê¸°ì¡´ ë°©ì‹ê³¼ ë‹¬ë¦¬, XDRì€ ëª¨ë“  ë°ì´í„°ë¥¼ ë‹¨ì¼ ë°ì´í„° ë ˆì´í¬ì— ì •ê·œí™”í•˜ì—¬ ì €ì¥í•˜ê³ , í¬ë¡œìŠ¤-ë ˆì´ì–´ ìƒê´€ ë¶„ì„(Cross-layer Correlation)ì„ í†µí•´ ê³µê²©ì˜ ì „ì²´ ê·¸ë¦¼ì„ íŒŒì•…í•©ë‹ˆë‹¤.</p>
                <p>XDRì˜ ë“±ì¥ ë°°ê²½ì€ ë³´ì•ˆ ë„êµ¬ì˜ íŒŒí¸í™”ì™€ ì•Œë¦¼ í”¼ë¡œ(Alert Fatigue)ì…ë‹ˆë‹¤. í‰ê· ì ì¸ ê¸°ì—…ì€ 40ê°œ ì´ìƒì˜ ë³´ì•ˆ ë„êµ¬ë¥¼ ìš´ì˜í•˜ë©°, SOC ë¶„ì„ê°€ëŠ” í•˜ë£¨ ìˆ˜ì²œ ê±´ì˜ ì•Œë¦¼ì„ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. ê° ë„êµ¬ê°€ ë¶€ë¶„ì ì¸ ì •ë³´ë§Œ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ê³µê²©ì˜ ì „ì²´ ê²½ë¡œë¥¼ ì¶”ì í•˜ë ¤ë©´ ì—¬ëŸ¬ ì½˜ì†”ì„ ì˜¤ê°€ë©° ìˆ˜ë™ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤. 2018ë…„ Palo Alto Networksê°€ ì²˜ìŒ ì œì•ˆí•œ XDR ê°œë…ì€ ì´ëŸ¬í•œ "ë„êµ¬ ìŠ¤í”„ë¡¤(Tool Sprawl)"ê³¼ "í”¼ë²— ì„¸ê¸ˆ(Pivot Tax)"ì„ í•´ê²°í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.</p>
                <p>XDRì˜ í•µì‹¬ ê°€ì¹˜ëŠ” ì„¸ ê°€ì§€ì…ë‹ˆë‹¤. ì²«ì§¸, í†µí•© ê°€ì‹œì„±(Unified Visibility)ì€ ì—”ë“œí¬ì¸íŠ¸ì˜ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰, ë„¤íŠ¸ì›Œí¬ì˜ íŠ¸ë˜í”½ íë¦„, í´ë¼ìš°ë“œì˜ API í˜¸ì¶œ, ì´ë©”ì¼ì˜ ì²¨ë¶€íŒŒì¼ ë¶„ì„ì„ ë‹¨ì¼ ë·°ì—ì„œ ì œê³µí•©ë‹ˆë‹¤. ë‘˜ì§¸, ìë™ ìƒê´€ ë¶„ì„(Automated Correlation)ì€ ê°œë³„ì ìœ¼ë¡œëŠ” ì •ìƒì²˜ëŸ¼ ë³´ì´ëŠ” ì´ë²¤íŠ¸ë“¤ì„ ì—°ê²°í•˜ì—¬ ê³µê²© ì²´ì¸ì„ ì¬êµ¬ì„±í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ "í”¼ì‹± ì´ë©”ì¼ ìˆ˜ì‹  â†’ ì•…ì„± ì²¨ë¶€íŒŒì¼ ì‹¤í–‰ â†’ ìê²©ì¦ëª… íƒˆì·¨ â†’ ì¸¡ë©´ ì´ë™"ì˜ ì „ì²´ ê²½ë¡œë¥¼ í•˜ë‚˜ì˜ ì¸ì‹œë˜íŠ¸ë¡œ ë¬¶ì–´ì¤ë‹ˆë‹¤. ì…‹ì§¸, í†µí•© ëŒ€ì‘(Unified Response)ì€ ì—”ë“œí¬ì¸íŠ¸ ê²©ë¦¬, ë„¤íŠ¸ì›Œí¬ ì°¨ë‹¨, ê³„ì • ë¹„í™œì„±í™”ë¥¼ ë‹¨ì¼ í”Œë«í¼ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
                <p>XDRì€ Native XDRê³¼ Open XDRë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. Native XDRì€ ë‹¨ì¼ ë²¤ë”ì˜ EDR, NDR, ì´ë©”ì¼ ë³´ì•ˆ ë“±ì„ ê¸´ë°€í•˜ê²Œ í†µí•©í•œ í˜•íƒœë¡œ, ë°ì´í„° ì •ê·œí™”ì™€ ìƒê´€ ë¶„ì„ì´ ì›í™œí•˜ì§€ë§Œ ë²¤ë” ì¢…ì†ì„±ì´ ë†’ìŠµë‹ˆë‹¤. Open XDRì€ ì—¬ëŸ¬ ë²¤ë”ì˜ ë³´ì•ˆ ë„êµ¬ë¥¼ APIë¡œ ì—°ë™í•˜ì—¬ ê¸°ì¡´ íˆ¬ìë¥¼ ë³´ì¡´í•˜ë©´ì„œ XDR ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì§€ë§Œ, í†µí•© ê¹Šì´ê°€ ì–•ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„ íƒì€ ì¡°ì§ì˜ ê¸°ì¡´ ë³´ì•ˆ ìŠ¤íƒê³¼ ì „ëµì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤.</p>
            </div>
        </section>

        <!-- ì½”ë“œ ì˜ˆì œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ’» ì½”ë“œ ì˜ˆì œ</h2>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="correlation">í¬ë¡œìŠ¤-ë ˆì´ì–´ ìƒê´€ë¶„ì„ (Python)</button>
                <button class="code-tab" data-lang="query">ìœ„í˜‘ í—ŒíŒ… ì¿¼ë¦¬ (KQL)</button>
                <button class="code-tab" data-lang="integration">XDR API ì—°ë™ (Node.js)</button>
            </div>
            <div class="code-block active" data-lang="correlation">
                <pre><code class="language-python"># XDR í¬ë¡œìŠ¤-ë ˆì´ì–´ ìƒê´€ ë¶„ì„ ì—”ì§„ - Python
# ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, ì´ë©”ì¼, í´ë¼ìš°ë“œ ì´ë²¤íŠ¸ë¥¼ í†µí•© ë¶„ì„

from datetime import datetime, timedelta
from typing import Dict, List, Optional, Set
from collections import defaultdict
from dataclasses import dataclass, field
import json
import hashlib

@dataclass
class SecurityEvent:
    """ì •ê·œí™”ëœ ë³´ì•ˆ ì´ë²¤íŠ¸"""
    timestamp: datetime
    source_type: str       # endpoint, network, email, cloud, identity
    event_type: str        # process_create, network_connection, email_received, etc.
    severity: str          # info, low, medium, high, critical
    host: Optional[str] = None
    user: Optional[str] = None
    source_ip: Optional[str] = None
    dest_ip: Optional[str] = None
    process_name: Optional[str] = None
    file_hash: Optional[str] = None
    url: Optional[str] = None
    email_subject: Optional[str] = None
    raw_data: Dict = field(default_factory=dict)


@dataclass
class CorrelatedIncident:
    """ìƒê´€ ë¶„ì„ëœ ì¸ì‹œë˜íŠ¸"""
    incident_id: str
    title: str
    severity: str
    events: List[SecurityEvent]
    attack_chain: List[str]
    mitre_techniques: List[str]
    affected_assets: Set[str]
    recommendations: List[str]
    created_at: datetime


class XDRCorrelationEngine:
    """XDR ìƒê´€ ë¶„ì„ ì—”ì§„ - í¬ë¡œìŠ¤ ë ˆì´ì–´ ìœ„í˜‘ íƒì§€"""

    def __init__(self):
        self.events: List[SecurityEvent] = []
        self.incidents: List[CorrelatedIncident] = []
        self.correlation_rules = self._load_correlation_rules()

    def _load_correlation_rules(self) -> List[Dict]:
        """ìƒê´€ ë¶„ì„ ê·œì¹™ ë¡œë“œ"""
        return [
            {
                "name": "Phishing Attack Chain",
                "description": "í”¼ì‹± ì´ë©”ì¼ â†’ ì•…ì„± ì²¨ë¶€íŒŒì¼ ì‹¤í–‰ â†’ í›„ì† í™œë™",
                "pattern": [
                    {"source_type": "email", "event_type": "suspicious_attachment"},
                    {"source_type": "endpoint", "event_type": "process_create",
                     "conditions": {"parent_name": ["outlook.exe", "thunderbird.exe"]}},
                    {"source_type": "endpoint", "event_type": "process_create",
                     "conditions": {"name": ["powershell.exe", "cmd.exe", "wscript.exe"]}}
                ],
                "time_window_minutes": 30,
                "severity": "high",
                "mitre": ["T1566.001", "T1204.002", "T1059"]
            },
            {
                "name": "Credential Theft and Lateral Movement",
                "description": "ìê²©ì¦ëª… íƒˆì·¨ í›„ ì¸¡ë©´ ì´ë™",
                "pattern": [
                    {"source_type": "endpoint", "event_type": "lsass_access"},
                    {"source_type": "identity", "event_type": "auth_failure",
                     "conditions": {"count_threshold": 5}},
                    {"source_type": "network", "event_type": "smb_connection",
                     "conditions": {"internal_only": True}}
                ],
                "time_window_minutes": 60,
                "severity": "critical",
                "mitre": ["T1003.001", "T1110", "T1021.002"]
            },
            {
                "name": "Cloud Data Exfiltration",
                "description": "í´ë¼ìš°ë“œ ì €ì¥ì†Œë¡œ ëŒ€ëŸ‰ ë°ì´í„° ìœ ì¶œ",
                "pattern": [
                    {"source_type": "endpoint", "event_type": "file_access",
                     "conditions": {"count_threshold": 100}},
                    {"source_type": "network", "event_type": "dns_query",
                     "conditions": {"domains": ["dropbox.com", "drive.google.com",
                                                "onedrive.live.com"]}},
                    {"source_type": "network", "event_type": "https_upload",
                     "conditions": {"size_threshold_mb": 50}}
                ],
                "time_window_minutes": 120,
                "severity": "critical",
                "mitre": ["T1567.002", "T1041"]
            },
            {
                "name": "C2 Communication Detection",
                "description": "C2 ì„œë²„ì™€ì˜ ë¹„ì½˜ í†µì‹  íƒì§€",
                "pattern": [
                    {"source_type": "endpoint", "event_type": "process_create",
                     "conditions": {"suspicious_parent": True}},
                    {"source_type": "network", "event_type": "periodic_connection",
                     "conditions": {"interval_variance": "low", "dest_unknown": True}},
                    {"source_type": "network", "event_type": "dns_query",
                     "conditions": {"entropy": "high"}}
                ],
                "time_window_minutes": 1440,  # 24ì‹œê°„
                "severity": "high",
                "mitre": ["T1071", "T1568", "T1573"]
            }
        ]

    def ingest_event(self, event: SecurityEvent):
        """ì´ë²¤íŠ¸ ìˆ˜ì§‘ ë° ì‹¤ì‹œê°„ ìƒê´€ ë¶„ì„ íŠ¸ë¦¬ê±°"""
        self.events.append(event)

        # ì‹¤ì‹œê°„ ìƒê´€ ë¶„ì„ ì‹¤í–‰
        self._run_correlation(event)

    def _run_correlation(self, trigger_event: SecurityEvent):
        """ìƒê´€ ë¶„ì„ ê·œì¹™ ì‹¤í–‰"""
        for rule in self.correlation_rules:
            matched_events = self._match_pattern(rule, trigger_event)

            if matched_events:
                incident = self._create_incident(rule, matched_events)
                self.incidents.append(incident)
                print(f"[INCIDENT] {incident.title}")
                print(f"  Severity: {incident.severity}")
                print(f"  Events: {len(incident.events)}")
                print(f"  Attack Chain: {' â†’ '.join(incident.attack_chain)}")

    def _match_pattern(self, rule: Dict, trigger_event: SecurityEvent) -> List[SecurityEvent]:
        """íŒ¨í„´ ë§¤ì¹­ - ì‹œê°„ ìœˆë„ìš° ë‚´ ê´€ë ¨ ì´ë²¤íŠ¸ ê²€ìƒ‰"""
        time_window = timedelta(minutes=rule["time_window_minutes"])
        pattern = rule["pattern"]

        # íŠ¸ë¦¬ê±° ì´ë²¤íŠ¸ê°€ íŒ¨í„´ì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
        last_step = pattern[-1]
        if not self._event_matches_step(trigger_event, last_step):
            return []

        # ì‹œê°„ ìœˆë„ìš° ë‚´ ì´ì „ ë‹¨ê³„ë“¤ ê²€ìƒ‰
        matched_chain = [trigger_event]

        for step in reversed(pattern[:-1]):
            window_start = trigger_event.timestamp - time_window

            # ê°™ì€ í˜¸ìŠ¤íŠ¸/ì‚¬ìš©ìì˜ ì´ë²¤íŠ¸ ê²€ìƒ‰
            candidates = [
                e for e in self.events
                if window_start <= e.timestamp <= trigger_event.timestamp
                and self._event_matches_step(e, step)
                and self._events_related(e, trigger_event)
            ]

            if candidates:
                matched_chain.insert(0, candidates[-1])  # ê°€ì¥ ìµœê·¼ ì´ë²¤íŠ¸
            else:
                return []  # íŒ¨í„´ ë¶ˆì¼ì¹˜

        return matched_chain if len(matched_chain) == len(pattern) else []

    def _event_matches_step(self, event: SecurityEvent, step: Dict) -> bool:
        """ê°œë³„ ì´ë²¤íŠ¸ê°€ íŒ¨í„´ ë‹¨ê³„ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸"""
        if event.source_type != step["source_type"]:
            return False
        if event.event_type != step["event_type"]:
            return False

        # ì¶”ê°€ ì¡°ê±´ í™•ì¸
        conditions = step.get("conditions", {})
        for key, value in conditions.items():
            if key == "parent_name":
                if event.raw_data.get("parent_name", "").lower() not in [v.lower() for v in value]:
                    return False
            elif key == "name":
                if event.process_name and event.process_name.lower() not in [v.lower() for v in value]:
                    return False
            # ... ì¶”ê°€ ì¡°ê±´ ì²˜ë¦¬

        return True

    def _events_related(self, event1: SecurityEvent, event2: SecurityEvent) -> bool:
        """ë‘ ì´ë²¤íŠ¸ê°€ ê°™ì€ ì—”í‹°í‹°(í˜¸ìŠ¤íŠ¸/ì‚¬ìš©ì)ì™€ ê´€ë ¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸"""
        # ê°™ì€ í˜¸ìŠ¤íŠ¸
        if event1.host and event2.host and event1.host == event2.host:
            return True
        # ê°™ì€ ì‚¬ìš©ì
        if event1.user and event2.user and event1.user == event2.user:
            return True
        # IP ê´€ë ¨ì„±
        if event1.source_ip and event2.source_ip and event1.source_ip == event2.source_ip:
            return True

        return False

    def _create_incident(self, rule: Dict, events: List[SecurityEvent]) -> CorrelatedIncident:
        """ì¸ì‹œë˜íŠ¸ ìƒì„±"""
        affected_assets = set()
        attack_chain = []

        for event in events:
            if event.host:
                affected_assets.add(f"host:{event.host}")
            if event.user:
                affected_assets.add(f"user:{event.user}")
            attack_chain.append(f"{event.source_type}:{event.event_type}")

        incident_id = hashlib.md5(
            f"{rule['name']}-{events[0].timestamp}".encode()
        ).hexdigest()[:12]

        return CorrelatedIncident(
            incident_id=f"XDR-{incident_id}",
            title=rule["name"],
            severity=rule["severity"],
            events=events,
            attack_chain=attack_chain,
            mitre_techniques=rule.get("mitre", []),
            affected_assets=affected_assets,
            recommendations=self._generate_recommendations(rule),
            created_at=datetime.utcnow()
        )

    def _generate_recommendations(self, rule: Dict) -> List[str]:
        """ì¸ì‹œë˜íŠ¸ ìœ í˜•ë³„ ëŒ€ì‘ ê¶Œì¥ì‚¬í•­ ìƒì„±"""
        recommendations = []

        if "Phishing" in rule["name"]:
            recommendations.extend([
                "ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì´ë©”ì¼ ë°œì‹ ì ì°¨ë‹¨",
                "ì˜í–¥ë°›ì€ ì—”ë“œí¬ì¸íŠ¸ ê²©ë¦¬",
                "ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •",
                "ì¡°ì§ ë‚´ ìœ ì‚¬ ì´ë©”ì¼ ê²€ìƒ‰ ë° ì‚­ì œ"
            ])
        elif "Credential" in rule["name"]:
            recommendations.extend([
                "ì˜í–¥ë°›ì€ ê³„ì • ì¦‰ì‹œ ë¹„í™œì„±í™”",
                "ëª¨ë“  ì„¸ì…˜ ê°•ì œ ì¢…ë£Œ",
                "ì¸¡ë©´ ì´ë™ ëŒ€ìƒ ì‹œìŠ¤í…œ ì ê²€",
                "íŠ¹ê¶Œ ê³„ì • ê°ì‚¬"
            ])
        elif "Exfiltration" in rule["name"]:
            recommendations.extend([
                "ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì¦‰ì‹œ ì°¨ë‹¨",
                "ìœ ì¶œ ë°ì´í„° ë²”ìœ„ íŒŒì•…",
                "ë²•ë¬´íŒ€/ê²½ì˜ì§„ ì—ìŠ¤ì»¬ë ˆì´ì…˜",
                "í¬ë Œì‹ ë°ì´í„° ë³´ì¡´"
            ])

        return recommendations

    def query_events(self, query: Dict, time_range_hours: int = 24) -> List[SecurityEvent]:
        """ì´ë²¤íŠ¸ ê²€ìƒ‰ ì¿¼ë¦¬"""
        cutoff = datetime.utcnow() - timedelta(hours=time_range_hours)

        results = []
        for event in self.events:
            if event.timestamp < cutoff:
                continue

            match = True
            for key, value in query.items():
                if hasattr(event, key):
                    if getattr(event, key) != value:
                        match = False
                        break
                elif key in event.raw_data:
                    if event.raw_data[key] != value:
                        match = False
                        break

            if match:
                results.append(event)

        return results


# ì‚¬ìš© ì˜ˆì‹œ
if __name__ == "__main__":
    xdr = XDRCorrelationEngine()

    # ì‹œë®¬ë ˆì´ì…˜: í”¼ì‹± ê³µê²© ì²´ì¸
    base_time = datetime.utcnow()

    # 1. ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì´ë©”ì¼ ìˆ˜ì‹ 
    xdr.ingest_event(SecurityEvent(
        timestamp=base_time,
        source_type="email",
        event_type="suspicious_attachment",
        severity="medium",
        user="john.doe@company.com",
        email_subject="Invoice_2024.xlsm",
        raw_data={"attachment_type": "xlsm", "sender": "attacker@malicious.com"}
    ))

    # 2. Outlookì—ì„œ í”„ë¡œì„¸ìŠ¤ ìƒì„±
    xdr.ingest_event(SecurityEvent(
        timestamp=base_time + timedelta(minutes=5),
        source_type="endpoint",
        event_type="process_create",
        severity="medium",
        host="WORKSTATION-001",
        user="john.doe@company.com",
        process_name="excel.exe",
        raw_data={"parent_name": "outlook.exe", "cmdline": "excel.exe Invoice_2024.xlsm"}
    ))

    # 3. PowerShell ì‹¤í–‰ (ë§¤í¬ë¡œ)
    xdr.ingest_event(SecurityEvent(
        timestamp=base_time + timedelta(minutes=6),
        source_type="endpoint",
        event_type="process_create",
        severity="high",
        host="WORKSTATION-001",
        user="john.doe@company.com",
        process_name="powershell.exe",
        raw_data={"parent_name": "excel.exe", "cmdline": "powershell -enc ..."}
    ))

    print(f"\nì´ ì¸ì‹œë˜íŠ¸: {len(xdr.incidents)}")</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="query">
                
                <pre><code class="language-sql">// XDR ìœ„í˜‘ í—ŒíŒ… ì¿¼ë¦¬ - KQL (Kusto Query Language)
// Microsoft Defender XDR, Azure Sentinel ë“±ì—ì„œ ì‚¬ìš©

// ==============================================
// 1. í¬ë¡œìŠ¤-ë ˆì´ì–´ í”¼ì‹± ê³µê²© ì²´ì¸ íƒì§€
// ==============================================
// ì´ë©”ì¼ â†’ ì—”ë“œí¬ì¸íŠ¸ â†’ ë„¤íŠ¸ì›Œí¬ ìƒê´€ ë¶„ì„

let timeWindow = 1h;
let suspiciousEmails = EmailEvents
| where Timestamp > ago(timeWindow)
| where AttachmentCount > 0
| where ThreatTypes has_any ("Phish", "Malware")
| project EmailTimestamp=Timestamp, RecipientEmailAddress,
          SenderFromAddress, Subject, AttachmentCount;

let endpointActivity = DeviceProcessEvents
| where Timestamp > ago(timeWindow)
| where InitiatingProcessFileName in~
        ("outlook.exe", "thunderbird.exe", "excel.exe", "word.exe")
| where FileName in~
        ("powershell.exe", "cmd.exe", "wscript.exe", "mshta.exe")
| project ProcessTimestamp=Timestamp, DeviceName, AccountName,
          FileName, ProcessCommandLine, InitiatingProcessFileName;

suspiciousEmails
| join kind=inner (endpointActivity)
    on $left.RecipientEmailAddress == $right.AccountName
| where ProcessTimestamp between (EmailTimestamp .. (EmailTimestamp + timeWindow))
| project EmailTimestamp, ProcessTimestamp, RecipientEmailAddress,
          Subject, DeviceName, FileName, ProcessCommandLine
| extend AttackChain = "Email â†’ Endpoint Execution"

// ==============================================
// 2. ìê²©ì¦ëª… íƒˆì·¨ í›„ ì¸¡ë©´ ì´ë™ íƒì§€
// ==============================================

let credentialTheft = DeviceProcessEvents
| where Timestamp > ago(24h)
| where FileName =~ "lsass.exe" or
        ProcessCommandLine has_any ("mimikatz", "sekurlsa", "procdump")
| project CredTheftTime=Timestamp, DeviceName, AccountName;

let lateralMovement = DeviceNetworkEvents
| where Timestamp > ago(24h)
| where RemotePort in (445, 135, 3389, 5985)  // SMB, RPC, RDP, WinRM
| where RemoteIPType == "Private"
| summarize ConnectionCount=count(),
            TargetHosts=make_set(RemoteIP)
    by DeviceName, AccountName, bin(Timestamp, 1h);

credentialTheft
| join kind=inner (lateralMovement)
    on DeviceName, AccountName
| where Timestamp > CredTheftTime
| project CredTheftTime, Timestamp, DeviceName, AccountName,
          ConnectionCount, TargetHosts
| extend AttackStage = "Post-Credential Theft Lateral Movement"
| where ConnectionCount > 5

// ==============================================
// 3. C2 ë¹„ì½˜ í†µì‹  íŒ¨í„´ íƒì§€
// ==============================================

let beaconDetection = DeviceNetworkEvents
| where Timestamp > ago(24h)
| where RemoteIPType == "Public"
| summarize
    ConnectionCount = count(),
    AvgInterval = avg(datetime_diff('second', Timestamp,
                      prev(Timestamp, 1) over (partition by DeviceName,
                                               RemoteIP order by Timestamp))),
    IntervalStdDev = stdev(datetime_diff('second', Timestamp,
                           prev(Timestamp, 1) over (partition by DeviceName,
                                                    RemoteIP order by Timestamp))),
    FirstSeen = min(Timestamp),
    LastSeen = max(Timestamp),
    TotalBytes = sum(SentBytes + ReceivedBytes)
    by DeviceName, RemoteIP, RemotePort, InitiatingProcessFileName
| where ConnectionCount > 10
| where IntervalStdDev < 60  // ê·œì¹™ì ì¸ ê°„ê²© (í¸ì°¨ 60ì´ˆ ë¯¸ë§Œ)
| where AvgInterval between (30 .. 3600)  // 30ì´ˆ ~ 1ì‹œê°„ ê°„ê²©
| extend BeaconScore = 100 - (IntervalStdDev / AvgInterval * 100)
| where BeaconScore > 70
| project DeviceName, RemoteIP, RemotePort, InitiatingProcessFileName,
          ConnectionCount, AvgInterval, BeaconScore, FirstSeen, LastSeen

// ==============================================
// 4. í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¡œ ë°ì´í„° ìœ ì¶œ íƒì§€
// ==============================================

let cloudUploadDomains = dynamic([
    "dropbox.com", "drive.google.com", "onedrive.live.com",
    "mega.nz", "wetransfer.com", "box.com"
]);

let largeFileAccess = DeviceFileEvents
| where Timestamp > ago(4h)
| where ActionType == "FileRead"
| where FolderPath has_any ("Documents", "Desktop", "Downloads",
                            "Confidential", "Finance", "HR")
| summarize FileCount=count(), TotalSize=sum(FileSize)
    by DeviceName, AccountName, bin(Timestamp, 15m)
| where FileCount > 50 or TotalSize > 100000000;  // 50+ files or 100MB+

let cloudUploads = DeviceNetworkEvents
| where Timestamp > ago(4h)
| where RemoteUrl has_any (cloudUploadDomains)
| where SentBytes > 1000000  // 1MB+
| summarize UploadCount=count(), TotalUploaded=sum(SentBytes)
    by DeviceName, AccountName, RemoteUrl, bin(Timestamp, 15m);

largeFileAccess
| join kind=inner (cloudUploads)
    on DeviceName, AccountName
| where Timestamp1 between ((Timestamp - 15m) .. (Timestamp + 15m))
| project Timestamp, DeviceName, AccountName, FileCount, TotalSize,
          RemoteUrl, TotalUploaded
| extend AlertTitle = "Potential Data Exfiltration to Cloud Storage",
         Severity = "Critical"

// ==============================================
// 5. í†µí•© ì¸ì‹œë˜íŠ¸ ë·° - ê³µê²© íƒ€ì„ë¼ì¸
// ==============================================

let incidentId = "INC-2024-001";
let targetUser = "john.doe@company.com";
let timeRange = 7d;

union
    (EmailEvents
    | where RecipientEmailAddress =~ targetUser
    | where Timestamp > ago(timeRange)
    | project Timestamp, Source="Email",
              Activity=strcat("Received: ", Subject),
              Details=strcat("From: ", SenderFromAddress)),

    (DeviceProcessEvents
    | where AccountName =~ targetUser
    | where Timestamp > ago(timeRange)
    | project Timestamp, Source="Endpoint",
              Activity=strcat("Process: ", FileName),
              Details=ProcessCommandLine),

    (DeviceNetworkEvents
    | where InitiatingProcessAccountName =~ targetUser
    | where Timestamp > ago(timeRange)
    | project Timestamp, Source="Network",
              Activity=strcat("Connection to ", RemoteIP),
              Details=strcat("Port: ", RemotePort)),

    (IdentityLogonEvents
    | where AccountUpn =~ targetUser
    | where Timestamp > ago(timeRange)
    | project Timestamp, Source="Identity",
              Activity=strcat("Logon: ", LogonType),
              Details=strcat("From: ", DeviceName))

| order by Timestamp asc
| extend IncidentId = incidentId
| project-reorder Timestamp, Source, Activity, Details</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
            <div class="code-block" data-lang="integration">
                
                <pre><code class="language-javascript">// XDR API ì—°ë™ ë° ìë™í™”ëœ ëŒ€ì‘ - Node.js
// ì—¬ëŸ¬ ë³´ì•ˆ ë„êµ¬ë¥¼ í†µí•©í•˜ì—¬ XDR ê¸°ëŠ¥ êµ¬í˜„

const axios = require('axios');
const { EventEmitter } = require('events');

class XDRPlatform extends EventEmitter {
    constructor(config) {
        super();
        this.config = config;

        // ì—°ë™ëœ ë³´ì•ˆ ì†”ë£¨ì…˜ í´ë¼ì´ì–¸íŠ¸
        this.edr = new EDRClient(config.edr);
        this.ndr = new NDRClient(config.ndr);
        this.email = new EmailSecurityClient(config.emailSecurity);
        this.casb = new CASBClient(config.casb);
        this.identity = new IdentityClient(config.identity);

        // í†µí•© ë°ì´í„° ë ˆì´í¬
        this.dataLake = [];

        // ìƒê´€ ë¶„ì„ ì—”ì§„
        this.correlationEngine = new CorrelationEngine();
    }

    // ëª¨ë“  ì†ŒìŠ¤ì—ì„œ ì´ë²¤íŠ¸ ìˆ˜ì§‘ ì‹œì‘
    async startCollection() {
        console.log('Starting XDR event collection from all sources...');

        // ê° ì†ŒìŠ¤ì—ì„œ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ì„¤ì •
        this.edr.on('event', (event) => this.ingestEvent('endpoint', event));
        this.ndr.on('event', (event) => this.ingestEvent('network', event));
        this.email.on('event', (event) => this.ingestEvent('email', event));
        this.casb.on('event', (event) => this.ingestEvent('cloud', event));
        this.identity.on('event', (event) => this.ingestEvent('identity', event));

        // ì—°ê²° ì‹œì‘
        await Promise.all([
            this.edr.connect(),
            this.ndr.connect(),
            this.email.connect(),
            this.casb.connect(),
            this.identity.connect()
        ]);

        console.log('All security sources connected');
    }

    // ì´ë²¤íŠ¸ ì •ê·œí™” ë° ìˆ˜ì§‘
    ingestEvent(sourceType, rawEvent) {
        const normalizedEvent = this.normalizeEvent(sourceType, rawEvent);
        this.dataLake.push(normalizedEvent);

        // ì‹¤ì‹œê°„ ìƒê´€ ë¶„ì„
        const incidents = this.correlationEngine.analyze(normalizedEvent, this.dataLake);

        for (const incident of incidents) {
            this.emit('incident', incident);
            this.handleIncident(incident);
        }
    }

    // ì´ë²¤íŠ¸ ì •ê·œí™” - í†µí•© ìŠ¤í‚¤ë§ˆë¡œ ë³€í™˜
    normalizeEvent(sourceType, raw) {
        const normalized = {
            id: this.generateEventId(),
            timestamp: new Date(raw.timestamp || Date.now()).toISOString(),
            sourceType: sourceType,
            eventType: this.mapEventType(sourceType, raw),
            severity: raw.severity || 'info',

            // ê³µí†µ ì—”í‹°í‹°
            entities: {
                host: raw.hostname || raw.deviceName || raw.computerName,
                user: raw.user || raw.accountName || raw.userPrincipalName,
                sourceIp: raw.sourceIp || raw.srcIp || raw.clientIp,
                destIp: raw.destIp || raw.remoteIp || raw.targetIp,
                process: raw.processName || raw.fileName,
                fileHash: raw.sha256 || raw.md5 || raw.fileHash,
                url: raw.url || raw.requestUrl,
                domain: raw.domain || raw.remoteDomain
            },

            // ì›ë³¸ ë°ì´í„° ë³´ì¡´
            rawData: raw,

            // ë©”íƒ€ë°ì´í„°
            meta: {
                source: sourceType,
                ingestedAt: new Date().toISOString(),
                enriched: false
            }
        };

        // ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤ ê°•í™”
        this.enrichEvent(normalized);

        return normalized;
    }

    mapEventType(sourceType, raw) {
        const mappings = {
            endpoint: {
                'ProcessCreate': 'process_create',
                'FileCreate': 'file_create',
                'NetworkConnect': 'network_connection',
                'RegistryModification': 'registry_modify'
            },
            network: {
                'dns': 'dns_query',
                'http': 'http_request',
                'flow': 'network_flow',
                'alert': 'ids_alert'
            },
            email: {
                'received': 'email_received',
                'attachment': 'attachment_detected',
                'link_click': 'link_clicked'
            },
            identity: {
                'logon': 'auth_logon',
                'logoff': 'auth_logoff',
                'failed': 'auth_failure',
                'mfa': 'mfa_challenge'
            }
        };

        const sourceMap = mappings[sourceType] || {};
        return sourceMap[raw.eventType] || raw.eventType || 'unknown';
    }

    async enrichEvent(event) {
        // ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤ ì¡°íšŒ
        const iocs = [];

        if (event.entities.fileHash) {
            const hashReputation = await this.checkHashReputation(event.entities.fileHash);
            if (hashReputation.malicious) {
                iocs.push({ type: 'hash', value: event.entities.fileHash, ...hashReputation });
            }
        }

        if (event.entities.destIp) {
            const ipReputation = await this.checkIPReputation(event.entities.destIp);
            if (ipReputation.malicious) {
                iocs.push({ type: 'ip', value: event.entities.destIp, ...ipReputation });
            }
        }

        if (event.entities.domain) {
            const domainReputation = await this.checkDomainReputation(event.entities.domain);
            if (domainReputation.malicious) {
                iocs.push({ type: 'domain', value: event.entities.domain, ...domainReputation });
            }
        }

        event.threatIntel = {
            iocs: iocs,
            enrichedAt: new Date().toISOString()
        };

        event.meta.enriched = true;
    }

    async checkHashReputation(hash) {
        // VirusTotal, Hybrid Analysis ë“± ì—°ë™
        try {
            const response = await axios.get(
                `${this.config.threatIntel.url}/hash/${hash}`,
                { headers: { 'Authorization': `Bearer ${this.config.threatIntel.apiKey}` }}
            );
            return response.data;
        } catch {
            return { malicious: false };
        }
    }

    async checkIPReputation(ip) {
        // AbuseIPDB, GreyNoise ë“± ì—°ë™
        try {
            const response = await axios.get(
                `${this.config.threatIntel.url}/ip/${ip}`,
                { headers: { 'Authorization': `Bearer ${this.config.threatIntel.apiKey}` }}
            );
            return response.data;
        } catch {
            return { malicious: false };
        }
    }

    async checkDomainReputation(domain) {
        try {
            const response = await axios.get(
                `${this.config.threatIntel.url}/domain/${domain}`,
                { headers: { 'Authorization': `Bearer ${this.config.threatIntel.apiKey}` }}
            );
            return response.data;
        } catch {
            return { malicious: false };
        }
    }

    // ì¸ì‹œë˜íŠ¸ ìë™ ëŒ€ì‘
    async handleIncident(incident) {
        console.log(`\n[INCIDENT] ${incident.id}: ${incident.title}`);
        console.log(`  Severity: ${incident.severity}`);
        console.log(`  Affected: ${Array.from(incident.affectedAssets).join(', ')}`);

        // ì‹¬ê°ë„ë³„ ìë™ ëŒ€ì‘
        if (incident.severity === 'critical') {
            await this.executeCriticalResponse(incident);
        } else if (incident.severity === 'high') {
            await this.executeHighResponse(incident);
        }

        // SOAR/Ticketing ì‹œìŠ¤í…œ ì—°ë™
        await this.createTicket(incident);

        // ì•Œë¦¼ ë°œì†¡
        await this.sendAlerts(incident);
    }

    async executeCriticalResponse(incident) {
        const actions = [];

        for (const asset of incident.affectedAssets) {
            const [type, value] = asset.split(':');

            if (type === 'host') {
                // ì—”ë“œí¬ì¸íŠ¸ ê²©ë¦¬
                console.log(`  [ACTION] Isolating endpoint: ${value}`);
                actions.push(this.edr.isolateEndpoint(value));

                // ë„¤íŠ¸ì›Œí¬ ì°¨ë‹¨
                console.log(`  [ACTION] Blocking network for: ${value}`);
                actions.push(this.ndr.blockHost(value));
            }

            if (type === 'user') {
                // ê³„ì • ë¹„í™œì„±í™”
                console.log(`  [ACTION] Disabling account: ${value}`);
                actions.push(this.identity.disableAccount(value));

                // ëª¨ë“  ì„¸ì…˜ ì¢…ë£Œ
                console.log(`  [ACTION] Revoking sessions for: ${value}`);
                actions.push(this.identity.revokeSessions(value));
            }
        }

        const results = await Promise.allSettled(actions);

        incident.responseActions = results.map((r, i) => ({
            action: actions[i],
            status: r.status,
            result: r.value || r.reason
        }));
    }

    async executeHighResponse(incident) {
        // ê³ ìœ„í—˜: ëª¨ë‹ˆí„°ë§ ê°•í™” + ìŠ¹ì¸ í›„ ì¡°ì¹˜
        for (const asset of incident.affectedAssets) {
            const [type, value] = asset.split(':');

            if (type === 'host') {
                console.log(`  [ACTION] Enhanced monitoring for: ${value}`);
                await this.edr.enableEnhancedMonitoring(value);
            }

            if (type === 'user') {
                console.log(`  [ACTION] Requiring MFA for: ${value}`);
                await this.identity.requireMFA(value);
            }
        }
    }

    async createTicket(incident) {
        // ServiceNow, Jira ë“± ì—°ë™
        const ticket = {
            title: `[XDR] ${incident.id}: ${incident.title}`,
            severity: incident.severity,
            description: this.formatIncidentDescription(incident),
            assignee: this.config.ticketing.defaultAssignee,
            labels: ['xdr', 'security-incident', incident.severity]
        };

        console.log(`  [TICKET] Created: ${ticket.title}`);
    }

    async sendAlerts(incident) {
        // Slack, Email, PagerDuty ì—°ë™
        if (incident.severity === 'critical') {
            // ê¸´ê¸‰ ì•Œë¦¼
            console.log(`  [ALERT] Paging on-call: ${incident.title}`);
        }
    }

    formatIncidentDescription(incident) {
        return `
## XDR Incident Report

**ID:** ${incident.id}
**Severity:** ${incident.severity}
**Created:** ${incident.createdAt}

### Attack Chain
${incident.attackChain.join(' â†’ ')}

### MITRE ATT&CK
${incident.mitreTechniques.join(', ')}

### Affected Assets
${Array.from(incident.affectedAssets).join('\n')}

### Events
${incident.events.length} related events detected

### Recommendations
${incident.recommendations.join('\n')}
        `;
    }

    generateEventId() {
        return `evt-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    }
}

// í´ë¼ì´ì–¸íŠ¸ í´ë˜ìŠ¤ (ê°„ëµí™”)
class EDRClient extends EventEmitter {
    constructor(config) { super(); this.config = config; }
    async connect() { console.log('EDR connected'); }
    async isolateEndpoint(host) { return { success: true, host }; }
    async enableEnhancedMonitoring(host) { return { success: true, host }; }
}

class NDRClient extends EventEmitter {
    constructor(config) { super(); this.config = config; }
    async connect() { console.log('NDR connected'); }
    async blockHost(host) { return { success: true, host }; }
}

class EmailSecurityClient extends EventEmitter {
    constructor(config) { super(); this.config = config; }
    async connect() { console.log('Email Security connected'); }
}

class CASBClient extends EventEmitter {
    constructor(config) { super(); this.config = config; }
    async connect() { console.log('CASB connected'); }
}

class IdentityClient extends EventEmitter {
    constructor(config) { super(); this.config = config; }
    async connect() { console.log('Identity Provider connected'); }
    async disableAccount(user) { return { success: true, user }; }
    async revokeSessions(user) { return { success: true, user }; }
    async requireMFA(user) { return { success: true, user }; }
}

class CorrelationEngine {
    analyze(event, dataLake) {
        // ìƒê´€ ë¶„ì„ ë¡œì§ (ì•ì„  Python ì˜ˆì œ ì°¸ì¡°)
        return [];
    }
}

// ì‚¬ìš© ì˜ˆì‹œ
const xdr = new XDRPlatform({
    edr: { url: 'https://edr.company.com/api' },
    ndr: { url: 'https://ndr.company.com/api' },
    emailSecurity: { url: 'https://email-sec.company.com/api' },
    casb: { url: 'https://casb.company.com/api' },
    identity: { url: 'https://identity.company.com/api' },
    threatIntel: { url: 'https://threatintel.company.com/api', apiKey: 'xxx' },
    ticketing: { defaultAssignee: 'soc-team' }
});

xdr.on('incident', (incident) => {
    console.log(`New incident detected: ${incident.id}`);
});

xdr.startCollection();</code></pre>
                <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ ë³µì‚¬</button>
            </div>
        </section>

        <!-- ì‹¤ë¬´ ëŒ€í™” ì˜ˆì‹œ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ—£ï¸ ì‹¤ë¬´ì—ì„œ ì´ë ‡ê²Œ ë§í•˜ì„¸ìš”</h2>
            <div class="conversation-examples">
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ë³´ì•ˆ ì†”ë£¨ì…˜ ë„ì… ê²€í† ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "í˜„ì¬ EDR, NDR, SIEMì„ ë³„ë„ë¡œ ìš´ì˜í•˜ë©´ì„œ ì•Œë¦¼ í”¼ë¡œê°€ ì‹¬ê°í•©ë‹ˆë‹¤. ì§€ë‚œë‹¬ í•œ ê±´ì˜ í”¼ì‹± ê³µê²©ì„ ì¶”ì í•˜ëŠ”ë° ì„¸ ê°œ ì½˜ì†”ì„ ì˜¤ê°€ë©° 6ì‹œê°„ì´ ê±¸ë ¸ìŠµë‹ˆë‹¤. XDRì„ ë„ì…í•˜ë©´ í¬ë¡œìŠ¤-ë ˆì´ì–´ ìƒê´€ ë¶„ì„ìœ¼ë¡œ ê³µê²© ì²´ì¸ì´ ìë™ìœ¼ë¡œ ì—°ê²°ë˜ê³ , MTTD(í‰ê·  íƒì§€ ì‹œê°„)ì™€ MTTR(í‰ê·  ëŒ€ì‘ ì‹œê°„)ì„ ëŒ€í­ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ ë¸Œë¦¬í•‘ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "XDRì—ì„œ ìë™ìœ¼ë¡œ ìƒê´€ ë¶„ì„ëœ ì¸ì‹œë˜íŠ¸ì…ë‹ˆë‹¤. ê³µê²© ì²´ì¸ì„ ë³´ë©´, ë§ˆì¼€íŒ…íŒ€ ì§ì›ì´ í”¼ì‹± ì´ë©”ì¼ ì²¨ë¶€íŒŒì¼ì„ ì—´ì—ˆê³ , Excel ë§¤í¬ë¡œê°€ PowerShellì„ ì‹¤í–‰í–ˆìœ¼ë©°, ì´í›„ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë¡œ SMB ì—°ê²°ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼, ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬ ì´ë²¤íŠ¸ê°€ í•˜ë‚˜ì˜ ì¸ì‹œë˜íŠ¸ë¡œ ë¬¶ì—¬ì„œ ì „ì²´ ê·¸ë¦¼ì„ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤."
                    </blockquote>
                </div>
                <div class="conv-item">
                    <div class="conv-context">ğŸ’¬ XDR ë²¤ë” ì„ ì • ë¯¸íŒ…ì—ì„œ</div>
                    <blockquote class="conv-quote">
                        "Native XDRê³¼ Open XDR ì¤‘ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ë¯¸ CrowdStrike EDR, Palo Alto ë°©í™”ë²½, Microsoft 365ë¥¼ ì‚¬ìš© ì¤‘ì´ë¼ Open XDRì´ ê¸°ì¡´ íˆ¬ìë¥¼ ë³´ì¡´í•˜ë©´ì„œ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨, API ì—°ë™ í’ˆì§ˆê³¼ ìƒê´€ ë¶„ì„ ê¹Šì´ë¥¼ PoCì—ì„œ ë°˜ë“œì‹œ ê²€ì¦í•´ì•¼ í•©ë‹ˆë‹¤."
                    </blockquote>
                </div>
            </div>
        </section>

        <!-- ì£¼ì˜ì‚¬í•­ -->
        <section class="term-section">
            <h2 class="section-title">âš ï¸ ì£¼ì˜ì‚¬í•­ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h2>
            <div class="warning-list">
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>ë§ˆì¼€íŒ… ìš©ì–´ì— í˜„í˜¹ë˜ëŠ” ê²ƒ</strong>
                        <p>ë§ì€ ë²¤ë”ê°€ ê¸°ì¡´ ì œí’ˆì— "XDR" ë¼ë²¨ë§Œ ë¶™ì´ê³  ìˆìŠµë‹ˆë‹¤. ì§„ì •í•œ XDRì€ ë‹¤ì¤‘ ì†ŒìŠ¤ ë°ì´í„° í†µí•©, ìë™ ìƒê´€ ë¶„ì„, í†µí•© ëŒ€ì‘ì´ í•µì‹¬ì…ë‹ˆë‹¤. PoCì—ì„œ ì‹¤ì œ í¬ë¡œìŠ¤-ë ˆì´ì–´ íƒì§€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>ë°ì´í„° ì‚¬ì¼ë¡œë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€</strong>
                        <p>XDRì„ ë„ì…í•´ë„ ê¸°ì¡´ ë„êµ¬ì˜ ë°ì´í„°ë¥¼ í†µí•©í•˜ì§€ ì•Šìœ¼ë©´ íš¨ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ëª¨ë“  ê´€ë ¨ ë¡œê·¸ ì†ŒìŠ¤(ì—”ë“œí¬ì¸íŠ¸, ë„¤íŠ¸ì›Œí¬, í´ë¼ìš°ë“œ, ì´ë©”ì¼, ID)ë¥¼ XDRì— ì—°ê²°í•˜ê³  ì •ê·œí™”ëœ ìŠ¤í‚¤ë§ˆë¡œ í†µí•©í•´ì•¼ í•©ë‹ˆë‹¤.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âŒ</span>
                    <div>
                        <strong>ìƒê´€ ë¶„ì„ ê·œì¹™ ë°©ì¹˜</strong>
                        <p>ê¸°ë³¸ ê·œì¹™ë§Œìœ¼ë¡œëŠ” í™˜ê²½ íŠ¹ì„±ì„ ë°˜ì˜í•œ íƒì§€ê°€ ì–´ë µìŠµë‹ˆë‹¤. ì¡°ì§ì˜ ì •ìƒ í–‰ìœ„ ë² ì´ìŠ¤ë¼ì¸ì„ í•™ìŠµì‹œí‚¤ê³ , ì»¤ìŠ¤í…€ íƒì§€ ê·œì¹™ì„ ì§€ì†ì ìœ¼ë¡œ ê°œë°œí•˜ë©°, ì˜¤íƒë¥ ì„ ëª¨ë‹ˆí„°ë§í•˜ì—¬ íŠœë‹í•˜ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="warning-item">
                    <span class="warning-icon">âœ…</span>
                    <div>
                        <strong>XDR ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</strong>
                        <p>ë‹¨ê³„ì  í†µí•©(í•µì‹¬ ì†ŒìŠ¤ë¶€í„°), ìœ„í˜‘ í—ŒíŒ… ì—­ëŸ‰ ê°œë°œ, SOAR ì—°ë™ìœ¼ë¡œ ëŒ€ì‘ ìë™í™”, ì •ê¸°ì ì¸ íƒì§€ ê·œì¹™ ê°œë°œ ì‚¬ì´í´, ë²¤ë” ì¢…ì†ì„± ê´€ë¦¬ ì „ëµì„ ìˆ˜ë¦½í•˜ì„¸ìš”. XDRì€ ë„êµ¬ê°€ ì•„ë‹Œ í†µí•©ëœ ë³´ì•ˆ ìš´ì˜ ëª¨ë¸ì…ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ê´€ë ¨ ìš©ì–´ -->
        <section class="term-section">
            <h2 class="section-title">ğŸ”— ê´€ë ¨ ìš©ì–´</h2>
            <div class="related-terms">
                <a href="/ko/term/EDR/" class="related-term-link">EDR</a>
                <a href="/ko/term/SIEM/" class="related-term-link">SIEM</a>
                <a href="/ko/term/SOAR/" class="related-term-link">SOAR</a>
                <a href="/ko/term/MDR/" class="related-term-link">MDR</a>
                <a href="/ko/term/NDR/" class="related-term-link">NDR</a>
                <a href="/ko/term/CASB/" class="related-term-link">CASB</a>
            </div>
        </section>

        <!-- ë” ë°°ìš°ê¸° -->
        <section class="term-section">
            <h2 class="section-title">ğŸ“š ë” ë°°ìš°ê¸°</h2>
            <div class="learn-more">
                <a href="https://www.gartner.com/reviews/market/extended-detection-and-response-platforms" target="_blank" class="learn-link">
                    ğŸ“˜ Gartner - XDR ì‹œì¥ ë¦¬ë·° ë° ë²¤ë” ë¹„êµ
                </a>
                <a href="https://docs.microsoft.com/en-us/microsoft-365/security/defender/" target="_blank" class="learn-link">
                    ğŸ“„ Microsoft 365 Defender (XDR) ë¬¸ì„œ
                </a>
                <a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" target="_blank" class="learn-link">
                    â˜ï¸ Palo Alto Cortex XDR - ì•„í‚¤í…ì²˜ ê°€ì´ë“œ
                </a>
                <a href="https://attack.mitre.org/" target="_blank" class="learn-link">
                    ğŸ“ MITRE ATT&CK - XDR íƒì§€ ë§¤í•‘
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
        <div id="kaitrust-footer"></div>

    <!-- Scripts -->
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
    <script>
    // ì½”ë“œ ë³µì‚¬ ê¸°ëŠ¥
    function copyCode(btn) {
        const codeBlock = btn.parentElement.querySelector('code');
        navigator.clipboard.writeText(codeBlock.textContent).then(() => {
            btn.textContent = 'âœ… ë³µì‚¬ë¨!';
            setTimeout(() => btn.textContent = 'ğŸ“‹ ë³µì‚¬', 2000);
        });
    }

    // ì½”ë“œ íƒ­ ì „í™˜
    document.querySelectorAll('.code-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const lang = this.dataset.lang;
            const section = this.closest('.term-section');

            section.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            section.querySelectorAll('.code-block').forEach(block => {
                block.classList.remove('active');
                if (block.dataset.lang === lang) {
                    block.classList.add('active');
                }
            });
        });
    });
    </script>
    <script>window.WIA_A11Y_CONFIG = { fabBottom: "78px", fabRight: "170px" };</script>
    <script src="https://wia.live/wia-a11y-toolkit/wia-a11y-toolkit.min.js"></script>
    <script src="/components/ask-ai/kaitrust-ai-modal.js"></script>
    <script src="/components/language-modal/wia-language-modal-211.js"></script>
<script src="/glossary/js/term-sections.js?v=20260129231616"></script>
    <script src="https://kaitrust.ai/components/site-kit/kaitrust-site-kit.js"></script>
    <script src="/kaitrust-i18n.js?v=20260129"></script>
</body>
</html>
